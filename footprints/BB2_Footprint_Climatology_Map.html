<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-122.99517, 49.119038], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.9000026566667071, "info": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99463454885787, 49.11810729647153], [-122.99460708541655, 49.118105211343035], [-122.99457962189368, 49.11810389584146], [-122.99455215825498, 49.118103651142384], [-122.9945246944793, 49.11810465338808], [-122.99449723057478, 49.118106810264514], [-122.9944727885846, 49.11810958258348], [-122.99446976656218, 49.11810991775386], [-122.99444230245932, 49.11811380236419], [-122.99441483822532, 49.11811881673835], [-122.99438737383014, 49.11812521081968], [-122.99437883603848, 49.11812760496418], [-122.99435990926911, 49.11813300516132], [-122.99433244450299, 49.118142523833455], [-122.99432471394663, 49.11814562923316], [-122.99430497952055, 49.1181538402556], [-122.99428476197734, 49.118163654179064], [-122.99427751427261, 49.11816735578691], [-122.9942530724239, 49.11818167952265], [-122.99425004869576, 49.11818358764859], [-122.99422744345233, 49.11819970516067], [-122.99422258267147, 49.118203517477646], [-122.9942060956767, 49.11821773100787], [-122.9941951160657, 49.11822824165212], [-122.99418774845512, 49.118235757002154], [-122.99417164957849, 49.118253783107015], [-122.99416764876348, 49.11825867259094], [-122.99415729196544, 49.118271809297696], [-122.99414461500311, 49.11828983557178], [-122.99414018051975, 49.11829681051136], [-122.99413329435798, 49.11830786191335], [-122.99412322660065, 49.11832588831753], [-122.9941143849299, 49.118343914783296], [-122.9941127107308, 49.11834764824987], [-122.99410623437826, 49.1183619412836], [-122.99409884833551, 49.11837996782235], [-122.99409216640242, 49.11839799439661], [-122.99408605894347, 49.11841602099986], [-122.99408523849654, 49.118418578317915], [-122.99408004954188, 49.11843404760775], [-122.994074384503, 49.118452074232955], [-122.99406911588213, 49.11847010087818], [-122.99406427904736, 49.11848812754529], [-122.99405992249207, 49.11850615423689], [-122.99405776300453, 49.11851612275105], [-122.9940559176737, 49.118524180946366], [-122.99405219449947, 49.118542207670146], [-122.99404879827222, 49.1185602344106], [-122.99404556244693, 49.118578261159186], [-122.9940423241327, 49.118596287907486], [-122.99403894861126, 49.11861431464857], [-122.99403533386942, 49.118632341377115], [-122.99403140545624, 49.11865036808929], [-122.99403028243732, 49.11865505773624], [-122.9940268013164, 49.11866839476632], [-122.99402166350865, 49.11868642141546], [-122.99401610124549, 49.118704448042344], [-122.99401012374338, 49.118722474647335], [-122.99400375629916, 49.11874050123173], [-122.99400280786283, 49.11874301463313], [-122.99399650220514, 49.11875852776959], [-122.99398881645207, 49.11877655428448], [-122.9939808032503, 49.11879458078173], [-122.99397533617254, 49.118806356311985], [-122.99397223326093, 49.118812607249296], [-122.99396289957903, 49.11883063367625], [-122.99395338204178, 49.118848660092745], [-122.99394786572718, 49.118858891087704], [-122.99394340320025, 49.1188666864842], [-122.99393292006766, 49.11888471284825], [-122.99392252964184, 49.11890273921617], [-122.99392039583259, 49.11890644485308], [-122.99391167737738, 49.11892076555874], [-122.99390102112486, 49.11893879191059], [-122.99389292600357, 49.11895303683248], [-122.99389065496412, 49.11895681827674], [-122.99388019654434, 49.11897484463702], [-122.99387047935123, 49.11899287103566], [-122.99386545570634, 49.1190030077973], [-122.9938613123683, 49.11901089746267], [-122.9938527590759, 49.11902892392158], [-122.9938452960588, 49.11904695043793], [-122.99383894040928, 49.11906497701284], [-122.99383798346375, 49.119068236378], [-122.99383333892368, 49.11908300362761], [-122.99382886771323, 49.11910103030249], [-122.99382561083222, 49.11911905704208], [-122.99382356080525, 49.11913708384609], [-122.99382268716276, 49.119155110712974], [-122.99382294783449, 49.11917313764046], [-122.99382431468712, 49.11919116462709], [-122.99382675612377, 49.1192091916711], [-122.99383026490223, 49.11922721877205], [-122.9938348846324, 49.11924524593215], [-122.99383796034023, 49.11925489302629], [-122.99384050888766, 49.11926327314562], [-122.99384715887787, 49.11928130041342], [-122.99385515293622, 49.11929932775232], [-122.9938644953416, 49.1193173551623], [-122.993865416738, 49.11931897422892], [-122.99387446082196, 49.119335382604504], [-122.99388559757692, 49.119353410107834], [-122.99389287556795, 49.119363822416084], [-122.99389815766219, 49.11937143768525], [-122.99391303234735, 49.11938946538333], [-122.99392033589305, 49.11939684311968], [-122.99393118561413, 49.11940749325181], [-122.99394779728762, 49.11942137406111], [-122.99395291997706, 49.11942552130499], [-122.9939752591993, 49.11944185928784], [-122.99397763486729, 49.11944354950954], [-122.99400272138932, 49.119460223698084], [-122.99400483736193, 49.119461577837924], [-122.99403018385391, 49.11947646931806], [-122.99403599337428, 49.119479606364166], [-122.99405764665381, 49.11949005839309], [-122.99407538656209, 49.119497635304924], [-122.99408510972319, 49.1195015075093], [-122.99411257295564, 49.11951168553341], [-122.99412404399517, 49.11951566470407], [-122.99414003628316, 49.11952115231645], [-122.9941674997168, 49.11952980309762], [-122.99418126524729, 49.11953369451455], [-122.9941949632761, 49.11953745888743], [-122.99422242695744, 49.1195441368741], [-122.99424989075337, 49.119549887436825], [-122.9942595378503, 49.119551725345254], [-122.99427735460469, 49.119555211764144], [-122.99430481850519, 49.11956015775849], [-122.99433228246846, 49.119564601017224], [-122.99435974650035, 49.11956848234099], [-122.99437023336215, 49.11956975770839], [-122.99438721058918, 49.119571897019995], [-122.99441467474982, 49.11957470593071], [-122.99444213899109, 49.11957682087011], [-122.99446960330718, 49.11957828399537], [-122.99449706769269, 49.119579134168646], [-122.99452453214485, 49.11957938738604], [-122.99455199666438, 49.119579028087664], [-122.99457946125477, 49.11957801479708], [-122.99460692592031, 49.119576298247864], [-122.99463439066388, 49.119573840575036], [-122.9946618554872, 49.11957061472692], [-122.99466759134945, 49.1195697718253], [-122.99468932035018, 49.11956698402993], [-122.9947167852702, 49.11956277842734], [-122.99474425025758, 49.119557891541], [-122.99477171531257, 49.119552310039985], [-122.99477423954104, 49.119551749789466], [-122.99479918034618, 49.11954687396145], [-122.99482664542298, 49.11954096511222], [-122.99485411054864, 49.119534520571776], [-122.99485743225438, 49.11953372661267], [-122.9948815756123, 49.119528609481], [-122.99490904068938, 49.11952250387121], [-122.99493650580719, 49.11951593158746], [-122.99493741121174, 49.119515703235024], [-122.99496397087445, 49.11950978670446], [-122.99499143601629, 49.11950283409541], [-122.99500972205766, 49.119497679470705], [-122.99501890119966, 49.11949538998949], [-122.99504636635322, 49.119488162653106], [-122.9950738315087, 49.119480835305126], [-122.99507934228035, 49.11947965554639], [-122.99510129645884, 49.119475511067], [-122.9951287612, 49.11947226048184], [-122.99515622575719, 49.119470862097], [-122.99518369010116, 49.11947164995383], [-122.99521115426059, 49.11947436325228], [-122.99523861829974, 49.119478364644785], [-122.99524614499919, 49.1194796625351], [-122.99526608222608, 49.11948359775815], [-122.99529354613105, 49.119489117791304], [-122.99532101007017, 49.11949433957343], [-122.9953395398439, 49.11949769325544], [-122.9953484740165, 49.11949954619594], [-122.99537593794103, 49.119505048759706], [-122.99540340191356, 49.119510097783255], [-122.99543086593161, 49.11951471183386], [-122.99543724146362, 49.11951572407045], [-122.99545832992979, 49.119519599615415], [-122.99548579395608, 49.11952423682532], [-122.99551325802767, 49.11952842886009], [-122.99554072214184, 49.11953219749617], [-122.99555321772374, 49.11953375550804], [-122.99556818626355, 49.119535928194935], [-122.99559565039908, 49.1195395493337], [-122.99562311456727, 49.11954284477579], [-122.99565057876119, 49.11954588764176], [-122.99567804297692, 49.119548718125934], [-122.99570550721313, 49.11955134764684], [-122.99571046977712, 49.11955178837002], [-122.99573297144153, 49.119554101968085], [-122.99576043568723, 49.11955668912157], [-122.99578789995451, 49.1195590548757], [-122.995815364245, 49.119561175970674], [-122.99584282856593, 49.11956296109216], [-122.99587029292807, 49.11956427308813], [-122.9958977573395, 49.119565005429784], [-122.99592522179705, 49.119565184690124], [-122.99595268628627, 49.11956497705071], [-122.99598015079289, 49.119564551223746], [-122.9960076153124, 49.119563959110444], [-122.9960350798494, 49.119563139039904], [-122.99606254441265, 49.11956197637764], [-122.99609000901081, 49.119560352896414], [-122.99611747365036, 49.11955817645447], [-122.99614493833417, 49.11955539779634], [-122.9961724030618, 49.11955200986133], [-122.99617388633116, 49.11955180465764], [-122.9961998678151, 49.119548236725336], [-122.9962273326088, 49.11954387640162], [-122.9962547974475, 49.119538854167615], [-122.99627905835264, 49.11953378118277], [-122.99628226233598, 49.11953309202068], [-122.9963097272741, 49.119526574564574], [-122.99633719228669, 49.11951894842548], [-122.99634751530367, 49.119515756456366], [-122.99636465738443, 49.119510041890415], [-122.99639212258533, 49.119499577563964], [-122.99639657277241, 49.11949773108545], [-122.99641958791365, 49.11948718250528], [-122.99643438425709, 49.11947970534686], [-122.99644705338548, 49.11947258660452], [-122.99646520827933, 49.11946167938214], [-122.99647451902261, 49.119455431404035], [-122.99649128472508, 49.11944365326492], [-122.99650198485982, 49.11943516158363], [-122.99651362027365, 49.11942562702887], [-122.99652945096858, 49.119410679126105], [-122.99653264281372, 49.11940760068897], [-122.99654895927763, 49.11938957426505], [-122.99655691754334, 49.11937907382032], [-122.99656260396209, 49.11937154775922], [-122.99657405376489, 49.11935352118663], [-122.99658328415951, 49.11933549454719], [-122.99658438508476, 49.11933288304092], [-122.99659103828097, 49.11931746786337], [-122.9965972103864, 49.11929944113234], [-122.99660196508653, 49.11928141435924], [-122.99660545651692, 49.11926338754875], [-122.9966077748677, 49.119245360703616], [-122.99660897795157, 49.11922733382565], [-122.99660911882037, 49.11920930691641], [-122.99660826144972, 49.1191912799778], [-122.99660648029432, 49.11917325301197], [-122.99660384617701, 49.11915522602097], [-122.9966004076818, 49.11913719900616], [-122.99659617782966, 49.11911917196789], [-122.99659113533723, 49.1191011449054], [-122.99658522348506, 49.11908311781692], [-122.99658440238532, 49.11908093869842], [-122.99657877272564, 49.119065090712134], [-122.99657134304594, 49.11904706357784], [-122.99656272336411, 49.1190290364076], [-122.996556942504, 49.119018476292304], [-122.99655305193876, 49.119011009205245], [-122.99654237512443, 49.11899298197194], [-122.99653008866336, 49.118974954689214], [-122.99652948142628, 49.11897414962371], [-122.9965169674498, 49.11895692737994], [-122.9965020197592, 49.118938900013816], [-122.9965020197592, 49.118938900013816], [-122.99648626119085, 49.118920872621004], [-122.99647455776416, 49.1189088264607], [-122.99646889415041, 49.118902845176805], [-122.99645030460876, 49.11888481769236], [-122.99644709557687, 49.118881909408024], [-122.99643071250347, 49.118866790173875], [-122.9964196332513, 49.118857326322534], [-122.99640974781818, 49.11884876260933], [-122.99639217082049, 49.11883456851554], [-122.99638747276258, 49.11883073499993], [-122.99636470830565, 49.118813304120465], [-122.9963639335371, 49.118812707346365], [-122.99633924083565, 49.11879467965137], [-122.99633724572189, 49.118793294715545], [-122.99631321038297, 49.11877665190834], [-122.99630978307859, 49.11877438575492], [-122.99628578228196, 49.11875862411441], [-122.9962823203847, 49.11875643295316], [-122.99625704424392, 49.11874059627147], [-122.99625485765146, 49.11873926595437], [-122.99622739488449, 49.118722793586635], [-122.99622701500677, 49.11872256837912], [-122.99619993208685, 49.118706960734414], [-122.99619561644556, 49.118704540433804], [-122.99617246924441, 49.11869193735887], [-122.99616210337481, 49.118686512409596], [-122.99614500634809, 49.118677823351184], [-122.99612566799657, 49.118668484277585], [-122.99611754339446, 49.1186646434364], [-122.99609008039586, 49.11865222042062], [-122.99608604983675, 49.11865045602617], [-122.99606261738046, 49.11864018306244], [-122.99604401504658, 49.118632427678314], [-122.9960351543366, 49.11862866945042], [-122.9960076912904, 49.118617343642825], [-122.9960003644963, 49.11861439925913], [-122.99598022825117, 49.11860608596823], [-122.99595549198783, 49.11859637078059], [-122.99595276518849, 49.11859526952775], [-122.9959253021435, 49.11858438294397], [-122.99590920721091, 49.118578342234514], [-122.99589783907288, 49.11857395276372], [-122.99587037599221, 49.11856378261884], [-122.99586064597126, 49.11856031358823], [-122.99584291290984, 49.118553767089594], [-122.99581544981086, 49.118544080077875], [-122.99581032010029, 49.118542284857455], [-122.99578798674848, 49.11853408745754], [-122.99576052367259, 49.11852438305999], [-122.99576016639912, 49.118524256111], [-122.9957330606526, 49.118514151540374], [-122.99571103260841, 49.11850622738059], [-122.99570559762198, 49.118504174118506], [-122.99567813463914, 49.11849377371397], [-122.99566320163959, 49.118488198678165], [-122.99565067167538, 49.11848328641713], [-122.99562320874256, 49.11847257879226], [-122.99561710783954, 49.118470170021816], [-122.9955957458705, 49.118461318797756], [-122.9955735696167, 49.11845214144505], [-122.99556828302943, 49.118449850405916], [-122.99554082026394, 49.11843768019043], [-122.99553289903876, 49.11843411296277], [-122.99551335756294, 49.118424943851345], [-122.99549462735492, 49.11841608455974], [-122.99548589491343, 49.11841179535289], [-122.99545843232544, 49.11839813174505], [-122.99545828559955, 49.11839805621992], [-122.99543096983909, 49.11838352602391], [-122.99542447999285, 49.11838002796913], [-122.99540350741651, 49.118368404812934], [-122.99539193434252, 49.118361999758676], [-122.9953760450362, 49.118353008354006], [-122.99535966833976, 49.118343971550246], [-122.99534858266065, 49.11833774268848], [-122.99532649070404, 49.11832594329584], [-122.99532112025057, 49.11832302345038], [-122.995293657794, 49.118308967518274], [-122.9952914850504, 49.1183079149573], [-122.99526619531038, 49.1182953588666], [-122.99525443595, 49.11828988652411], [-122.9952387327822, 49.118282372453166], [-122.99521543712777, 49.118271857998195], [-122.99521127021706, 49.118269919211016], [-122.99518380765385, 49.11825758788743], [-122.99517503139998, 49.11825382940025], [-122.99515634507631, 49.11824554336559], [-122.99513303034252, 49.118235800720875], [-122.9951288824627, 49.118234003443035], [-122.99510141985029, 49.11822258027201], [-122.99508910081514, 49.11821777194416], [-122.9950739572052, 49.11821161467775], [-122.99504649451612, 49.11820121237248], [-122.99504237487646, 49.118199743030615], [-122.99501903181718, 49.11819102316767], [-122.99499167339131, 49.11818171392573], [-122.99499156904466, 49.11818167666506], [-122.99496410626759, 49.118172476843206], [-122.99493664340628, 49.11816420470138], [-122.99493476892292, 49.11816368452651], [-122.9949091805302, 49.11815616577878], [-122.99488171758074, 49.11814892633422], [-122.99486798772386, 49.118145654660594], [-122.99485425458884, 49.11814217457814], [-122.99482679155506, 49.118135897122144], [-122.99479932845601, 49.11813031019282], [-122.99478450471463, 49.11812762400272], [-122.99477186531584, 49.118125173278024], [-122.99474440213568, 49.11812046832819], [-122.99471693889481, 49.11811638417307], [-122.9946894755959, 49.11811288575532], [-122.99466201224317, 49.11810992512379], [-122.99465828954207, 49.11810959131519], [-122.99463454885787, 49.11810729647153]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.7499482143233668, "info": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.9950189859104, 49.11864946605839], [-122.99499152224718, 49.11864645202337], [-122.99496405844788, 49.118644814741636], [-122.99493659450827, 49.118644573543506], [-122.99490913038959, 49.11864608482249], [-122.994881666043, 49.118649794746595], [-122.99487864042597, 49.11865040878037], [-122.99485420151508, 49.118655217768676], [-122.99482673673403, 49.11866301713842], [-122.99481241366075, 49.11866843273876], [-122.99479927165243, 49.11867360882428], [-122.99477457048447, 49.11868645794724], [-122.99477180615527, 49.11868804256113], [-122.99474823428744, 49.11870448366728], [-122.99474434009883, 49.118707618888955], [-122.99472788087589, 49.1187225096546], [-122.99471687324457, 49.118734503211606], [-122.99471165473355, 49.11874053582742], [-122.99469815486461, 49.11875856212311], [-122.99468940514, 49.11877282064256], [-122.99468706064066, 49.1187765885279], [-122.99467716410288, 49.11879461498679], [-122.99466911736121, 49.118812641530205], [-122.9946624395742, 49.11883066813631], [-122.9946619347369, 49.11883216184875], [-122.99465570425535, 49.11884869473929], [-122.9946495336472, 49.11886672136801], [-122.99464381052387, 49.1188847480171], [-122.9946383845957, 49.11890277467965], [-122.99463446166467, 49.11891563941643], [-122.99463262454708, 49.11892080132635], [-122.99462617553688, 49.118938827940646], [-122.99461997423059, 49.11895685456606], [-122.99461432253591, 49.11897488121673], [-122.99460921586373, 49.11899290789251], [-122.99460698813387, 49.119002496273225], [-122.9946046793078, 49.11901093459466], [-122.99460075399766, 49.11902896132517], [-122.99459816551777, 49.11904698811803], [-122.99459715596441, 49.119065014984685], [-122.99459797599417, 49.11908304193688], [-122.99460087341322, 49.1191010689862], [-122.99460607440521, 49.119119096143024], [-122.99460697525147, 49.11912131333124], [-122.9946128284045, 49.11913712337202], [-122.9946222454482, 49.11915515072467], [-122.99463443403042, 49.119171821121206], [-122.99463539969877, 49.11917317825019], [-122.99465213238861, 49.11919120593996], [-122.99466189533555, 49.11919930954444], [-122.99467442785874, 49.11920923388399], [-122.99468935750002, 49.11921903337869], [-122.99470330150646, 49.11922726212565], [-122.99471682017489, 49.11923415692443], [-122.9947429140948, 49.119245290849484], [-122.99474428323128, 49.11924582753108], [-122.99477174652803, 49.119255334174106], [-122.99479921009062, 49.11926239879927], [-122.99480359213084, 49.11926332050975], [-122.99482667377355, 49.11926838138459], [-122.99485413760091, 49.119273031481185], [-122.99488160158863, 49.11927617337507], [-122.99490906573317, 49.11927781700042], [-122.99493653002533, 49.11927802804304], [-122.99496399443169, 49.119277113584715], [-122.9949914589585, 49.119274993016184], [-122.99501892360125, 49.11927169095708], [-122.99504638833848, 49.11926740386874], [-122.99506737350946, 49.1192633320809], [-122.99507385314641, 49.1192623549018], [-122.9951013178853, 49.119257950513976], [-122.99512878258187, 49.119253928657585], [-122.99515624696677, 49.119253061490475], [-122.9951837110177, 49.11925563375438], [-122.99521117482752, 49.119260739946014], [-122.99522404026942, 49.119263338668034], [-122.99523863853251, 49.11926699980832], [-122.9952661022678, 49.11927301407274], [-122.99529356614806, 49.11927756646486], [-122.99532103014431, 49.11928093922362], [-122.99532594832048, 49.119281369751896], [-122.99534849417363, 49.11928399832625], [-122.99537595830085, 49.11928604026405], [-122.9954034225274, 49.11928703231766], [-122.99543088684862, 49.11928700528296], [-122.99545835125454, 49.11928605033529], [-122.99548581574932, 49.11928410474623], [-122.99550895581685, 49.11928137701581], [-122.99551328035585, 49.11928089643733], [-122.99554074504833, 49.119276689732274], [-122.99556820986942, 49.11927098740271], [-122.99559567484171, 49.11926350645539], [-122.99559617216289, 49.119263353462316], [-122.99562313993654, 49.11925453900285], [-122.99564565028935, 49.11924532842573], [-122.9956506052415, 49.119243055434744], [-122.99567807079944, 49.119228513862865], [-122.99568013684748, 49.119227302807936], [-122.99570553674674, 49.119209276842135], [-122.99570553674674, 49.119209276842135], [-122.9957255360745, 49.11919125067087], [-122.99573300333371, 49.11918233549457], [-122.99574071870761, 49.1191732243185], [-122.99575224743398, 49.1191551978297], [-122.99576024362668, 49.119137171210006], [-122.99576047151228, 49.1191363713147], [-122.99576584247981, 49.11911914450181], [-122.9957685303885, 49.11910111768665], [-122.99576875321699, 49.11908309078105], [-122.99576683551608, 49.119065063796924], [-122.9957628380182, 49.1190470367364], [-122.9957604797047, 49.119040252307336], [-122.99575707515841, 49.119029009610806], [-122.99574950587474, 49.11901098241838], [-122.99573919077896, 49.11899295512411], [-122.99573302032086, 49.118984313911845], [-122.99572690716643, 49.118974927756014], [-122.99571242226449, 49.11895690030483], [-122.9957055591608, 49.1189496635926], [-122.99569590818344, 49.11893887277614], [-122.99567809740535, 49.11892230635241], [-122.99567658109942, 49.118920845139726], [-122.99565497337011, 49.11890281741422], [-122.99565063527014, 49.118899637754964], [-122.99563009179526, 49.11888478956073], [-122.99562317286407, 49.11888033169178], [-122.99560115364866, 49.11886676154734], [-122.99559571024467, 49.11886367541812], [-122.99556824745495, 49.11884913775373], [-122.99556744633296, 49.11884873334362], [-122.99554078459205, 49.11883559498817], [-122.9955299286775, 49.118830704982564], [-122.99551332164759, 49.11882312262204], [-122.99548799615032, 49.11881267643678], [-122.99548585861609, 49.11881176071768], [-122.99545839561277, 49.11880022787456], [-122.99544365913997, 49.11879464778087], [-122.99543093254573, 49.118789527192504], [-122.9954034694564, 49.118779195671344], [-122.99539656408824, 49.11877661899793], [-122.99537600644739, 49.118768123087364], [-122.99535197629709, 49.11875859029668], [-122.99534854344478, 49.11875711254702], [-122.99532108051869, 49.11874541773614], [-122.99530905411203, 49.11874056164584], [-122.99529361760008, 49.11873378051494], [-122.99526615465442, 49.11872256237748], [-122.99526608039889, 49.11872253297688], [-122.99523869178063, 49.118710722858324], [-122.99522214101813, 49.118704504251916], [-122.99521122880967, 49.118700028491126], [-122.99518376578672, 49.118689992972044], [-122.99517267887632, 49.11868647527937], [-122.99515630270318, 49.118680693445555], [-122.99512883953128, 49.11867240106273], [-122.99511325215836, 49.118668445864245], [-122.99510137627843, 49.11866502395908], [-122.99507391295153, 49.11865847653074], [-122.99504644948635, 49.11865338999639], [-122.99502486366644, 49.11865041517407], [-122.9950189859104, 49.11864946605839]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.4998095006745147, "info": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99515628529134, 49.11885950106449], [-122.99512882167923, 49.11885469564322], [-122.99510135783883, 49.11885226249974], [-122.99507389378448, 49.118852016785134], [-122.99504642948652, 49.11885421998425], [-122.99501896485572, 49.11885972259164], [-122.99499819413678, 49.118866736999614], [-122.99499149983643, 49.118869023111394], [-122.99496403429637, 49.11888336597048], [-122.99496195821594, 49.118884762338524], [-122.99493935378393, 49.11890278826431], [-122.99493656793388, 49.11890563257439], [-122.99492275792053, 49.11892081445001], [-122.99491141496655, 49.118938840864914], [-122.99490909990398, 49.11894395029563], [-122.99490253766061, 49.11895686738754], [-122.99489618485842, 49.11897489402104], [-122.9948922905612, 49.11899292076294], [-122.99489069866782, 49.11901094760655], [-122.99489130301446, 49.119028974547305], [-122.99489426977262, 49.1190470015925], [-122.99490039539454, 49.11906502877712], [-122.99490908593398, 49.11908044511149], [-122.99491038603729, 49.11908305613181], [-122.99492381153429, 49.11910108363664], [-122.99493654692598, 49.11911200515117], [-122.99494573430812, 49.119119111512184], [-122.99496400937747, 49.11912949354723], [-122.99498287309581, 49.1191371400457], [-122.9949914725304, 49.11914020765467], [-122.99501893607683, 49.1191471104335], [-122.99504639998887, 49.11915041875569], [-122.99507386420865, 49.11915065615626], [-122.99510132874504, 49.119147681662994], [-122.99512879366631, 49.119140743408515], [-122.99514474569895, 49.119137146966565], [-122.99515625855496, 49.11913406168131], [-122.99516437697628, 49.11913714779047], [-122.99518372187838, 49.11914346870234], [-122.99521118507192, 49.11915433264758], [-122.99521510232044, 49.119155176817515], [-122.99523864863106, 49.11916150269998], [-122.99526611262175, 49.119164221472865], [-122.99529357692028, 49.11916371861036], [-122.9953210415197, 49.11916001071885], [-122.99533992051049, 49.11915518192307], [-122.99534850643363, 49.119152896318454], [-122.99537597170792, 49.11914182079649], [-122.99538494060707, 49.119137156817835], [-122.99540343751507, 49.11912484672138], [-122.99541099915805, 49.1191191309429], [-122.9954275707546, 49.11910110468667], [-122.99543090446339, 49.119095245141644], [-122.99543854783633, 49.11908307820711], [-122.99544455702451, 49.119065051530555], [-122.99544605837366, 49.11904702467589], [-122.99544359299692, 49.11902899766467], [-122.99543684001735, 49.11901097048396], [-122.99543091306624, 49.11900159107803], [-122.9954262835859, 49.11899294315219], [-122.99541181201073, 49.118974915663884], [-122.99540345206745, 49.11896736989529], [-122.99539197561393, 49.11895688795969], [-122.9953759899317, 49.11894578564944], [-122.99536499689808, 49.118938859965525], [-122.99534852730437, 49.11892971309835], [-122.99532964723551, 49.11892083162667], [-122.99532106439845, 49.11891679101969], [-122.99529360135044, 49.11890552133166], [-122.99528632102398, 49.11890280295155], [-122.9952661382996, 49.118894412172686], [-122.99523867512022, 49.11888477408205], [-122.99523867512022, 49.11888477408205], [-122.99521121200908, 49.11887453754432], [-122.9951837486615, 49.11886685994967], [-122.99518321928275, 49.11886674486726], [-122.99515628529134, 49.11885950106449]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"index": "BB2", "name": "Burns Bog 2", "Zm": 2.85, "bearing": 180, "lat": 49.119038, "lon": -122.99517, "canopy_height": 0.65, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/burnsbog2.html#", "info": "https://ubc-micromet.github.io/Data.html#burns-bog-2"}, "geometry": {"type": "Point", "coordinates": [-122.99517, 49.119038]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"index": "BB2", "name": "Burns Bog 2", "Zm": 2.85, "bearing": 180, "lat": 49.119038, "lon": -122.99517, "canopy_height": 0.65, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/burnsbog2.html#", "info": "https://ubc-micromet.github.io/Data.html#burns-bog-2"}, "geometry": {"type": "Point", "coordinates": [-122.99517, 49.119038]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>