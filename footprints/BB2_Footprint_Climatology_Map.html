<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-122.99517, 49.119038], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.9000004136182858, "Contour_Level": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99468947406068, 49.11812726586282], [-122.99466201066251, 49.11812465446321], [-122.99463454719366, 49.118122725323495], [-122.99460708365282, 49.11812147943738], [-122.99457962003765, 49.11812092841271], [-122.99455215634443, 49.11812109565937], [-122.99452469256795, 49.11812201765653], [-122.99449722870132, 49.11812374535147], [-122.99446976473577, 49.1181263457649], [-122.99445979726632, 49.11812760887764], [-122.99444230067411, 49.11812978036647], [-122.99441483650111, 49.11813417317661], [-122.99438737219187, 49.11813973009411], [-122.99436366284694, 49.11814563114121], [-122.99435990773084, 49.11814657175263], [-122.99433244312125, 49.11815465094076], [-122.99430718527486, 49.11816365528691], [-122.9943049783041, 49.11816446523366], [-122.99427751327572, 49.11817602118497], [-122.9942659147653, 49.1181816801612], [-122.99425004797197, 49.11818984902228], [-122.9942332340072, 49.11819970545005], [-122.99422258233648, 49.11820640186577], [-122.99420639868065, 49.11821773102308], [-122.99419511628795, 49.11822633716957], [-122.9941837845539, 49.11823575680255], [-122.9941676497116, 49.11825058637382], [-122.99416439079445, 49.11825378274035], [-122.99414744689699, 49.11827180879905], [-122.99414018245406, 49.11828039060565], [-122.99413247320085, 49.11828983495535], [-122.99411909924953, 49.11830786119116], [-122.99411271431946, 49.118317327250445], [-122.99410699789571, 49.118325887490315], [-122.994095889221, 49.11834391383892], [-122.99408586195764, 49.118361940241805], [-122.99408524509148, 49.11836311586253], [-122.9940762401203, 49.11837996666456], [-122.99406738516676, 49.118397993125875], [-122.99405924219326, 49.1184160196231], [-122.99405777455307, 49.11841945072571], [-122.9940512914129, 49.118434046129565], [-122.99404381864169, 49.118452072660105], [-122.99403688011738, 49.1184700992177], [-122.99403043345461, 49.11848812580024], [-122.99403030242534, 49.118488509978626], [-122.99402396181237, 49.1185061523811], [-122.99401791335515, 49.11852417898345], [-122.99401226368747, 49.11854220560612], [-122.99400697743584, 49.1185602322473], [-122.994002828088, 49.11857526333119], [-122.99400194919072, 49.11857825890161], [-122.99399687565254, 49.11859628555328], [-122.99399206188346, 49.1186143122182], [-122.99398745630107, 49.11863233889368], [-122.99398299510989, 49.11865036557646], [-122.9939785968356, 49.11866839226229], [-122.99397535129204, 49.11868152476275], [-122.99397405269838, 49.11868641894029], [-122.99396904029035, 49.118704445593586], [-122.99396371349839, 49.118722472230175], [-122.99395797617376, 49.118740498844986], [-122.99395181577997, 49.118758525437265], [-122.99394787661286, 49.118769423351864], [-122.99394511835315, 49.11877655200102], [-122.99393798554865, 49.11879457854147], [-122.99393107294097, 49.118812605092984], [-122.99392462773652, 49.11883063166864], [-122.99392040352924, 49.118843473256945], [-122.99391859128903, 49.1188486582654], [-122.9939126589477, 49.118866684867285], [-122.99390689503537, 49.1188847114777], [-122.99390093426577, 49.11890273807736], [-122.99389446690806, 49.11892076464988], [-122.99389292949428, 49.11892460536255], [-122.99388684604486, 49.11893879116089], [-122.99387841648065, 49.11895681762849], [-122.99386954436036, 49.1189748440719], [-122.99386545817991, 49.11898295098006], [-122.99386014265636, 49.118992870486416], [-122.99385065215807, 49.11901089689537], [-122.99384175620082, 49.11902892333521], [-122.99383798729815, 49.11903728439711], [-122.99383335426987, 49.119046949800705], [-122.99382576099991, 49.11906497630877], [-122.9938194273039, 49.11908300288371], [-122.99381444108444, 49.11910102953046], [-122.99381086050391, 49.11911905625229], [-122.99381051257555, 49.11912200182891], [-122.99380858606959, 49.119137083044], [-122.99380788909006, 49.11915510992024], [-122.99380883410932, 49.119173136884484], [-122.99381050477754, 49.11918466921068], [-122.99381139408369, 49.11919116393523], [-122.99381544852409, 49.11920919106593], [-122.99382117367831, 49.11922721828586], [-122.99382864379669, 49.119245245598734], [-122.9938379593021, 49.11926327300957], [-122.9938379593021, 49.11926327300957], [-122.99384853295909, 49.11928130048664], [-122.99386114123244, 49.119299328070895], [-122.9938654184954, 49.1193047249621], [-122.99387529603142, 49.119317355735774], [-122.99389138012413, 49.11933538350094], [-122.99389287886909, 49.119336935757815], [-122.99390863979508, 49.11935341132585], [-122.99392033982309, 49.11936468972595], [-122.99392725813378, 49.11937143921959], [-122.99394670289611, 49.1193894671536], [-122.99394780104913, 49.11939045991246], [-122.99396644779588, 49.11940749509998], [-122.99397526244174, 49.119415089595655], [-122.99398748348253, 49.11942552311015], [-122.99400272416122, 49.119437234162774], [-122.99401136095885, 49.119443551263856], [-122.99403018638209, 49.119455404581984], [-122.99404104325806, 49.11946157971233], [-122.99405764908701, 49.119469691320454], [-122.9940811053764, 49.119479608685715], [-122.99408511214651, 49.11948112883416], [-122.99411257544318, 49.11949066939915], [-122.99413542105118, 49.119497638370056], [-122.99414003889075, 49.11949901865048], [-122.99416750240061, 49.11950691514501], [-122.99419496597748, 49.11951431207467], [-122.99420007967711, 49.119515668548836], [-122.99422242954431, 49.11952186603986], [-122.9942498931418, 49.1195292267934], [-122.99426712822056, 49.11953369881003], [-122.9942773567608, 49.119536471211504], [-122.99430482039101, 49.11954368765795], [-122.99433228408286, 49.11955043312366], [-122.99433776326896, 49.119551729208204], [-122.99435974778723, 49.1195571338309], [-122.99438721154871, 49.11956339376473], [-122.99441467538733, 49.11956902863496], [-122.99441860119254, 49.119569760056784], [-122.99444213927636, 49.11957426800112], [-122.99446960327819, 49.119578544512606], [-122.99449706741555, 49.11958163910571], [-122.99452453169235, 49.11958349805429], [-122.99455199609939, 49.1195841864401], [-122.99457946061652, 49.119583871418364], [-122.9946069252153, 49.11958280045143], [-122.99463438986493, 49.11958124718629], [-122.99466185454747, 49.11957937099096], [-122.99468931925543, 49.1195772375505], [-122.99471678397826, 49.11957494164063], [-122.99474424870674, 49.11957256848622], [-122.994771713435, 49.11957017260123], [-122.99477633396808, 49.11956977679656], [-122.99479917813112, 49.11956805868308], [-122.99482664281848, 49.119566006319566], [-122.99485410750401, 49.11956394988425], [-122.99488157219066, 49.119561860588114], [-122.99490903688528, 49.11955967083313], [-122.99493650160193, 49.11955724084527], [-122.99496396636555, 49.11955432066332], [-122.99498274734151, 49.11955175903887], [-122.99499143119452, 49.11955071919252], [-122.99501889609185, 49.119546395471644], [-122.99504636112309, 49.11954067933246], [-122.99507244198168, 49.11953373598953], [-122.99507382630206, 49.119533407604315], [-122.99510129150903, 49.119525769968384], [-122.99512875680684, 49.11951711890535], [-122.99513344353191, 49.11951571166455], [-122.99515622198416, 49.1195096068971], [-122.99518368697454, 49.119503939837195], [-122.99521115169716, 49.1195009888413], [-122.9952386161461, 49.11950086291128], [-122.99526608035607, 49.1195032463063], [-122.99529354439743, 49.119507439806696], [-122.99532100835815, 49.11951253934001], [-122.99533705308566, 49.119515720067504], [-122.99534847226404, 49.11951828568272], [-122.99537593614087, 49.11952441286262], [-122.99540340007839, 49.119529956449085], [-122.99542478183432, 49.11953375048978], [-122.9954308640688, 49.11953499089174], [-122.99545832807557, 49.11953990682033], [-122.99548579215744, 49.11954405542003], [-122.99551325629885, 49.11954759485752], [-122.9955407204828, 49.119550702948835], [-122.99555098942749, 49.119551782334554], [-122.99556818466472, 49.11955387261275], [-122.99559564884783, 49.11955706819363], [-122.99562311304234, 49.11956017468317], [-122.9956505772447, 49.1195632300876], [-122.99567804145532, 49.1195662296987], [-122.99570550567674, 49.11956914235964], [-122.9957121168673, 49.11956981534349], [-122.9957329698845, 49.11957225196467], [-122.99576043410761, 49.11957522152857], [-122.99578789835934, 49.11957789215964], [-122.99581536264283, 49.1195802201706], [-122.99584282696078, 49.11958216631539], [-122.99587029131548, 49.11958369601287], [-122.99589775570851, 49.11958478130048], [-122.99592522014066, 49.11958540391043], [-122.99595268461161, 49.11958555810253], [-122.99598014911994, 49.11958525167948], [-122.99600761366334, 49.119584504115544], [-122.996035078239, 49.11958334169997], [-122.99606254284413, 49.11958179055336], [-122.99609000747668, 49.119579868874], [-122.99611747213581, 49.11957757974051], [-122.99614493682226, 49.119574905346596], [-122.99617240153867, 49.119571802917356], [-122.99618774111107, 49.119569832028255], [-122.99619986628309, 49.119568289486615], [-122.9962273310621, 49.11956426851519], [-122.99625479589501, 49.119559473015364], [-122.99628226079375, 49.119553725764625], [-122.99629029702925, 49.1195518084568], [-122.99630972576921, 49.11954685850102], [-122.99633719084453, 49.11953853259189], [-122.99635075886009, 49.11953378347134], [-122.99636465604229, 49.11952840581617], [-122.99639212138115, 49.1195161791276], [-122.99639299446487, 49.11951575788619], [-122.99641958688615, 49.119501456901055], [-122.99642597566641, 49.11949773199941], [-122.99644705256641, 49.119484053571256], [-122.99645341575723, 49.119479705933074], [-122.99647451844238, 49.11946361790071], [-122.99647697714768, 49.11946167974186], [-122.99649757996951, 49.119443653456074], [-122.99650198456881, 49.11943929957773], [-122.99651561262495, 49.119425627089015], [-122.99652945104405, 49.11940959726315], [-122.99653116599015, 49.11940760064461], [-122.99654504601735, 49.119389574148], [-122.99655690790249, 49.11937154758949], [-122.99655691806551, 49.11937153017537], [-122.99656759103665, 49.11935352099468], [-122.99657650440975, 49.119335494346345], [-122.99658362827756, 49.11931746764434], [-122.99658438631494, 49.11931496814595], [-122.99658923260516, 49.11929944089694], [-122.99659302327463, 49.11928141409572], [-122.9965951252978, 49.11926338724453], [-122.99659581903528, 49.11924536035172], [-122.99659543230887, 49.119227333427006], [-122.99659426421532, 49.11920930647917], [-122.99659251780318, 49.11919127951422], [-122.99659026251119, 49.11917325253413], [-122.99658743855505, 49.11915522553717], [-122.99658439834838, 49.11913972825497], [-122.99658393531837, 49.11913719851995], [-122.99657982745012, 49.119119171484684], [-122.99657475797116, 49.11910114442069], [-122.9965686353616, 49.119083117325104], [-122.99656141271666, 49.119065090196386], [-122.99655693995264, 49.11905533547802], [-122.99655335214143, 49.11904706304216], [-122.99654455325502, 49.1190290358652], [-122.99653463162632, 49.11901100865382], [-122.99652947944548, 49.11900253949306], [-122.99652392434797, 49.1189929814179], [-122.9965122934078, 49.11897495415301], [-122.9965020182223, 49.1189607546422], [-122.99649935273088, 49.1189569268472], [-122.99648550464788, 49.11893889951226], [-122.996474556531, 49.11892622544115], [-122.99647006902367, 49.11892087212708], [-122.99645335661558, 49.11890284470055], [-122.99644709452011, 49.11889670425221], [-122.99643522758073, 49.11888481722782], [-122.99641963229197, 49.11887065413193], [-122.99641544984235, 49.118866789701016], [-122.99639431838266, 49.118848762128486], [-122.99639216991598, 49.11884703883808], [-122.99637204146376, 49.11883073451605], [-122.99636470743938, 49.118825157248374], [-122.99634843938517, 49.11881270685735], [-122.99633724489065, 49.11880458315305], [-122.99632363734636, 49.11879467915557], [-122.99630978228846, 49.1187850359674], [-122.99629772833845, 49.118776651412915], [-122.99628231964499, 49.11876632997588], [-122.9962707637602, 49.118758623630285], [-122.99625485696748, 49.118748350085255], [-122.9962427458704, 49.11874059580705], [-122.99622739425962, 49.11873103251667], [-122.99621362162966, 49.118722567940644], [-122.99619993152227, 49.118714350927355], [-122.99618327175232, 49.11870454002635], [-122.99617246875424, 49.11869830780873], [-122.99615149492121, 49.11868651205646], [-122.9961450059526, 49.11868292636214], [-122.99611800663011, 49.118668484020226], [-122.99611754311378, 49.11866823947394], [-122.99609008025458, 49.11865401783609], [-122.99608291618512, 49.11865045591988], [-122.99606261736153, 49.118640422291065], [-122.99604568208196, 49.11863242773541], [-122.99603515443316, 49.118627458230414], [-122.9960076914708, 49.118615095951036], [-122.99600610080694, 49.118614399457705], [-122.99598022849743, 49.11860303878307], [-122.99596405590901, 49.11859637108028], [-122.99595276548125, 49.11859167156431], [-122.99592530243801, 49.118580787875324], [-122.99591889617659, 49.118578342577415], [-122.99589783938822, 49.11857012912992], [-122.99587103695022, 49.11856031396032], [-122.99587037630087, 49.11856006471253], [-122.99584291324103, 49.11854980375429], [-122.99582173885508, 49.118542285271275], [-122.99581545015747, 49.11853996010378], [-122.99578798710323, 49.118529898216046], [-122.99577220125533, 49.11852425655234], [-122.99576052405601, 49.11851988423548], [-122.99573306103426, 49.11850970217842], [-122.99572365084542, 49.11850622784866], [-122.9957055980479, 49.11849924053027], [-122.99567813506823, 49.118488835087135], [-122.99567647406963, 49.11848819917596], [-122.9956506721481, 49.11847787994015], [-122.99563083300974, 49.118470170542054], [-122.99562320922676, 49.11846707584148], [-122.99559574636737, 49.1184557068562], [-122.99558724351039, 49.11845214196848], [-122.99556828355712, 49.11844392751417], [-122.99554459977526, 49.1184341134149], [-122.99554082072854, 49.11843249749049], [-122.99551335793201, 49.1184208519508], [-122.99550212825422, 49.118416084852214], [-122.99548589517914, 49.11840886730246], [-122.99546268895028, 49.118398056393055], [-122.99545843252275, 49.11839597075307], [-122.99543097005112, 49.11838121777231], [-122.99542895177679, 49.11838002814626], [-122.99540350777761, 49.118364496927924], [-122.99539955470604, 49.118362000062575], [-122.9953760456034, 49.11834690657307], [-122.99537123902617, 49.11834397201471], [-122.99534858337802, 49.118330071337674], [-122.99534090215131, 49.118325943878304], [-122.99532112098296, 49.118315237229965], [-122.99530502079256, 49.11830791550853], [-122.99529365839194, 49.11830264774411], [-122.99526619566757, 49.11829160531153], [-122.99526160619436, 49.11828988681861], [-122.99523873291629, 49.1182809716219], [-122.99521416315713, 49.118271857945395], [-122.99521127013817, 49.11827073830923], [-122.99518380740417, 49.118260166336746], [-122.99516663033882, 49.11825382904886], [-122.99515634465504, 49.118249869580445], [-122.99512888190237, 49.1182397251263], [-122.99511770229638, 49.11823580007369], [-122.99510141913711, 49.1182298222673], [-122.99507395634421, 49.11822030882464], [-122.99506629564087, 49.11821777097187], [-122.99504649355258, 49.11821088801299], [-122.99501903072616, 49.11820191888967], [-122.99501203170479, 49.11819974172367], [-122.99499156790075, 49.118193037576894], [-122.99496410503433, 49.118184658489845], [-122.99495377830702, 49.118181712275614], [-122.99493664215053, 49.11817654107248], [-122.99490917922701, 49.11816889931723], [-122.99488859691128, 49.118163682491584], [-122.99488171625308, 49.11816182948708], [-122.99485425325594, 49.118155059321126], [-122.99482679019042, 49.11814901866573], [-122.99480957875977, 49.11814565204947], [-122.99479932707636, 49.11814350600218], [-122.99477186392203, 49.11813843457003], [-122.99474440069977, 49.11813405878792], [-122.99471693741137, 49.118130351461396], [-122.99469241808725, 49.11812761980604], [-122.99468947406068, 49.11812726586282]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.750033685571847, "Contour_Level": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99493659393073, 49.11865024721615], [-122.99493228385793, 49.11865041114746], [-122.99490912986508, 49.118651209597665], [-122.99488166564184, 49.11865369328185], [-122.9948542012236, 49.1186580352317], [-122.99482673655884, 49.11866470152548], [-122.99481532241572, 49.11866843286942], [-122.99479927163038, 49.1186738194145], [-122.99477180633029, 49.118686377338264], [-122.99477165942145, 49.11868645781545], [-122.99474434057849, 49.118703079238315], [-122.99474239980242, 49.11870448340173], [-122.99472046265292, 49.11872250931561], [-122.99471687414747, 49.118726002389664], [-122.99470311077008, 49.11874053543575], [-122.99468956434531, 49.11875856172829], [-122.99468940663651, 49.11875880362653], [-122.99467775988634, 49.11877658809952], [-122.99466817715826, 49.11879461457211], [-122.9946619372474, 49.11880876837611], [-122.99466011185405, 49.11881264111404], [-122.99465249556951, 49.11883066767616], [-122.99464586411429, 49.11884869428338], [-122.99463987622666, 49.11886672092005], [-122.9946344650732, 49.118884040576006], [-122.99463421184683, 49.118884747571386], [-122.99462769839873, 49.11890277418288], [-122.99462145088317, 49.11892080080634], [-122.99461570906041, 49.118938827453], [-122.99461069374942, 49.11895685413322], [-122.99460699138154, 49.118972541907844], [-122.9946063474754, 49.118974880844426], [-122.99460205044859, 49.118992907557725], [-122.99459839875985, 49.119010934300995], [-122.9945955723808, 49.119028961082726], [-122.99459400145989, 49.11904698792313], [-122.99459415613191, 49.11906501484427], [-122.99459651251574, 49.11908304186841], [-122.99460150487118, 49.119101069015734], [-122.99460697606595, 49.119113801117784], [-122.99460904790877, 49.119119096281906], [-122.99461871651877, 49.119137123646624], [-122.9946318712213, 49.119155151172635], [-122.99463443550785, 49.11915812495301], [-122.99464691201516, 49.11917317878455], [-122.99466189656205, 49.11918788100295], [-122.99466526984786, 49.119191206547754], [-122.99468774219761, 49.11920923449738], [-122.99468935843149, 49.1192103088663], [-122.99471682097226, 49.11922664965973], [-122.99471799790015, 49.11922726279894], [-122.99474428391541, 49.11923935298825], [-122.9947596238755, 49.11924529160914], [-122.99477174710194, 49.11924987424705], [-122.99479921043219, 49.11925913190675], [-122.99481363278232, 49.11926332096124], [-122.99482667388929, 49.1192672684506], [-122.99485413746008, 49.11927439272827], [-122.9948816012766, 49.119279205646414], [-122.99490830097834, 49.1192813520883], [-122.99490906536481, 49.11928141603683], [-122.99493652967188, 49.119281500080056], [-122.9949494930536, 49.11928135389759], [-122.99496399401482, 49.11928123094431], [-122.99499145843969, 49.11928014534856], [-122.99501892292959, 49.11927839814685], [-122.99504638747824, 49.11927604174082], [-122.9950738520569, 49.11927335604121], [-122.99510131668382, 49.119270150288955], [-122.99512878131787, 49.1192668353872], [-122.99515624580282, 49.119265014087034], [-122.99518370996023, 49.11926655477962], [-122.99521117386436, 49.11927074380636], [-122.99523863768914, 49.119275810403714], [-122.99526610155625, 49.11928049072673], [-122.99527205864082, 49.119281367557626], [-122.99529356540181, 49.11928545352502], [-122.99532102935586, 49.119289320956206], [-122.99534849343851, 49.119291859153265], [-122.99537595762631, 49.119293296578796], [-122.99540342189057, 49.11929392326962], [-122.99543088623001, 49.11929373954047], [-122.99545835066212, 49.11929253850503], [-122.99548581519679, 49.1192901929387], [-122.99551327984113, 49.11928660247539], [-122.99554074460427, 49.11928164298652], [-122.99554199112963, 49.11928137829613], [-122.99556820943234, 49.11927589313707], [-122.99559567440384, 49.11926845169628], [-122.99561119549873, 49.11926335403438], [-122.99562313953341, 49.11925912056777], [-122.9956506048805, 49.11924718393199], [-122.99565435575319, 49.11924532875373], [-122.99567807054653, 49.11923142463878], [-122.99568435119804, 49.11922730296554], [-122.99570553664776, 49.119210423392], [-122.9957069119716, 49.11920927689328], [-122.99572527792829, 49.11919125066131], [-122.99573300340501, 49.119181504352824], [-122.9957397049875, 49.119173224281106], [-122.99575092681508, 49.1191551977811], [-122.9957584533938, 49.11913717114425], [-122.99576047213073, 49.11912911547181], [-122.99576321772581, 49.11911914440554], [-122.99576532182931, 49.11910111756901], [-122.99576488189408, 49.119083090639094], [-122.9957621378962, 49.11906506362458], [-122.99576047811898, 49.11905885716277], [-122.99575775315627, 49.119047036549674], [-122.9957517301331, 49.11902900941425], [-122.99574338750038, 49.11901098219296], [-122.99573301949573, 49.118993932342875], [-122.99573248641856, 49.11899295487648], [-122.99572064812071, 49.11897492752419], [-122.99570555853603, 49.11895690004973], [-122.99570555853603, 49.11895690004973], [-122.99568919350331, 49.11893887252562], [-122.99567809684308, 49.1189287775851], [-122.99566966279099, 49.11892084488044], [-122.99565063475791, 49.11890549559696], [-122.99564736109375, 49.11890281712747], [-122.99562317242052, 49.118885372446556], [-122.9956223509852, 49.11888478926747], [-122.9955957098755, 49.11886784506662], [-122.99559390148872, 49.1188667612708], [-122.99556824715067, 49.118852552993744], [-122.99556088323244, 49.11884873309146], [-122.99554078434502, 49.118838350590494], [-122.99552475838519, 49.11883070478226], [-122.99551332145388, 49.1188252700705], [-122.99548585846841, 49.118813388108435], [-122.9954841302227, 49.118812676285636], [-122.99545839548563, 49.11880162056212], [-122.99544057928568, 49.118794647659286], [-122.99543093244849, 49.118790585905764], [-122.99540346943343, 49.1187794443736], [-122.99539637470941, 49.11877661899038], [-122.99537600650314, 49.118767523465706], [-122.99535549914349, 49.118758590438446], [-122.99534854359703, 49.1187554842252], [-122.99532108061786, 49.11874436341376], [-122.99531139588984, 49.11874056174097], [-122.9952936176812, 49.11873292300014], [-122.99526796332609, 49.11872253305406], [-122.99526615473322, 49.11872173446104], [-122.99523869181037, 49.1187104120334], [-122.99522117681062, 49.118704504212005], [-122.99521122873357, 49.11870081897835], [-122.99518376558399, 49.11869208690678], [-122.99516325362804, 49.11868647488489], [-122.99515630234863, 49.11868433456597], [-122.99512883912068, 49.11867659388802], [-122.9951013757834, 49.118670050470705], [-122.99509340006553, 49.11866844502226], [-122.99507391241251, 49.11866391930737], [-122.99504644894684, 49.1186588077395], [-122.99501898536235, 49.11865493909151], [-122.99499152166463, 49.118652237508904], [-122.9949640578553, 49.118650667846225], [-122.9949461507503, 49.11865041175531], [-122.99493659393073, 49.11865024721615]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.49994149828929474, "Contour_Level": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99515628493967, 49.11886311232768], [-122.99512882133465, 49.11885821449625], [-122.99510135750862, 49.11885561558861], [-122.99507389346195, 49.11885527359964], [-122.99504642917887, 49.11885730921676], [-122.99501896457974, 49.11886247857735], [-122.99500517465752, 49.118866737301815], [-122.99499149964096, 49.11887096433133], [-122.99496403415498, 49.11888476242908], [-122.99496403415498, 49.11888476242908], [-122.99494047242003, 49.11890278831334], [-122.99493656781833, 49.11890676746149], [-122.99492373954223, 49.11892081449317], [-122.99491200170652, 49.11893884089078], [-122.99490909979838, 49.118944982107855], [-122.99490282057413, 49.11895686740002], [-122.99489611996931, 49.11897489401818], [-122.99489226684916, 49.11899292076188], [-122.99489121667196, 49.119010947629484], [-122.99489263590088, 49.119028974606266], [-122.99489688644492, 49.119047001708175], [-122.9949051097049, 49.11906502898525], [-122.99490908688965, 49.11907110784568], [-122.99491603027347, 49.11908305638049], [-122.99493162463065, 49.119101083979906], [-122.99493654760039, 49.11910538003383], [-122.99495364251362, 49.119119111858105], [-122.9949640098113, 49.11912520877974], [-122.99499086502637, 49.11913714039273], [-122.99499147281459, 49.11913738527977], [-122.99501893615536, 49.1191463262982], [-122.99504639997784, 49.11915052927903], [-122.99507386416151, 49.1191511321169], [-122.99510132861488, 49.119149003192234], [-122.99512879334438, 49.11914403079913], [-122.99515625776985, 49.11914212389424], [-122.995183721201, 49.11915046450136], [-122.99519980682841, 49.11915517618259], [-122.99521118464331, 49.11915878449756], [-122.99523864837748, 49.11916415197061], [-122.9952661124555, 49.11916596833743], [-122.99529357682825, 49.11916469109181], [-122.99532104149642, 49.11916025826827], [-122.99533890012452, 49.119155181881865], [-122.99534850648504, 49.11915234625235], [-122.995375971831, 49.11914049685788], [-122.99538215914461, 49.11913715670662], [-122.99540343775676, 49.11912223100545], [-122.99540741006834, 49.11911913080018], [-122.99542468921852, 49.119101104572515], [-122.9954309049688, 49.119089742905], [-122.9954349193469, 49.1190830780637], [-122.99544047683167, 49.11906505136949], [-122.99544128587583, 49.119047024487536], [-122.99543804526704, 49.119028997445604], [-122.99543091211528, 49.11901194340161], [-122.99543058741507, 49.11901097023666], [-122.99542079781646, 49.11899294293474], [-122.99540477190021, 49.11897491538388], [-122.99540345148007, 49.11897372612332], [-122.99538481596748, 49.11895688767371], [-122.9953759894624, 49.11895083400643], [-122.99535723754137, 49.11893885965375], [-122.99534852691461, 49.11893388101305], [-122.99532117293997, 49.11892083128356], [-122.99532106402322, 49.11892077994538], [-122.99529360106061, 49.118908584589434], [-122.99527926526143, 49.118902802663264], [-122.99526613806509, 49.11889687620085], [-122.99523867499249, 49.11888610834322], [-122.99523438874067, 49.11888477390521], [-122.99521121181527, 49.11887655076572], [-122.99518374843242, 49.11886922559886], [-122.99517110121319, 49.11886674436104], [-122.99515628493967, 49.11886311232768]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"name": "BB2", "Zm": 2.85, "lat": 49.119038, "lon": -122.99517, "canopy_height": 0.65}, "geometry": {"type": "Point", "coordinates": [-122.99517, 49.119038]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"name": "BB2", "Zm": 2.85, "lat": 49.119038, "lon": -122.99517, "canopy_height": 0.65}, "geometry": {"type": "Point", "coordinates": [-122.99517, 49.119038]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>