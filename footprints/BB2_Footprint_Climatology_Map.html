<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-122.99517, 49.119038], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.899996373912093, "info": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99565069833032, 49.11817843880275], [-122.99562323482333, 49.11817616963762], [-122.99559577105013, 49.11817693548504], [-122.99556830705949, 49.11818013238612], [-122.99556002803112, 49.11818173718197], [-122.99554084290425, 49.11818512591713], [-122.99551337861102, 49.11819158851239], [-122.99548591419, 49.11819938016493], [-122.99548473709267, 49.118199761178545], [-122.9954584497154, 49.11820766462209], [-122.99543098516297, 49.11821669709181], [-122.99542780861819, 49.118217785854625], [-122.99540352061472, 49.11822557603628], [-122.9953760560503, 49.11823452376775], [-122.99537192355427, 49.118235810544405], [-122.99534859155482, 49.118242628461275], [-122.99532112711705, 49.1182500240274], [-122.99530451242646, 49.118253834738894], [-122.99529366279003, 49.11825616335907], [-122.99526619861494, 49.11826063450809], [-122.99523873459245, 49.11826346037994], [-122.99521127074355, 49.11826445008167], [-122.99518380707266, 49.1182635902628], [-122.99515634356541, 49.118261059637796], [-122.99512888019122, 49.11825719904969], [-122.99510937925248, 49.11825382663786], [-122.99510141692126, 49.1182523230504], [-122.9950739537311, 49.118246695667395], [-122.99504649054154, 49.118241124634345], [-122.99501902730947, 49.11823603954799], [-122.99501743163229, 49.11823579578987], [-122.99499156402985, 49.11823148236767], [-122.99496410062756, 49.11822818694958], [-122.99493663706646, 49.118226487082666], [-122.99490917331055, 49.11822670918812], [-122.9948817093174, 49.118229234300856], [-122.99485424503325, 49.11823454561024], [-122.99485010132761, 49.118235788447166], [-122.99482678043096, 49.11824285978635], [-122.99480226842265, 49.11825381322006], [-122.99479931540098, 49.11825517658637], [-122.99477224470088, 49.118271838780856], [-122.99477184987364, 49.11827209607456], [-122.99474998336844, 49.11828986468702], [-122.9947443837146, 49.11829481765522], [-122.9947319163523, 49.11830789078031], [-122.99471691667782, 49.11832556700112], [-122.99471665553472, 49.11832591699916], [-122.99470386460466, 49.118343943329265], [-122.99469270894852, 49.11836196973308], [-122.99468944839109, 49.118367706267854], [-122.99468298229044, 49.11837999620158], [-122.99467445206847, 49.1183980227244], [-122.99466700094372, 49.11841604929639], [-122.99466197791628, 49.11842980134559], [-122.99466046154775, 49.11843407591001], [-122.99465456654713, 49.11845210255303], [-122.99464943643046, 49.11847012923114], [-122.99464500772253, 49.11848815594151], [-122.99464122349103, 49.11850618268159], [-122.99463803301717, 49.118524209449035], [-122.99463539160732, 49.11854223624188], [-122.9946345011581, 49.11854951170789], [-122.99463311061662, 49.11856026305132], [-122.99463122976456, 49.1185782898793], [-122.99462983084919, 49.118596316729594], [-122.99462890454546, 49.11861434360182], [-122.9946284514646, 49.11863237049599], [-122.99462848459696, 49.118650397412715], [-122.99462903268775, 49.11866842435336], [-122.99463014465648, 49.11868645132015], [-122.9946318949645, 49.11870447831658], [-122.99463438955671, 49.1187225053475], [-122.99463448244555, 49.11872298914218], [-122.99463712351903, 49.11874053238944], [-122.9946405984073, 49.11875855946564], [-122.9946449365819, 49.11877658658174], [-122.994650226445, 49.11879461374173], [-122.99465649333342, 49.11881264094662], [-122.9946619353326, 49.118826611004515], [-122.99466312358702, 49.11883066816793], [-122.99466797918235, 49.118848695306845], [-122.99467034979898, 49.11886672233082], [-122.9946637160113, 49.118884748938854], [-122.99466192896811, 49.11888591665434], [-122.99463446378351, 49.11889599689789], [-122.99460699896694, 49.11890257987535], [-122.99460602338804, 49.11890277317226], [-122.99457953441694, 49.118906649641296], [-122.9945520698317, 49.11891100059934], [-122.9945246051889, 49.1189158304487], [-122.99449910891546, 49.118920795042044], [-122.99449714048974, 49.118921121757964], [-122.99446967586061, 49.11892573045586], [-122.99444221116134, 49.11893092157607], [-122.9944147463862, 49.118936737215975], [-122.99440524947644, 49.118938817446136], [-122.99438728162825, 49.11894234368227], [-122.99435981684394, 49.118948127719605], [-122.99433235198134, 49.11895454312695], [-122.9943227915436, 49.11895684033507], [-122.99430488712737, 49.11896082111761], [-122.99427742224206, 49.1189673112181], [-122.99424995727624, 49.118974435828044], [-122.99424830014148, 49.11897486356224], [-122.99422249234624, 49.11898118433887], [-122.9941950273453, 49.11898847684485], [-122.99417910416906, 49.11899288700837], [-122.99416756231037, 49.11899599068895], [-122.99414009726006, 49.11900356450299], [-122.99411521451051, 49.11901091068356], [-122.99411263213894, 49.11901166587927], [-122.99408516702576, 49.11901962524679], [-122.99405770183455, 49.11902816425872], [-122.99405520387876, 49.119028934523165], [-122.9940302366384, 49.119036665754415], [-122.99400277137329, 49.11904566134925], [-122.99399878795091, 49.11904695851842], [-122.9939753060861, 49.11905475717536], [-122.99394784073395, 49.11906430461324], [-122.9939458646815, 49.11906498266925], [-122.99392037534956, 49.119074029281634], [-122.99389598713037, 49.11908300695683], [-122.9938929098997, 49.11908419970309], [-122.99386544440148, 49.11909467149806], [-122.99384903415353, 49.11910103137865], [-122.9938379788352, 49.11910559897044], [-122.99381051320546, 49.119116939530436], [-122.99380532589967, 49.119119055955466], [-122.99378304749062, 49.11912886085857], [-122.9937643772111, 49.11913708066474], [-122.99375558169378, 49.11914133050869], [-122.99372811580528, 49.11915441772924], [-122.99372663661279, 49.11915510553383], [-122.99370064977367, 49.119168521002486], [-122.99369154719585, 49.1191731305354], [-122.99367318359614, 49.11918364884401], [-122.99365968598201, 49.11919115570358], [-122.99364571722968, 49.11920012502406], [-122.9936310528796, 49.119209181041036], [-122.99361825059816, 49.11921852529708], [-122.99360577297188, 49.119227206557106], [-122.9935907835652, 49.119239883287136], [-122.99358409252194, 49.119245232267644], [-122.9935662186732, 49.119263258186265], [-122.99356331573232, 49.11926724044273], [-122.99355228041819, 49.1192812843219], [-122.99354296952171, 49.11929931071469], [-122.99353865899485, 49.119317337386654], [-122.99353984653511, 49.11933536436615], [-122.99354736125665, 49.119353391699384], [-122.99356243041059, 49.119371419453536], [-122.993563302159, 49.11937213041237], [-122.9935861163298, 49.119389447684696], [-122.99359076395407, 49.11939208061756], [-122.9936182264966, 49.119406376900784], [-122.99362051478867, 49.11940747650336], [-122.99364568945641, 49.11941753030518], [-122.9936681232517, 49.11942550603696], [-122.99367315263228, 49.119427081875905], [-122.99370061600207, 49.1194351855327], [-122.99372807949122, 49.11944241364348], [-122.99373260769113, 49.119443536468225], [-122.99375554308426, 49.1194488776602], [-122.99378300675828, 49.11945475106808], [-122.9938104705028, 49.119460109982164], [-122.99381834094805, 49.119461568003075], [-122.99383793429256, 49.119465151507896], [-122.99386539812542, 49.11946988846745], [-122.99389286200139, 49.119474317204315], [-122.99392032591491, 49.11947847846134], [-122.99392794431795, 49.11947960073207], [-122.99394778983462, 49.11948262698726], [-122.99397525376936, 49.11948668887886], [-122.99400271772504, 49.1194906145311], [-122.99403018169795, 49.11949443266407], [-122.99405360485194, 49.119497634185116], [-122.99405764567791, 49.11949822700207], [-122.99408510962678, 49.119502318162056], [-122.99411257358106, 49.11950640168356], [-122.9941400375385, 49.119510496758835], [-122.99416750149722, 49.11951461946969], [-122.99417429104676, 49.11951566725044], [-122.99419496540949, 49.11951917898252], [-122.99422242930297, 49.11952394375245], [-122.99424989319294, 49.11952878440638], [-122.99427735708001, 49.119533696699364], [-122.99427737120973, 49.1195336993182], [-122.99430482088974, 49.11953933186862], [-122.99433228469864, 49.11954502885709], [-122.9943597485098, 49.11955076158227], [-122.99436429140859, 49.11955173050619], [-122.99438721225526, 49.11955713257657], [-122.99441467599617, 49.11956360667884], [-122.99444102386401, 49.119569761138585], [-122.99444213974782, 49.1195700485649], [-122.99446960342944, 49.11957718428154], [-122.99449706713638, 49.11958416242897], [-122.9945115908487, 49.11958779142703], [-122.99452453082779, 49.119591351584454], [-122.99455199450479, 49.11959874507067], [-122.99457945822446, 49.11960582154554], [-122.99457945822446, 49.11960582154554], [-122.99460692189845, 49.1196133914904], [-122.99463438563117, 49.11962049460858], [-122.99464819330838, 49.11962385166432], [-122.99466184938572, 49.119627467392704], [-122.99468931317426, 49.119634194007844], [-122.9947167770449, 49.11964021720038], [-122.9947252695837, 49.119641882123524], [-122.99474424095983, 49.119645884579796], [-122.99477170495474, 49.119650850398784], [-122.99479916905028, 49.119654906527785], [-122.99482663324656, 49.119658036911915], [-122.99484991476146, 49.11965991466293], [-122.99485409753856, 49.11966027554866], [-122.99488156191131, 49.119661753500175], [-122.994909026364, 49.11966246630504], [-122.99493649087101, 49.119662653387884], [-122.99496395541114, 49.1196625153874], [-122.99499141997426, 49.119662147426816], [-122.99501888456145, 49.11966153515673], [-122.99504634918073, 49.119660593861866], [-122.9950595034019, 49.11965992382191], [-122.9950738138349, 49.11965928963475], [-122.99510127852704, 49.119657585102125], [-122.99512874326948, 49.1196553480722], [-122.99515620806531, 49.119652537276444], [-122.99518367291537, 49.11964913451388], [-122.99521113781825, 49.11964514406748], [-122.99523071879767, 49.11964190410962], [-122.99523860275478, 49.11964075584311], [-122.99526606768991, 49.119636331677455], [-122.99529353265515, 49.11963153763361], [-122.99532099764181, 49.119626459400436], [-122.99533459243442, 49.11962388144174], [-122.9953484626066, 49.1196215553659], [-122.99537592753828, 49.11961694896838], [-122.99540339245729, 49.11961242466247], [-122.99543085735182, 49.11960811256234], [-122.99544656768305, 49.11960585900017], [-122.99545832218917, 49.11960437452914], [-122.9954857869584, 49.1196013414398], [-122.9955132516801, 49.11959879828109], [-122.9955407163495, 49.11959680692107], [-122.9955681809649, 49.119595397224266], [-122.99559564552753, 49.11959456552162], [-122.99562311004145, 49.11959427731642], [-122.99565057451271, 49.11959447317008], [-122.99567803894881, 49.11959507625819], [-122.99570550335788, 49.119596000120566], [-122.99573296774811, 49.11959715548806], [-122.99576043212727, 49.1195984555497], [-122.99578789650248, 49.11959981946869], [-122.99581536087993, 49.119601174278834], [-122.99584282526507, 49.1196024554732], [-122.99587028966239, 49.11960360665805], [-122.99589775407577, 49.1196045786227], [-122.99592521850843, 49.11960532811113], [-122.99595268296318, 49.11960581650108], [-122.99596167818346, 49.11960587816679], [-122.99598014744141, 49.11960602106534], [-122.99600593701987, 49.11960587970639], [-122.99600761194833, 49.11960587106541], [-122.99603507648288, 49.11960537215163], [-122.99606254104803, 49.119604479980076], [-122.99609000564566, 49.119603162115396], [-122.99611747027768, 49.11960138475138], [-122.99614493494613, 49.11959911205298], [-122.99617239965315, 49.11959630556899], [-122.99619986440104, 49.119592923711764], [-122.99622732919224, 49.11958892130238], [-122.99623381236842, 49.11958786045259], [-122.9962547940163, 49.11958442427466], [-122.99628225888526, 49.11957925954676], [-122.99630972380676, 49.11957330978219], [-122.99632414459074, 49.11956983645171], [-122.99633718877615, 49.11956662074201], [-122.9963646537976, 49.1195591181781], [-122.9963883852799, 49.11955181156686], [-122.99639211888342, 49.11955061397219], [-122.99641958402984, 49.119541137734714], [-122.99643877835007, 49.119533786219904], [-122.99644704925407, 49.11953042520503], [-122.99647451456286, 49.11951835280224], [-122.99648003985365, 49.11951576057286], [-122.99650197997455, 49.119504627847256], [-122.99651464758891, 49.11949773471033], [-122.99652944551212, 49.11948888151636], [-122.99654395486245, 49.11947970867882], [-122.99655691121218, 49.11947053651239], [-122.99656890649159, 49.11946168251045], [-122.9965843771369, 49.11944862479945], [-122.99659009277259, 49.1194436562255], [-122.99660803356267, 49.11942562984129], [-122.99661184341804, 49.119421125301216], [-122.99662316006896, 49.119407603371954], [-122.99663547371335, 49.11938957681866], [-122.99663931041242, 49.11938262009173], [-122.99664545793016, 49.11937155019631], [-122.99665319031216, 49.119353523507804], [-122.99665869728804, 49.11933549675433], [-122.99666215919716, 49.11931746994143], [-122.99666371611227, 49.11929944307333], [-122.99666347131642, 49.119281416153115], [-122.99666149387863, 49.11926338918275], [-122.99665782042558, 49.119245362163205], [-122.9966524561775, 49.11922733509449], [-122.99664537529084, 49.11920930797559], [-122.99663932295663, 49.11919695661271], [-122.99663670860701, 49.11919128081001], [-122.99662672094414, 49.119173253605126], [-122.99661489698724, 49.11915522634551], [-122.9966118618048, 49.11915119356363], [-122.99660184376711, 49.119137199048446], [-122.9965869934947, 49.11911917169675], [-122.99658439995329, 49.119116356128], [-122.9965709621125, 49.119101144308004], [-122.9965569377543, 49.11908709395984], [-122.99655311682706, 49.11908311686284], [-122.99653389459198, 49.11906508937353], [-122.99652947534446, 49.119061317426905], [-122.99651324549252, 49.119047061837875], [-122.99650201278341, 49.11903809525642], [-122.99649093509225, 49.11902903424799], [-122.9964745501143, 49.11901675979095], [-122.99646702259543, 49.119011006604715], [-122.99644708736058, 49.11899693842057], [-122.99644156492049, 49.11899297890883], [-122.99641962454155, 49.11897832872747], [-122.99641462737794, 49.11897495116133], [-122.99639216167316, 49.118960682850435], [-122.99638629622905, 49.11895692336386], [-122.99636469876872, 49.11894379705212], [-122.99635669055886, 49.11893889551917], [-122.99633723583925, 49.11892750368409], [-122.99632596929244, 49.118920867631346], [-122.99630977289412, 49.11891166434665], [-122.99629432881244, 49.11890283970579], [-122.99628230994112, 49.11889616427383], [-122.99626198846417, 49.11888481174884], [-122.99625484698686, 49.118880908501815], [-122.99622916509657, 49.11886678376702], [-122.99622738403671, 49.11886582028224], [-122.99619992110492, 49.11885071012021], [-122.99619641586663, 49.11884875577822], [-122.996172458191, 49.11883558442406], [-122.99616368946708, 49.11883072778086], [-122.99614499529133, 49.118820490262856], [-122.99613084312337, 49.118812699770125], [-122.99611753240495, 49.118805439541255], [-122.99609782906226, 49.11879467174434], [-122.99609006952946, 49.118790461343174], [-122.99606455574053, 49.118776643700215], [-122.99606260666187, 49.11877559268137], [-122.99603514381519, 49.118760667292825], [-122.99603137087362, 49.118758615649476], [-122.99600768098611, 49.1187457281809], [-122.99599818937904, 49.11874058758927], [-122.9959802181764, 49.11873075365269], [-122.99596530006771, 49.11872255952968], [-122.99595275540665, 49.118715491136925], [-122.99593373407897, 49.11870453150726], [-122.995925292719, 49.11869943218155], [-122.99590497448892, 49.118686503575745], [-122.99589783019573, 49.11868159467824], [-122.99588035866817, 49.11866847578495], [-122.99587036799902, 49.11866006132159], [-122.9958602881935, 49.118650448151904], [-122.99584423689416, 49.11863242066007], [-122.99584290649139, 49.11863056707669], [-122.9958330342875, 49.11861439334104], [-122.99582462597688, 49.11859636612195], [-122.99581857190795, 49.1185783389875], [-122.99581544808838, 49.11856455554207], [-122.99581462889721, 49.1185603119292], [-122.99581242362282, 49.11854228493378], [-122.9958111294517, 49.118524257971295], [-122.99581042652649, 49.11850623103021], [-122.99581004636246, 49.11848820410076], [-122.99580977143921, 49.1184701771751], [-122.995809428258, 49.118452150246895], [-122.99580887759888, 49.11843412331108], [-122.99580800396096, 49.11841609636351], [-122.99580670520527, 49.11839806940042], [-122.99580488314244, 49.118380042418245], [-122.99580243564282, 49.118362015413254], [-122.99579925036106, 49.118343988381305], [-122.9957951995196, 49.11832596131769], [-122.99579013486262, 49.11830793421692], [-122.99578800644298, 49.11830150327902], [-122.99578380267629, 49.118289907069595], [-122.99577586405769, 49.11827187986309], [-122.99576601161952, 49.118253852585816], [-122.99576054745637, 49.118245324687116], [-122.99575323459113, 49.1182358252001], [-122.99573650598892, 49.118217797667064], [-122.99573308635023, 49.11821457831414], [-122.99571202194073, 49.118199769843756], [-122.99570562424061, 49.118195848492384], [-122.9956781615053, 49.11818455809375], [-122.9956659600452, 49.11818174120721], [-122.99565069833032, 49.11817843880275]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.750048841913615, "info": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.9953210864285, 49.1186825903877], [-122.99529362283332, 49.11867847037401], [-122.99526615902747, 49.1186766117563], [-122.99523869505767, 49.118676487334696], [-122.99521123095332, 49.11867776213258], [-122.99518376672931, 49.11868025802138], [-122.99515630238864, 49.11868392362608], [-122.99514161903708, 49.11868647397651], [-122.9951288379602, 49.11868844435979], [-122.99510137344552, 49.11869378986178], [-122.9950739087678, 49.11870072215488], [-122.99506173940509, 49.11870449750248], [-122.9950464439491, 49.118708993354346], [-122.99501897891328, 49.118719341050344], [-122.99501208280076, 49.1187225222828], [-122.99499151363233, 49.118732010349355], [-122.99497678076067, 49.11874054766716], [-122.99496404798123, 49.11874819710234], [-122.99494975543256, 49.11875857340301], [-122.9949365818492, 49.11876893288343], [-122.99492817728023, 49.1187765993719], [-122.99491064882416, 49.11879462551528], [-122.99490911501192, 49.118796335935585], [-122.99489578613678, 49.11881265177383], [-122.99488389094215, 49.11883067816195], [-122.99488164703901, 49.118834480924704], [-122.99487345544698, 49.11884870461361], [-122.99486456465169, 49.118866731133], [-122.99485710596527, 49.11888475771545], [-122.99485417690764, 49.11889308329809], [-122.99485060464235, 49.11890278434006], [-122.9948459402138, 49.118920811046266], [-122.99484268811682, 49.11893883781532], [-122.99482670622811, 49.118956333791125], [-122.99482577480383, 49.1189568639728], [-122.99479924111426, 49.1189656844229], [-122.9947731459681, 49.11897488851632], [-122.99477177595801, 49.118975340633106], [-122.99474431088476, 49.1189841101463], [-122.99472004786095, 49.11899291301433], [-122.99471684567209, 49.118994101146946], [-122.99468938041136, 49.119004439082076], [-122.99467354118018, 49.119010937792154], [-122.99466191497571, 49.1190163006134], [-122.99463561003387, 49.11902896294997], [-122.99463444936814, 49.11902963415866], [-122.99460698352473, 49.119045007222404], [-122.99460338658237, 49.1190469883622], [-122.99457951734567, 49.11906330487973], [-122.99457688879566, 49.11906501403446], [-122.99455533242507, 49.11908303993373], [-122.99455205056682, 49.11908689390268], [-122.99453849042122, 49.119101066052025], [-122.99452727331004, 49.11911909243457], [-122.99452458188661, 49.11912751903908], [-122.99452097210424, 49.11913711904938], [-122.99452038568461, 49.119155145935146], [-122.99452457744424, 49.11916787531988], [-122.99452627719492, 49.11917317312817], [-122.99453906811767, 49.11919120064739], [-122.99455203793256, 49.11920224693567], [-122.99456078625, 49.119209228586044], [-122.9945795002479, 49.11922020161387], [-122.99459302182792, 49.11922725701361], [-122.99460696310659, 49.119233327429725], [-122.99463442627784, 49.11924369018294], [-122.99463915696694, 49.119245286078346], [-122.99466188963062, 49.11925246829562], [-122.99468935314923, 49.119259783690225], [-122.99470480087828, 49.11926331602101], [-122.9947168167776, 49.11926614200171], [-122.99474428047895, 49.11927187584307], [-122.994771744286, 49.119276664524094], [-122.99479920818484, 49.11928062566758], [-122.99480499884072, 49.11928134748626], [-122.99482667210098, 49.11928446271271], [-122.99485413607778, 49.119287754252255], [-122.99488160012619, 49.119290385331674], [-122.99490906424222, 49.11929238407801], [-122.99493652842403, 49.119293758145446], [-122.99496399267215, 49.1192944926677], [-122.99499145698923, 49.11929455009864], [-122.99501892136087, 49.11929406334291], [-122.99504091073484, 49.11929938477361], [-122.99504638497253, 49.1193012024043], [-122.99507271804148, 49.11931741304857], [-122.99507384763076, 49.11931804784024], [-122.99510131086701, 49.11932921322699], [-122.99512877463845, 49.11933503964512], [-122.99513205427611, 49.11933544247869], [-122.99515623859111, 49.11933907138886], [-122.9951837027136, 49.11934139491965], [-122.99521116694838, 49.11934257866471], [-122.99523863126447, 49.11934292677046], [-122.99526609564361, 49.119342616434906], [-122.99529356006397, 49.11934186685546], [-122.9953210245151, 49.11934078146187], [-122.99534848900586, 49.11933925944115], [-122.99537595355336, 49.11933710884643], [-122.99539158239168, 49.119335453129686], [-122.9954034181504, 49.11933439652465], [-122.99543088279287, 49.11933115704092], [-122.99545834752381, 49.11932690970511], [-122.9954858123502, 49.11932155874969], [-122.99550391354053, 49.11931743064581], [-122.99551327724565, 49.119315376467426], [-122.9955407421837, 49.119308642877954], [-122.99556820721257, 49.11930080676705], [-122.99557293361937, 49.11929940639992], [-122.9955956722675, 49.119292578503554], [-122.99562313740839, 49.11928327011626], [-122.99562840624247, 49.119281381600544], [-122.99565060262721, 49.119272953012114], [-122.99567244785341, 49.119263356346565], [-122.99567806801238, 49.119260590007755], [-122.99570553363397, 49.119245330668704], [-122.99570553363397, 49.119245330668704], [-122.99573081842719, 49.11922730469314], [-122.99573299964464, 49.119225339198714], [-122.99575024421517, 49.11920927849644], [-122.99576046640362, 49.11919630936266], [-122.99576446630293, 49.119191252105644], [-122.9957750317086, 49.11917322557927], [-122.99578173958702, 49.119155198911], [-122.99578523718102, 49.11913717212512], [-122.99578593990738, 49.11911914523712], [-122.99578407093574, 49.11910111825517], [-122.99577970573273, 49.11908309118191], [-122.99577317247338, 49.1190650640291], [-122.99576541608556, 49.11904703683098], [-122.99576048001447, 49.11903661810428], [-122.99575742120673, 49.119029009623524], [-122.99574902818739, 49.119010982400795], [-122.99573847404152, 49.11899295509765], [-122.99573302021706, 49.11898552375846], [-122.99572611272873, 49.11897492772661], [-122.99571102487435, 49.118956900252925], [-122.99570555900382, 49.11895148177549], [-122.99569360473023, 49.118938872690244], [-122.99567809714037, 49.118925356213346], [-122.99567312598634, 49.11892084501028], [-122.99565063497472, 49.118903016040136], [-122.99565039242471, 49.11890281724171], [-122.99562719932845, 49.1188847894512], [-122.99562317273781, 49.118881766530684], [-122.99560430754887, 49.11886676166746], [-122.99559571057424, 49.118859953670004], [-122.9955826024773, 49.11884873392451], [-122.99556824857284, 49.11883659082362], [-122.99556174138533, 49.1188307062099], [-122.99554078662852, 49.11881287870491], [-122.99554055175007, 49.11881267847875], [-122.99551782031884, 49.11879465068381], [-122.99551332451162, 49.11879137062101], [-122.99548992413462, 49.11877662268271], [-122.99548586204183, 49.11877401236881], [-122.99546018765437, 49.11875859460245], [-122.99545839953868, 49.118757229975735], [-122.99543879246106, 49.11874056684433], [-122.99543093767785, 49.11873365600259], [-122.99541619717579, 49.11872253903453], [-122.9954034755054, 49.11871373638334], [-122.99538613055414, 49.11870451092192], [-122.99537601283872, 49.11869936973045], [-122.99534854978313, 49.11868933156048], [-122.99533674240834, 49.11868648202263], [-122.9953210864285, 49.1186825903877]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.49995134502268423, "info": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99526613990707, 49.11887752156611], [-122.99523867623725, 49.11887310452564], [-122.99521121242974, 49.118870168236334], [-122.99518374839204, 49.1188696428643], [-122.99515628403209, 49.11887243242534], [-122.99512881930346, 49.11887895569752], [-122.9951137059538, 49.11888476886064], [-122.99510135421204, 49.118889089389754], [-122.99507520519089, 49.11890279413916], [-122.99507388868575, 49.11890350122528], [-122.99504770264869, 49.11892081987707], [-122.99504642276112, 49.11892175297031], [-122.99502040226204, 49.11893884561709], [-122.99501895685962, 49.11893957259895], [-122.99499149112286, 49.118955560815664], [-122.99498993129754, 49.118956871213044], [-122.99498156065339, 49.11897489776368], [-122.99497836694441, 49.118992924538915], [-122.99496402207747, 49.11900405423132], [-122.99495344125737, 49.119010950366146], [-122.99493655629841, 49.11901993448396], [-122.9949195441659, 49.1190289757935], [-122.99490909035244, 49.119037274348315], [-122.99489643325175, 49.119047001688145], [-122.99488542461079, 49.11906502811488], [-122.99488309352111, 49.11908305492542], [-122.99488870837492, 49.11910108208791], [-122.99490498960813, 49.11911910972127], [-122.99490908168703, 49.11912194015371], [-122.99493577314479, 49.11913713798933], [-122.99493654433367, 49.119137470667], [-122.9949640075612, 49.11914743305255], [-122.99499147117828, 49.11915363575735], [-122.99500253955898, 49.119155167812266], [-122.99501893502222, 49.11915764181849], [-122.99504639907576, 49.11915958748903], [-122.99507386336255, 49.11915919957129], [-122.99510132778573, 49.11915742248006], [-122.99511101923272, 49.11917319937046], [-122.99512803171919, 49.11919122700312], [-122.99512878866754, 49.11919178678269], [-122.9951562525691, 49.11919553077844], [-122.99518371694664, 49.119194401998456], [-122.99521118117585, 49.11919480063239], [-122.99523864515565, 49.11919780956198], [-122.9952661092851, 49.11919928090006], [-122.99529357373875, 49.11919734310254], [-122.99532103858255, 49.119191234986424], [-122.99532103858255, 49.119191234986424], [-122.99534850382663, 49.11918077414587], [-122.99536150675583, 49.119173209705885], [-122.99537596991395, 49.119161118361745], [-122.9953827679741, 49.11915518364459], [-122.99540106644753, 49.11913715746132], [-122.99540343659403, 49.11913481342568], [-122.99541992254743, 49.11911913129723], [-122.9954309037977, 49.119102492202266], [-122.99543188189139, 49.11910110485733], [-122.99544033483846, 49.119083078277704], [-122.99544409810478, 49.11906505151244], [-122.9954504782661, 49.11904702485015], [-122.99545837449384, 49.11903152949326], [-122.9954597928083, 49.11902899830287], [-122.99545961681035, 49.11901097138194], [-122.99545837661248, 49.11900832559338], [-122.99545248943227, 49.11899294418738], [-122.99543991311378, 49.11897491677722], [-122.99543091638516, 49.118965459558396], [-122.99542358156619, 49.11895688921685], [-122.99540409033705, 49.11893886152836], [-122.99540345475444, 49.11893829280818], [-122.99538551711257, 49.11892083387322], [-122.99537599299893, 49.11891279089318], [-122.99536188003091, 49.118902806011725], [-122.99534853041804, 49.11889641678166], [-122.99532106670881, 49.118892229915325], [-122.99529360314128, 49.11888659430952], [-122.99528780978873, 49.11888477609792], [-122.99526613990707, 49.11887752156611]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"index": "BB2", "name": "Burns Bog 2", "Zm": 2.85, "lat": 49.119038, "lon": -122.99517, "canopy_height": 0.65, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/burnsbog2.html#", "info": "https://ubc-micromet.github.io/Data.html#burns-bog-2"}, "geometry": {"type": "Point", "coordinates": [-122.99517, 49.119038]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"index": "BB2", "name": "Burns Bog 2", "Zm": 2.85, "lat": 49.119038, "lon": -122.99517, "canopy_height": 0.65, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/burnsbog2.html#", "info": "https://ubc-micromet.github.io/Data.html#burns-bog-2"}, "geometry": {"type": "Point", "coordinates": [-122.99517, 49.119038]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>