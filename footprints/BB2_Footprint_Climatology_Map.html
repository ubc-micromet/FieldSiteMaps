<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-122.99517, 49.119038], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.8999986295664394, "Contour_Level": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99441563600075, 49.11774676430958], [-122.9943882006556, 49.1177411602256], [-122.994360765128, 49.11773722026846], [-122.99433332940055, 49.1177350725906], [-122.99430589344823, 49.117734910244124], [-122.99427845723655, 49.117737004125], [-122.99425102071943, 49.117741720959955], [-122.99422358383592, 49.11774954815379], [-122.99422160411754, 49.11775032215123], [-122.99419614651835, 49.117761021510844], [-122.99418307554215, 49.11776832908946], [-122.9941687086449, 49.11777712864283], [-122.9941565397425, 49.11778633662237], [-122.99414127004323, 49.11779926801994], [-122.99413616852978, 49.1178043444624], [-122.99411990789925, 49.1178223525082], [-122.99411383040322, 49.11782997577236], [-122.9941064456084, 49.11784036069455], [-122.99409516577572, 49.117858368990895], [-122.99408638905912, 49.117874732635734], [-122.99408557372585, 49.11787637737257], [-122.99407752884245, 49.11789438583278], [-122.99407071038578, 49.117912394355336], [-122.99406500076886, 49.11793040293447], [-122.99406029857776, 49.11794841156508], [-122.99405894346462, 49.117954663543365], [-122.99405647384592, 49.11796642024063], [-122.99405346074067, 49.1179844289578], [-122.99405122121928, 49.11800243771468], [-122.99404970738411, 49.118020446508886], [-122.99404887833097, 49.1180384553383], [-122.99404869953887, 49.11805646420119], [-122.99404914241029, 49.118074473096065], [-122.99405018394923, 49.11809248202172], [-122.99405180656801, 49.118110490977266], [-122.99405399801825, 49.118128499962005], [-122.99405675144499, 49.11814650897561], [-122.99405891915565, 49.11815819534669], [-122.99405999537764, 49.11816451801431], [-122.99406361736379, 49.1181825270723], [-122.9940677446829, 49.11820053615609], [-122.99407238650075, 49.11821854526609], [-122.9940775586055, 49.118236554403055], [-122.99408328415718, 49.118254563568094], [-122.99408634287057, 49.11826324934752], [-122.99408932817853, 49.11827257274911], [-122.99409565148893, 49.118290581944024], [-122.99410252937815, 49.11830859116686], [-122.99411001021676, 49.11832660041999], [-122.99411377065188, 49.118334918508864], [-122.99411773193451, 49.118344609684875], [-122.99412569497673, 49.11836261896145], [-122.9941343144736, 49.118380628270764], [-122.99414120000617, 49.11839390374777], [-122.99414341059325, 49.118398637603576], [-122.99415245856974, 49.11841664693316], [-122.99416226492822, 49.11843465630034], [-122.99416863029599, 49.11844546383952], [-122.99417243406897, 49.118452665684934], [-122.99418265975511, 49.11847067507143], [-122.99419381559238, 49.118488684503745], [-122.99419606122103, 49.118492067272435], [-122.994204738118, 49.1185066939232], [-122.9942163715646, 49.118524703377204], [-122.99422349263985, 49.118534861136744], [-122.9942283965905, 49.118542712849546], [-122.99424054085638, 49.11856072232653], [-122.99425092444335, 49.118574734930284], [-122.99425355550177, 49.11857873184549], [-122.9942662730647, 49.11859674134819], [-122.99427835657349, 49.11861215158383], [-122.9942801624397, 49.118614750907476], [-122.99429355169025, 49.118632760440335], [-122.99430578898196, 49.11864749709196], [-122.99430819189836, 49.11865077003325], [-122.99432238987997, 49.11866877960252], [-122.99433322162727, 49.11868110619591], [-122.99433763061602, 49.11868678922114], [-122.99435279952665, 49.118704798834145], [-122.99436065447121, 49.118713290095656], [-122.99436842458148, 49.118722808467375], [-122.99438469163982, 49.118740818129645], [-122.99438808747651, 49.11874435856132], [-122.99440033736657, 49.11875882775944], [-122.99441552057839, 49.11877487168496], [-122.99441715593137, 49.11877683744379], [-122.99443262729719, 49.11879484706066], [-122.99444295364471, 49.11880600467662], [-122.99444852005033, 49.118812856695676], [-122.9944634409721, 49.11883086628183], [-122.99447038649721, 49.11883936966587], [-122.99447715989322, 49.11884887580854], [-122.9944891022345, 49.11886688524874], [-122.99449781834738, 49.118882128796706], [-122.99449917765084, 49.11888489459873], [-122.99450453821004, 49.118902903723445], [-122.99450568762573, 49.11892091264754], [-122.99450123625921, 49.11893892130493], [-122.99449781138945, 49.11894503052624], [-122.99448919620292, 49.118956929600145], [-122.99447116814117, 49.11897493760745], [-122.99447037135332, 49.11897559538807], [-122.99444713241513, 49.118992945323065], [-122.99444293243464, 49.11899585632092], [-122.99442013270891, 49.11901095289042], [-122.99441549374255, 49.11901389954022], [-122.99439142385333, 49.11902896036838], [-122.99438805513749, 49.11903099508415], [-122.99436166512467, 49.11904696778791], [-122.99436061657158, 49.11904757888551], [-122.9943331780551, 49.1190635685387], [-122.99433078012817, 49.11906497514439], [-122.99430573957362, 49.11907909813611], [-122.99429898074132, 49.11908298244741], [-122.99427830110182, 49.1190943945117], [-122.99426661187415, 49.11910098971332], [-122.99425086263008, 49.1191095445904], [-122.99423385928107, 49.11911899695095], [-122.99422342415093, 49.119124614423725], [-122.99420090912034, 49.1191370041693], [-122.99419598565927, 49.119139648985026], [-122.99416854715835, 49.119154620913655], [-122.99416782835111, 49.1191550113716], [-122.99414110868385, 49.119169228619725], [-122.99413411536793, 49.11917301853227], [-122.99411367017699, 49.11918397338907], [-122.994100685609, 49.11919102569746], [-122.99408623163654, 49.11919886378158], [-122.99406762837557, 49.11920903287209], [-122.9940587930619, 49.119213903088905], [-122.99403500619194, 49.11922704005967], [-122.99403135445246, 49.11922909399136], [-122.99400391581307, 49.119244394229405], [-122.99400272837136, 49.119245047255866], [-122.99397647714738, 49.11925977237658], [-122.9939705952597, 49.11926305445054], [-122.99394903842988, 49.119275436896785], [-122.99393913327032, 49.11928106167145], [-122.99392159965808, 49.11929140424733], [-122.99390837463962, 49.119299068920824], [-122.99389416082809, 49.11930770217041], [-122.99387835718647, 49.11931707620126], [-122.99386672193421, 49.11932437260017], [-122.99384912825329, 49.11933508351586], [-122.99383928296835, 49.11934147538759], [-122.99382074801478, 49.11935309086842], [-122.99381184391954, 49.119359093390194], [-122.99379329251569, 49.11937109826368], [-122.9937844047728, 49.11937733967168], [-122.99376685673707, 49.119389105707384], [-122.99375696550776, 49.119396367929944], [-122.99374155794976, 49.11940711320663], [-122.99372952609669, 49.11941638793656], [-122.99371753959224, 49.11942512076996], [-122.99370208650136, 49.119437688958676], [-122.99369497591447, 49.1194431284077], [-122.99367464666807, 49.11946067632251], [-122.99367407765477, 49.11946113613222], [-122.99365478782431, 49.11947914394131], [-122.99364720631787, 49.11948751221919], [-122.99363773089891, 49.1194971518702], [-122.99362326019002, 49.11951515993938], [-122.99361976508041, 49.11952103445426], [-122.99361180715968, 49.11953316817372], [-122.99360429434468, 49.11955117662519], [-122.99360197050626, 49.1195691853638], [-122.99360709066596, 49.11958719451471], [-122.99361975477959, 49.119601339324575], [-122.99362426324177, 49.11960520433156], [-122.99364718985848, 49.11961638317762], [-122.99366813130422, 49.11962321561297], [-122.99367462580244, 49.11962475536496], [-122.99370206221045, 49.11962953534119], [-122.99372949884415, 49.11963256678675], [-122.9937569356438, 49.11963430283908], [-122.99378437256856, 49.119635052907235], [-122.99381180958996, 49.1196350328425], [-122.99383924668784, 49.119634395361324], [-122.9938666838477, 49.11963324919803], [-122.9938941210593, 49.11963167155115], [-122.99392155831528, 49.11962971639964], [-122.99394899561058, 49.11962742020824], [-122.99397643294186, 49.11962480595636], [-122.99399112914354, 49.119623232875476], [-122.99400387029442, 49.11962199132042], [-122.99403130765614, 49.11961907452062], [-122.99405874503898, 49.11961595395981], [-122.99408618244298, 49.11961262643044], [-122.99411361986861, 49.11960908495081], [-122.99414105731664, 49.11960532032902], [-122.99414167688701, 49.119605231745524], [-122.99416849472935, 49.11960182152869], [-122.99419593215333, 49.11959819312594], [-122.99422336959064, 49.11959441548236], [-122.99425080704168, 49.1195904829095], [-122.99427280113656, 49.119587229457316], [-122.99427824449171, 49.11958652130574], [-122.99430568189207, 49.11958295545253], [-122.99433311929616, 49.119579322423135], [-122.99436055670238, 49.119575635263935], [-122.99438799410781, 49.119571918959416], [-122.99440816811443, 49.1195692272257], [-122.99441543148902, 49.11956838194361], [-122.99444286881058, 49.11956534372337], [-122.99447030611968, 49.11956238753854], [-122.99449774341262, 49.11955954791505], [-122.99452518068593, 49.11955685830358], [-122.99455261793726, 49.11955434227039], [-122.9945800551665, 49.11955200334622], [-122.99458991976546, 49.119551227018206], [-122.99460749235489, 49.11955001748691], [-122.99463492952353, 49.11954819450024], [-122.99466236669274, 49.11954634744647], [-122.99468980387176, 49.11954438913635], [-122.99471724107084, 49.1195422218717], [-122.99474467830038, 49.119539743799294], [-122.99477211557061, 49.11953685225523], [-122.9947995528918, 49.119533442919966], [-122.9948010059907, 49.119533227849196], [-122.99482699022566, 49.119529875686034], [-122.99485442761788, 49.119525706175835], [-122.99488186508128, 49.11952080037047], [-122.99490832281437, 49.119515223764466], [-122.99490930262624, 49.119515044373], [-122.99493674017664, 49.11950917306442], [-122.99496417782684, 49.11950225164014], [-122.99498112239587, 49.119497218084575], [-122.99499161555288, 49.11949450141887], [-122.99501905332954, 49.1194861599932], [-122.99503816378859, 49.11947921168256], [-122.99504649122284, 49.11947655508547], [-122.99507392918323, 49.1194661656638], [-122.99508487522444, 49.119461204813], [-122.99510136725513, 49.11945452773948], [-122.99512412391091, 49.11944319760955], [-122.99512880549015, 49.11944109316184], [-122.9951562438742, 49.11942597592479], [-122.99515746653574, 49.11942519014514], [-122.9951836823986, 49.119409236924895], [-122.99518671393365, 49.119407182500375], [-122.9952111209854, 49.119391657824416], [-122.99521520111766, 49.11938917481664], [-122.99523855929543, 49.119376767646884], [-122.99525323928849, 49.119371167518906], [-122.99526599706589, 49.119367373972786], [-122.99529343412011, 49.119365440458665], [-122.99532087048594, 49.11937080196899], [-122.9953214127612, 49.119371170301676], [-122.99534830587044, 49.11938671987253], [-122.99535134520448, 49.11938918037867], [-122.9953757408711, 49.119406955530714], [-122.99537607027773, 49.119407190239414], [-122.99539950724166, 49.1194252000435], [-122.99540317582748, 49.11942791190679], [-122.99542591625362, 49.11944320996055], [-122.99543061102105, 49.11944653780584], [-122.995455977931, 49.11946122001532], [-122.9954580464731, 49.11946255781491], [-122.99548548210984, 49.119476738197214], [-122.99549191458905, 49.11947923029175], [-122.99551291793617, 49.119488989926495], [-122.99553670722423, 49.11949724089965], [-122.99554035399827, 49.11949876303007], [-122.9955677901517, 49.11950763188154], [-122.99559522650131, 49.11951439628316], [-122.99559973479208, 49.119515252186524], [-122.99562266291375, 49.11952053132907], [-122.99565009944664, 49.119525366241234], [-122.99567753608274, 49.119529075094235], [-122.99570497280052, 49.119531885117084], [-122.99572354699639, 49.11953326570645], [-122.99573240957656, 49.11953405266712], [-122.99575984640136, 49.11953567626253], [-122.99578728328335, 49.11953664538041], [-122.99581472021482, 49.11953703927921], [-122.99584215719001, 49.11953691550401], [-122.99586959420459, 49.119536315742074], [-122.99589703125531, 49.11953526971876], [-122.99592446833975, 49.11953379789259], [-122.99593236138463, 49.11953327325221], [-122.99595190544633, 49.11953203413455], [-122.99597934257827, 49.11952993289418], [-122.99600677973902, 49.11952744370162], [-122.99603421692838, 49.1195245613312], [-122.99606165414635, 49.11952127750152], [-122.9960890913931, 49.11951758123801], [-122.9961048218905, 49.11951527033205], [-122.99611652866034, 49.119513570453286], [-122.9961439659459, 49.119509266408805], [-122.99617140326234, 49.1195044994669], [-122.99619884061053, 49.1194992479136], [-122.99620863207926, 49.119497264920234], [-122.99622627797915, 49.11949365099683], [-122.99625371537589, 49.11948759895461], [-122.99628115280902, 49.11948097057939], [-122.99628793567673, 49.11947925862968], [-122.99630859026834, 49.119473890603246], [-122.996336027765, 49.11946619810862], [-122.99635258897494, 49.11946125182268], [-122.99636346530058, 49.11945785693587], [-122.99639090287687, 49.1194488280641], [-122.99640686311842, 49.119443244656885], [-122.99641834050175, 49.11943898589772], [-122.99644577817978, 49.11942824811317], [-122.99645316586988, 49.11942523722089], [-122.99647321592191, 49.119416438863404], [-122.99649308905295, 49.119407229572666], [-122.9965006537372, 49.11940340480409], [-122.99652753502546, 49.119389221745976], [-122.99652809164098, 49.119388896761585], [-122.99655552966331, 49.11937244582933], [-122.99655752704565, 49.11937121377625], [-122.99658296783633, 49.1193535370216], [-122.9965834352164, 49.119353205677875], [-122.99660589182216, 49.11933519747221], [-122.99661040623684, 49.119330983813505], [-122.99662512929588, 49.119317189168086], [-122.99663784498078, 49.1193029820058], [-122.99664126147249, 49.11929918077038], [-122.99665491238858, 49.11928117229853], [-122.99666528442769, 49.11926403352966], [-122.99666582038878, 49.119263163745806], [-122.99667474572675, 49.11924515513491], [-122.99668136639727, 49.11922714645704], [-122.996685892475, 49.119209137718634], [-122.99668848928016, 49.11919112892467], [-122.99668928335228, 49.119173120078926], [-122.9966883671342, 49.11915511118406], [-122.99668580261557, 49.11913710224183], [-122.99668162413107, 49.1191190932531], [-122.99667584046736, 49.119101084217974], [-122.99666843640448, 49.11908307513575], [-122.99666529698142, 49.11907678093742], [-122.99665974206896, 49.119065066015665], [-122.99664963264715, 49.11904705685382], [-122.99663786349392, 49.11902909188144], [-122.99663783574849, 49.11902904764188], [-122.9966251056514, 49.11901103840143], [-122.99661057798883, 49.11899302910675], [-122.9966104292782, 49.118992860901265], [-122.99659515261654, 49.11897501978374], [-122.99658299471359, 49.11896229051371], [-122.99657809330795, 49.11895701041015], [-122.99655978160955, 49.11893900099669], [-122.99655555994418, 49.11893516451135], [-122.99654027994809, 49.11892099154463], [-122.99652812502465, 49.11891061833083], [-122.99651932387782, 49.11890298204536], [-122.99650068999647, 49.11888800116622], [-122.99649696935464, 49.118884972499835], [-122.99647325488128, 49.11886696290837], [-122.99647325488128, 49.11886696290837], [-122.99644836599921, 49.118848953275865], [-122.99644581969746, 49.11884721006965], [-122.99642204567175, 49.11883094359357], [-122.99641838445613, 49.11882855871403], [-122.99639427516925, 49.11881293385994], [-122.99639094916559, 49.11881086904627], [-122.99636501491798, 49.118794924072695], [-122.99636351383202, 49.11879403461802], [-122.99633607846299, 49.118777934015625], [-122.99633432086567, 49.118776914232456], [-122.99630864306461, 49.11876246807397], [-122.99630218037139, 49.11875890433768], [-122.99628120763697, 49.11874762192743], [-122.99626838715382, 49.11874089438049], [-122.99625377218108, 49.11873336815474], [-122.99623280265065, 49.11872288435491], [-122.99622633669695, 49.11871969389738], [-122.99619890119173, 49.118706492996736], [-122.99619547094906, 49.11870487426075], [-122.99617146567566, 49.11869362233859], [-122.99615645334036, 49.11868686409836], [-122.99614403013275, 49.118681280890364], [-122.99611659456373, 49.118669448411524], [-122.99611519425183, 49.11866885384731], [-122.99608915899698, 49.11865775287708], [-122.99607210418176, 49.118650843519184], [-122.99606172339983, 49.11864660437725], [-122.9960342877874, 49.1186358019613], [-122.99602649629195, 49.11863283308829], [-122.99600685216636, 49.118625254994384], [-122.99597941651018, 49.118615286569565], [-122.99597811602173, 49.118614822542796], [-122.99595198086236, 49.118605351031256], [-122.99592665314472, 49.118596811868244], [-122.99592454517025, 49.11859608935615], [-122.99589710948412, 49.1185868791368], [-122.99587106059518, 49.11857880102307], [-122.99586967375055, 49.11857836304942], [-122.995842238023, 49.11856988696258], [-122.99581480224703, 49.11856209725041], [-122.99581004320827, 49.11856078995434], [-122.99578736646984, 49.118554423788325], [-122.99575993065787, 49.11854725758886], [-122.99574169243402, 49.118542778583034], [-122.99573249482228, 49.11854045877323], [-122.99570505898491, 49.11853376718728], [-122.99567762311564, 49.11852752803826], [-122.99566513071414, 49.11852476686322], [-122.99565018724901, 49.11852133709363], [-122.99562275138877, 49.11851515128658], [-122.9955953155171, 49.118509171838404], [-122.99558441582671, 49.1185067549338], [-122.9955678796783, 49.11850289708372], [-122.99554044387219, 49.11849633518992], [-122.99551300808108, 49.11848968732404], [-122.99550942216672, 49.118488743170566], [-122.99548557238363, 49.118482088146266], [-122.9954581367333, 49.11847406466396], [-122.99544768796305, 49.118470731882155], [-122.99543070118798, 49.11846499420936], [-122.99540326573549, 49.11845502783537], [-122.99539754422072, 49.1184527210233], [-122.99537583043917, 49.11844349960959], [-122.9953566583499, 49.11843471051532], [-122.99534839527172, 49.118430729430976], [-122.9953218044402, 49.11841670023738], [-122.99532096028068, 49.1184162334596], [-122.99529352553353, 49.11839932905213], [-122.99529259518768, 49.11839869017915], [-122.99526739838724, 49.11838068027802], [-122.99526609106321, 49.11837971157143], [-122.99524560951564, 49.11836267051172], [-122.99523865693111, 49.11835678689854], [-122.99522578871378, 49.11834466082267], [-122.99521122310291, 49.11833096802761], [-122.99520702531328, 49.11832665117404], [-122.99518964671304, 49.11830864158002], [-122.99518378955084, 49.11830259145094], [-122.99517292616879, 49.11829063201085], [-122.9951563561408, 49.11827307775374], [-122.99515594251187, 49.118272622428165], [-122.99513983699947, 49.118254612879866], [-122.99512892282685, 49.1182429149738], [-122.99512313171093, 49.11823660330395], [-122.9951063256733, 49.1182185937213], [-122.995101489476, 49.11821346501546], [-122.99508937628339, 49.11820058413004], [-122.99507405607261, 49.11818487340062], [-122.99507179563787, 49.1181825745093], [-122.99505418316959, 49.11816456488445], [-122.99504662263115, 49.11815698078653], [-122.99503608733269, 49.11814655523608], [-122.99501918910805, 49.1181302109498], [-122.99501743118233, 49.11812854556063], [-122.99499862299733, 49.11811053587552], [-122.99499175555525, 49.11810402921111], [-122.99497931754956, 49.11809252616569], [-122.99496432193324, 49.118078816483674], [-122.9949594727178, 49.118074516429004], [-122.9949392077145, 49.118056506670435], [-122.99493688825537, 49.11805442555797], [-122.99491853492748, 49.118038496890314], [-122.99490945454323, 49.11803063275345], [-122.99489727270908, 49.11802048708039], [-122.9948820207643, 49.11800774400431], [-122.99487542837224, 49.118002477240644], [-122.9948545869242, 49.11798569038814], [-122.99485299009628, 49.117984467370235], [-122.99482992404738, 49.11796645746732], [-122.99482715304336, 49.117964262643056], [-122.99480611813689, 49.11794844752642], [-122.99479971910985, 49.117943564807796], [-122.994781498539, 49.1179304375438], [-122.9947722851145, 49.11792367294415], [-122.99475597764933, 49.11791242751493], [-122.99474485105685, 49.117904577818045], [-122.99472943563893, 49.11789441743376], [-122.99471741693529, 49.11788628327881], [-122.99470171352372, 49.11787640729227], [-122.99468998274672, 49.11786880534011], [-122.99467260349805, 49.11785839708004], [-122.99466254848686, 49.11785217160356], [-122.99464183545872, 49.11784038678348], [-122.99463511415007, 49.117836420973134], [-122.994609058083, 49.11782237638485], [-122.9946076797295, 49.117821603623405], [-122.99458024523639, 49.117807602237406], [-122.99457317536373, 49.117804365830935], [-122.9945528106501, 49.11779459257192], [-122.9945335108774, 49.11778635508681], [-122.99452537595458, 49.117782705857245], [-122.99449794115519, 49.11777187666679], [-122.99448757032553, 49.11776834402952], [-122.99447050624059, 49.11776219155176], [-122.99444307119063, 49.11775381371027], [-122.99442908713758, 49.11775033234934], [-122.99441563600075, 49.11774676430958]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.7500269310961489, "Contour_Level": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99490940459684, 49.11851868256043], [-122.99488196867517, 49.118514003102206], [-122.99485453252649, 49.11851156845072], [-122.99482709612398, 49.11851160021629], [-122.99479965941416, 49.118514571389724], [-122.99477222230594, 49.11852130167004], [-122.9947634674367, 49.11852472948781], [-122.99474478468346, 49.1185328294116], [-122.99472916376158, 49.1185427367974], [-122.99471734627558, 49.11855163307186], [-122.9947079522617, 49.11856074469758], [-122.99469320156764, 49.11857875289096], [-122.99468990641819, 49.118583820375136], [-122.99468259629944, 49.118596761273395], [-122.99467495595603, 49.1186147697916], [-122.9946696835815, 49.11863277841859], [-122.99466636990535, 49.118650787135785], [-122.99466470113084, 49.11866879592886], [-122.99466444136968, 49.11868680478697], [-122.9946654208362, 49.11870481370229], [-122.99466752832193, 49.11872282266965], [-122.9946707060508, 49.118740831686324], [-122.99467494523377, 49.11875884075182], [-122.99468028152832, 49.11877684986766], [-122.9946867891597, 49.1187948590371], [-122.9946898831207, 49.11880205616171], [-122.99469364077285, 49.11881286822194], [-122.99470078186329, 49.1188308774196], [-122.99470884506223, 49.11884888665902], [-122.99471731291872, 49.118865720992424], [-122.9947177814232, 49.11886689593778], [-122.99472540558635, 49.11888490515585], [-122.99473374778405, 49.11890291440609], [-122.99474303778591, 49.11892092369886], [-122.99474474334369, 49.118924116448454], [-122.99475092502519, 49.11893893292705], [-122.99475898989176, 49.11895694216271], [-122.99476720051163, 49.11897495140437], [-122.99477217305224, 49.118989941100764], [-122.99477296954088, 49.11899296053483], [-122.99477249777108, 49.11901096938258], [-122.99477217076668, 49.11901168741802], [-122.9947614040464, 49.11902897774878], [-122.99474473055828, 49.11904513038478], [-122.9947425302236, 49.11904698575986], [-122.99471847626438, 49.11906499353091], [-122.99471729165911, 49.11906589855269], [-122.99469329002291, 49.11908300124487], [-122.9946898528374, 49.11908572671087], [-122.99466898302467, 49.11910100899387], [-122.99466241388214, 49.119106595216046], [-122.99464635332791, 49.119119016815496], [-122.99463497467667, 49.11912957008851], [-122.99462600394894, 49.1191370247388], [-122.99460840449478, 49.11915503278691], [-122.99460753505032, 49.11915619353243], [-122.99459282500916, 49.11917304092689], [-122.99458152712137, 49.119191049265744], [-122.99458009405794, 49.119195083823925], [-122.99457409414254, 49.119209057785135], [-122.9945727076131, 49.11922706658838], [-122.99458008861063, 49.119245075803505], [-122.99458008861063, 49.119245075803505], [-122.9946027148999, 49.119263085731774], [-122.9946075232262, 49.11926526052876], [-122.99463495906289, 49.11927432985854], [-122.99466239531658, 49.11927960656858], [-122.99467561898408, 49.11928109798519], [-122.99468983182835, 49.119282520358404], [-122.99471726850238, 49.119283936768156], [-122.99474470529825, 49.11928421459607], [-122.99477214218977, 49.11928358524452], [-122.99479957916013, 49.11928219533308], [-122.99481404974419, 49.11928110428622], [-122.99482701617755, 49.119280338027515], [-122.99485445320983, 49.11927831738869], [-122.99488189027089, 49.11927599541258], [-122.99490932735435, 49.11927342934469], [-122.99493676445114, 49.11927070468048], [-122.99496420154584, 49.119267970798376], [-122.99499163861549, 49.11926545599248], [-122.99501907563688, 49.119263395338635], [-122.9950242495334, 49.119263104668434], [-122.99504651257503, 49.11926214771509], [-122.99507394950483, 49.11926097034961], [-122.99510138649882, 49.119259128207524], [-122.99512882364823, 49.119255678074914], [-122.99515626107559, 49.11924933453529], [-122.9951706212432, 49.119245102015604], [-122.99518369859415, 49.11924197711581], [-122.99521113584991, 49.11923726485098], [-122.99523857302624, 49.1192333280512], [-122.99526600915861, 49.11924031465593], [-122.99527303932412, 49.1192451062543], [-122.99529344438926, 49.11925691257626], [-122.9953021069636, 49.11926311630906], [-122.9953208793134, 49.11927696336724], [-122.99532883608005, 49.11928112626184], [-122.9953483145754, 49.11929363780552], [-122.99536315151707, 49.11929913651331], [-122.9953757503291, 49.11930522112697], [-122.99540318653526, 49.11931204678441], [-122.99543062312853, 49.11931474066469], [-122.99545806002028, 49.119314198230924], [-122.99548549716538, 49.119310858010664], [-122.99551293453773, 49.11930495743292], [-122.99553285852178, 49.11929914320439], [-122.9955403721061, 49.11929679789314], [-122.99556780983694, 49.119286714332155], [-122.99558097109681, 49.11928113618775], [-122.99559524774918, 49.11927445647114], [-122.99561711938706, 49.11926312869745], [-122.99562268585356, 49.11925986162669], [-122.99564651755061, 49.11924512094142], [-122.9956501241818, 49.11924252290671], [-122.99567113866851, 49.11922711299883], [-122.99567756281438, 49.119221461747706], [-122.99569173427618, 49.1192091049008], [-122.9957050019113, 49.119194753884884], [-122.99570848804963, 49.119191096656294], [-122.99572264504305, 49.11917308831313], [-122.99573244196385, 49.119156564234814], [-122.9957333816206, 49.11915507984181], [-122.99574225849993, 49.11913707130086], [-122.99574835783727, 49.11911906265695], [-122.99575201629226, 49.11910105392284], [-122.99575345173348, 49.11908304510685], [-122.99575277728478, 49.11906503621317], [-122.99575000794097, 49.11904702724233], [-122.99574506063468, 49.11902901819112], [-122.99573774807779, 49.11901100905235], [-122.9957324552882, 49.11900126047332], [-122.99572842177601, 49.118992999838575], [-122.99571712916023, 49.11897499055106], [-122.99570502219515, 49.118959843396304], [-122.99570290443388, 49.11895698115329], [-122.99568683024151, 49.11893897168462], [-122.99567758810572, 49.11893041783736], [-122.9956677665377, 49.11892096210154], [-122.99565015354207, 49.1189067860839], [-122.99564546118948, 49.118902952393015], [-122.99562271866613, 49.118886999390995], [-122.99561974160092, 49.118884942550665], [-122.99559528356662, 49.11886998385554], [-122.99559004132037, 49.118866932550524], [-122.99556784830176, 49.11885503466528], [-122.99555560937577, 49.11884892236065], [-122.99554041292114, 49.11884156068977], [-122.99551719813712, 49.11883091200598], [-122.99551297747857, 49.11882893806905], [-122.99548554209763, 49.11881578993064], [-122.9954798184061, 49.11881290167889], [-122.9954581068577, 49.11880125631669], [-122.9954473539755, 49.11879489153358], [-122.9954306718337, 49.11878454634283], [-122.99541965616235, 49.11877688156827], [-122.99540323702242, 49.11876573427822], [-122.99539369097198, 49.118758871665406], [-122.99537580222659, 49.11874697913083], [-122.99536652262267, 49.11874086170836], [-122.99534836732222, 49.118729605883125], [-122.9953370076949, 49.11872285165013], [-122.99532093231622, 49.1187135167123], [-122.9953050278103, 49.11870484148407], [-122.99529349722843, 49.1186984798606], [-122.99527071547276, 49.11868683121358], [-122.99526606206979, 49.118684361434795], [-122.995238626873, 49.118670804073865], [-122.99523413373656, 49.118668820839176], [-122.99521119162883, 49.118657894491186], [-122.99519425793872, 49.11865081031605], [-122.9951837563048, 49.11864595655242], [-122.99515632106386, 49.11863330086567], [-122.99515538248329, 49.11863279982107], [-122.99512888614007, 49.118617548966036], [-122.9951243309341, 49.11861478964364], [-122.9951014513854, 49.118600256317734], [-122.99509539801647, 49.11859677954781], [-122.99507401656987, 49.118583770500294], [-122.99506438338199, 49.11857876935569], [-122.99504658161682, 49.118568848373066], [-122.9950292916045, 49.11856075897974], [-122.9950191465117, 49.11855560939106], [-122.99499171125386, 49.11854403227373], [-122.99498797176238, 49.118542748322845], [-122.99496427588271, 49.11853370047747], [-122.99493684030661, 49.11852549421969], [-122.99493343349634, 49.118524737071766], [-122.99490940459684, 49.11851868256043]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.5000723189935593, "Contour_Level": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.99512886710929, 49.118811882316045], [-122.99510143137802, 49.11880341774998], [-122.99507399531227, 49.11879842536004], [-122.99504655895655, 49.11879639986139], [-122.9950191222858, 49.118797542739614], [-122.9949916851956, 49.118802838778365], [-122.99496732344913, 49.11881288047635], [-122.99496424747376, 49.11881431647247], [-122.99494156938583, 49.11883088822051], [-122.99493680874072, 49.118835603995606], [-122.99492623455124, 49.11884889641723], [-122.99491682450977, 49.11886690487285], [-122.99491141013127, 49.11888491350384], [-122.99490936598262, 49.11889599127984], [-122.99490799577067, 49.11890292222273], [-122.9949057985349, 49.11892093099519], [-122.99490563394075, 49.118938939857244], [-122.99490825403693, 49.118956948842104], [-122.99490935940966, 49.11896021651196], [-122.99491279788887, 49.11897495791162], [-122.99491948305999, 49.11899296707515], [-122.99492873900061, 49.11901097635118], [-122.9949367893304, 49.11902629215223], [-122.99493793094905, 49.119028985623615], [-122.99493894951749, 49.11904699453726], [-122.99493678667902, 49.11905233942927], [-122.99492961645703, 49.119065002996685], [-122.99492000057622, 49.119083011442854], [-122.99491556215462, 49.11910102011629], [-122.99491933141677, 49.11911902915099], [-122.99493677820968, 49.11913554196311], [-122.99493903458074, 49.11913703888508], [-122.99496421383868, 49.119146549217874], [-122.99499165009395, 49.119151457125895], [-122.99501908668765, 49.119153039540606], [-122.99504652349415, 49.11915250255859], [-122.99507396046695, 49.11915028038369], [-122.99510139763653, 49.11914603503964], [-122.9951288351668, 49.119138058968225], [-122.9951312411139, 49.11913704715059], [-122.99515627346575, 49.11912209868029], [-122.99515821238934, 49.11911903941612], [-122.99516069361796, 49.11910103065139], [-122.99515627629849, 49.119093008979846], [-122.99515375887913, 49.119083021491704], [-122.99514621179736, 49.11906501230579], [-122.99512884389674, 49.119048915053696], [-122.9951268895845, 49.11904700262292], [-122.99512820201795, 49.11902899380931], [-122.99512884586254, 49.11902884135395], [-122.99515628281847, 49.11902605431438], [-122.99518300534561, 49.11901098723981], [-122.99518372099607, 49.119010618257846], [-122.99518639979807, 49.11901098738139], [-122.99519631440292, 49.11902899666337], [-122.99519817302871, 49.11904700560968], [-122.995202199749, 49.11906501464602], [-122.99521032432587, 49.119083023852234], [-122.99521115056642, 49.11908440779025], [-122.99521793308047, 49.11910103303645], [-122.99522551603546, 49.119119042219054], [-122.9952367873556, 49.11913705155332], [-122.99523858204019, 49.11913916271155], [-122.99525779781276, 49.119155061286875], [-122.9952660166563, 49.11916153534646], [-122.99529341175476, 49.11917307161281], [-122.99529345232018, 49.11917309515399], [-122.99529832152804, 49.11917307181287], [-122.99532088909966, 49.11917293177014], [-122.99534832700681, 49.11916070803345], [-122.99535634293801, 49.11915506529253], [-122.9953744590856, 49.119137057151114], [-122.9953757661331, 49.119135225242665], [-122.99538790319131, 49.11911904882026], [-122.99539682887627, 49.11910104030772], [-122.99540229397762, 49.11908303165667], [-122.99540320823921, 49.11907719437264], [-122.99540558515626, 49.11906502291882], [-122.99540600586327, 49.11904701406664], [-122.9954032126926, 49.11902900508646], [-122.9954032126926, 49.11902900508646], [-122.99539816954635, 49.11901099601651], [-122.99538919844257, 49.11899298678949], [-122.99537578089164, 49.11897647342353], [-122.99537460412637, 49.11897497733658], [-122.99535662607043, 49.11895696774571], [-122.99534834682433, 49.11894879580674], [-122.99534088387574, 49.11893895824223], [-122.99532412189, 49.118920948695255], [-122.99532091309209, 49.118917881086276], [-122.99530993141069, 49.11890293925028], [-122.99529381795034, 49.118884929725155], [-122.99529347961976, 49.1188845795106], [-122.99527703998035, 49.118866920170525], [-122.99526604554833, 49.11885795901515], [-122.99525137780057, 49.11884891024833], [-122.99523861052873, 49.11884155064511], [-122.99521117484407, 49.118832238116305], [-122.99520386217444, 49.118830899414604], [-122.99518373885147, 49.11882621205855], [-122.99515630280455, 49.11882081215401], [-122.99513158598559, 49.11881288751982], [-122.99512886710929, 49.118811882316045]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"name": "BB2", "Zm": 2.85, "lat": 49.119038, "lon": -122.99517, "canopy_height": 0.65}, "geometry": {"type": "Point", "coordinates": [-122.99517, 49.119038]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"name": "BB2", "Zm": 2.85, "lat": 49.119038, "lon": -122.99517, "canopy_height": 0.65}, "geometry": {"type": "Point", "coordinates": [-122.99517, 49.119038]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>