<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-122.984902, 49.129344], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.8999991793054138, "info": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.9846137708814, 49.12868295655447], [-122.98458630299261, 49.12867773246033], [-122.98455883456782, 49.128674252945366], [-122.98453136556523, 49.12867264306429], [-122.9845038959331, 49.12867305906679], [-122.98447642561231, 49.128675679423765], [-122.9844489545433, 49.128680682913895], [-122.98442930786395, 49.12868595600177], [-122.98442148272511, 49.12868806004376], [-122.98439401024473, 49.12869752108305], [-122.98437855677604, 49.12870397603008], [-122.98436653710624, 49.1287090420345], [-122.98433955864107, 49.128721997630755], [-122.9843390634276, 49.12872223761531], [-122.98431158944605, 49.128736346946475], [-122.98430476087525, 49.12874001978926], [-122.98428411521367, 49.12875120069494], [-122.98427177269441, 49.12875804218377], [-122.98425664081721, 49.12876652064092], [-122.98423983506098, 49.128776064712184], [-122.98422916627476, 49.12878224760295], [-122.98420905324137, 49.128794087389785], [-122.9842016915222, 49.12879858111316], [-122.9841800825976, 49.12881211030731], [-122.98417421640397, 49.12881600690555], [-122.98415372076965, 49.128830133575576], [-122.98414674064163, 49.1288353924232], [-122.98413054682969, 49.12884815727601], [-122.98411926374921, 49.128858249366075], [-122.98411080339119, 49.12886618144385], [-122.98409438858252, 49.12888420606688], [-122.98409178476523, 49.12888756478564], [-122.98408080781135, 49.12890223107829], [-122.98407011488727, 49.12892025648654], [-122.98406430059156, 49.128932972259165], [-122.98406190219829, 49.12893828223613], [-122.98405570006103, 49.12895630826274], [-122.98405157668229, 49.12897433457612], [-122.9840493056568, 49.12899236114522], [-122.98404870706094, 49.12901038794529], [-122.98404964264063, 49.129028414957254], [-122.98405200896751, 49.12904644216678], [-122.98405572613439, 49.12906446956274], [-122.98406071722181, 49.12908249713442], [-122.98406424936411, 49.12909281478996], [-122.98406658678616, 49.12910052482705], [-122.98407287099238, 49.12911855257652], [-122.98407953242183, 49.12913658037762], [-122.98408580577897, 49.12915460812478], [-122.98409033832397, 49.12917263563169], [-122.98409101933342, 49.12919066260772], [-122.98408518676696, 49.12920868868605], [-122.98407068016314, 49.12922671356764], [-122.98406420489837, 49.129231557962875], [-122.98404531999232, 49.129244736948074], [-122.9840367294182, 49.12924921571076], [-122.98401005942331, 49.12926275895218], [-122.9840092551291, 49.129263109133134], [-122.98398178158706, 49.1292746358579], [-122.98396721728109, 49.129280779892945], [-122.98395430808078, 49.12928601229125], [-122.98392683461442, 49.129297226321796], [-122.98392290209341, 49.129298800612645], [-122.98389936101766, 49.12930880487081], [-122.98388073312707, 49.129316821614935], [-122.9838718871112, 49.1293212987707], [-122.98384491461198, 49.1293348434905], [-122.98384441274052, 49.12933517886686], [-122.98381700247093, 49.12935286646334], [-122.9838169370933, 49.12935293404983], [-122.9837984077873, 49.12937089073721], [-122.98379084779218, 49.1293889165577], [-122.98379382050051, 49.12940694385652], [-122.98380745669967, 49.12942497265119], [-122.98381691128085, 49.12943224322463], [-122.98383076471409, 49.129443002799064], [-122.98384437510667, 49.129451006197684], [-122.98386150925279, 49.12946103398189], [-122.98387184004268, 49.1294664102761], [-122.98389635838457, 49.129479065729], [-122.98389930539244, 49.12948058920868], [-122.98392677070589, 49.129494928838746], [-122.983930905773, 49.12949709742357], [-122.98395423560844, 49.12951059089895], [-122.98396204808404, 49.12951512863478], [-122.98398169981704, 49.12952846077235], [-122.98398859733169, 49.1295331592007], [-122.98400916303636, 49.129549468107726], [-122.98401136017303, 49.129551189236174], [-122.9840325713638, 49.129569219052534], [-122.98403662561965, 49.129572528824475], [-122.98405631873757, 49.12958724921518], [-122.98406408934122, 49.12959211736789], [-122.98408895019703, 49.1296052805975], [-122.98409155478441, 49.129606392586204], [-122.98411902162745, 49.12961633432499], [-122.98414567756551, 49.12962331528181], [-122.98414648936797, 49.129623495689934], [-122.98417395780501, 49.12962849359797], [-122.98420142673271, 49.12963196463758], [-122.98422889605537, 49.129634202574465], [-122.9842563657004, 49.12963543013633], [-122.9842838356136, 49.129635813614016], [-122.98431130575561, 49.129635473204374], [-122.98433877609952, 49.1296344905347], [-122.98436624662916, 49.129632913805814], [-122.98439371733843, 49.12963075918101], [-122.98442118823223, 49.12962800802383], [-122.9844486593277, 49.12962460234523], [-122.98445681326696, 49.12962335758625], [-122.98447613047719, 49.12962101156259], [-122.98450360172464, 49.129617093735085], [-122.98453107318116, 49.1296124900253], [-122.98455854491641, 49.129606972307876], [-122.98456536641692, 49.129605345267855], [-122.98458601660423, 49.129601587985704], [-122.98461348845511, 49.129595657428105], [-122.98464096074822, 49.12958827404261], [-122.98464393433821, 49.129587328863224], [-122.98466843283173, 49.129581544014044], [-122.98469590539158, 49.12957324220043], [-122.98470633019119, 49.12956931026405], [-122.9847233780485, 49.12956459455858], [-122.98475085115639, 49.12955444519349], [-122.98475758885014, 49.129551290161366], [-122.98477832432113, 49.12954407360323], [-122.98479965440032, 49.12953326882594], [-122.98480579831724, 49.12953094384929], [-122.98483327300607, 49.129515495411674], [-122.98483362707357, 49.129515246412375], [-122.98486074853028, 49.12949724732955], [-122.98486077763678, 49.129497223094425], [-122.98488299052119, 49.12947919912366], [-122.9848882256049, 49.12947383150768], [-122.9849016739076, 49.12946117468707], [-122.98491309072277, 49.129443149298105], [-122.98491570681462, 49.12943669974091], [-122.98491725735002, 49.12944314984249], [-122.9849254619128, 49.12946117779533], [-122.98494316459868, 49.1294767918605], [-122.98494662571699, 49.12947920743783], [-122.98497062840907, 49.12949709312431], [-122.98497098802905, 49.12949723749281], [-122.9849980936595, 49.12951269587933], [-122.9850064433372, 49.129515268983646], [-122.98502556016993, 49.12952417197585], [-122.9850530278673, 49.12953174183627], [-122.98506129608359, 49.129533302974906], [-122.9850804956823, 49.12953894756416], [-122.98510796404668, 49.12954434540711], [-122.98513543290449, 49.12954811283383], [-122.98516290207748, 49.12955083788556], [-122.98517033899341, 49.12955134391299], [-122.98519037132051, 49.12955333785431], [-122.98521784081133, 49.129555013719134], [-122.98524531055588, 49.12955584070843], [-122.98527278052333, 49.12955591825646], [-122.98530025069915, 49.129555291213194], [-122.98532772107869, 49.12955397145701], [-122.9853551916637, 49.12955194913329], [-122.98536141791823, 49.12955136829717], [-122.98538266237587, 49.12954948666568], [-122.9854101332818, 49.12954635456092], [-122.98543760442679, 49.12954239441462], [-122.98546507583387, 49.1295375226762], [-122.98548515611088, 49.12953335703804], [-122.98549254750127, 49.12953174039394], [-122.98552001943177, 49.12952503258438], [-122.98554749174865, 49.12951697001602], [-122.98555266049921, 49.12951533862344], [-122.9855749645222, 49.129507302516345], [-122.98559895851504, 49.12949731752623], [-122.98560243788523, 49.12949556240405], [-122.98562991216416, 49.12948060828585], [-122.98563218564173, 49.12947929478461], [-122.98565598851746, 49.129461270862926], [-122.98565738812427, 49.12945976854213], [-122.98567272897644, 49.12944324606012], [-122.98568285682157, 49.12942522043505], [-122.98568487001823, 49.12941823792503], [-122.98568823494054, 49.12940719422038], [-122.98568932316044, 49.129389167473775], [-122.9856866303039, 49.12937114025842], [-122.9856848850911, 49.12936588305519], [-122.985681218901, 49.12935311270582], [-122.98567359497629, 49.12933508487842], [-122.98566390308447, 49.1293170567937], [-122.98565743227678, 49.12930670081041], [-122.98565322522022, 49.1292990285856], [-122.98564248221221, 49.12928100036834], [-122.98563132965455, 49.12926297209907], [-122.98562997572222, 49.12926068650643], [-122.98562182605475, 49.12924494403404], [-122.98561330882852, 49.12922691609105], [-122.98560609111762, 49.129208888309414], [-122.98560252426573, 49.129197240994856], [-122.98560084423418, 49.12919086077305], [-122.98559768265358, 49.12917283349655], [-122.98559600606127, 49.12915480640516], [-122.9855956088934, 49.12913677947333], [-122.98559619128795, 49.12911875266362], [-122.98559741803473, 49.12910072593425], [-122.98559896294746, 49.129082699244506], [-122.98560053356255, 49.12906467255787], [-122.98560187904162, 49.1290466458431], [-122.98560257188097, 49.12903279613043], [-122.98560281598435, 49.1290286190773], [-122.98560313930219, 49.129010592234934], [-122.98560258352983, 49.128992565282886], [-122.98560258352983, 49.128992565282886], [-122.98560115839375, 49.12897453822236], [-122.98559865082821, 49.12895651102675], [-122.9855949054932, 49.12893848367662], [-122.98558975507424, 49.12892045615096], [-122.98558301465376, 49.12890242842646], [-122.98557514484622, 49.128885721058154], [-122.98557452082765, 49.12888440048247], [-122.98556457705358, 49.128866372356526], [-122.98555231740852, 49.1288483439399], [-122.98554768781794, 49.128842398151335], [-122.98553781284484, 49.128830315240734], [-122.98552037606795, 49.128812286172014], [-122.98552022703146, 49.1288121452012], [-122.98549961713053, 49.1287942566834], [-122.98549276421653, 49.12878895936569], [-122.98547424179333, 49.128776226610334], [-122.98546530001947, 49.12877058940989], [-122.98544236721916, 49.128758195712344], [-122.98543783476781, 49.12875588980696], [-122.98541036869547, 49.1287440425716], [-122.98539916116395, 49.12874016337307], [-122.9853829019105, 49.1287346640452], [-122.98535543449607, 49.12872745795865], [-122.9853279664824, 49.128722309673186], [-122.98532656112384, 49.12872212728571], [-122.98530049803045, 49.128718663152924], [-122.98527302909378, 49.12871666698076], [-122.9852455597132, 49.128716174158434], [-122.98521808992352, 49.12871705935235], [-122.98519061975215, 49.12871922284636], [-122.9851670447665, 49.128722106902885], [-122.98516314923732, 49.128722529331604], [-122.98513567851721, 49.1287265103293], [-122.98510820754193, 49.128731328591016], [-122.98508073636187, 49.128736811745874], [-122.98506523986862, 49.12874012066276], [-122.98505326514474, 49.12874239797635], [-122.98502579403811, 49.12874759682618], [-122.9849983230624, 49.12875234262356], [-122.9849708523784, 49.12875610600623], [-122.98494603802754, 49.128758132065855], [-122.9849433821593, 49.128758320282614], [-122.98491591253232, 49.12875857462993], [-122.9849084025127, 49.128758127152665], [-122.98488844352461, 49.128756790353826], [-122.98486097516185, 49.12875289422901], [-122.98483350731772, 49.128747311897726], [-122.98480603983958, 49.128740551924096], [-122.98480437557585, 49.1287400866249], [-122.98477857286504, 49.128732171289194], [-122.98475110596893, 49.12872356511465], [-122.98474624716965, 49.12872205207635], [-122.98472363927583, 49.12871432906808], [-122.98469617244372, 49.12870557786584], [-122.98469076575137, 49.12870401784948], [-122.98466870557158, 49.128696987818984], [-122.98464123838541, 49.12868944515793], [-122.98462583608007, 49.12868598233817], [-122.9846137708814, 49.12868295655447]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.7500087589781409, "info": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.9849707595098, 49.12906335906397], [-122.98494329112783, 49.129058945768875], [-122.98491582245623, 49.12905550340169], [-122.98488835351458, 49.12905296205974], [-122.98486088429343, 49.129051347939615], [-122.98483341475938, 49.12905076549725], [-122.98480594485028, 49.129051412467284], [-122.98477847446578, 49.12905361016341], [-122.98475100345482, 49.12905784264686], [-122.98472439674522, 49.12906455996631], [-122.98472353161067, 49.12906477184396], [-122.98469605903769, 49.12907404419213], [-122.98467821628691, 49.129082580729786], [-122.98466858513987, 49.12908758008307], [-122.98464846183597, 49.12910060365991], [-122.98464110967576, 49.12910613824867], [-122.98462628601098, 49.12911862759167], [-122.98461363196768, 49.12913188189199], [-122.98460920434093, 49.1291366521983], [-122.98459511787995, 49.12915467720201], [-122.98458615042588, 49.12916990077449], [-122.98458438432795, 49.12917270265165], [-122.98457466028239, 49.129190728235116], [-122.98456661584989, 49.12920875404224], [-122.98455866298511, 49.129226779860986], [-122.98455866298511, 49.129226779860986], [-122.98454635655389, 49.129244805096505], [-122.9845311822031, 49.12926205282963], [-122.98453042698489, 49.129262829845274], [-122.98450843509698, 49.129280853778546], [-122.98450370535751, 49.12928456979312], [-122.9844846443438, 49.129298877465864], [-122.98447622878122, 49.12930614452399], [-122.9844628999701, 49.129316901423614], [-122.98444875051632, 49.12933304206932], [-122.98444690452821, 49.12933492615176], [-122.98443693491855, 49.129352951690045], [-122.98443596951947, 49.12937097844155], [-122.98444457892418, 49.12938900648335], [-122.98444873171161, 49.12939316738141], [-122.98446210131661, 49.12940703572428], [-122.98447619436153, 49.129416391123776], [-122.98448994812925, 49.12942506634985], [-122.98450365943339, 49.12943192602461], [-122.98452971861687, 49.1294430985669], [-122.98453112571131, 49.129443639351564], [-122.98455859267743, 49.12945317829272], [-122.9845860606287, 49.12945957329322], [-122.98459660830336, 49.12946113439137], [-122.98461352927255, 49.12946375299798], [-122.98464099860416, 49.129465721087634], [-122.98466846847364, 49.129465951795126], [-122.98469593820056, 49.129466646580106], [-122.98472340775042, 49.129467920098044], [-122.98475087776596, 49.129467679858756], [-122.98477834838444, 49.1294654691205], [-122.98480178848705, 49.1294611615821], [-122.98480581977589, 49.12946072094179], [-122.9848332914572, 49.12945500511127], [-122.98485942993467, 49.12944314227386], [-122.98486076512458, 49.12944274571488], [-122.9848842364856, 49.129425118642764], [-122.98488824157056, 49.12942129919555], [-122.98490147930262, 49.12940709401744], [-122.98490791336742, 49.12938906797713], [-122.98489840038945, 49.12937103985171], [-122.98488825862971, 49.129365168818], [-122.98488720302866, 49.12935301150496], [-122.98488822887225, 49.12933498475755], [-122.9848882678103, 49.12933496141077], [-122.98491573778928, 49.129334596929], [-122.9849165536638, 49.129334988461345], [-122.98491801891566, 49.129353015534434], [-122.98491811730969, 49.129371042428915], [-122.98491870654914, 49.129389069387436], [-122.98492264145699, 49.129407096782856], [-122.98493432033946, 49.12942512518882], [-122.98494317760937, 49.129433826180026], [-122.98496711140601, 49.12944315634428], [-122.98497064409457, 49.12944519974369], [-122.98499811241317, 49.12945053824664], [-122.98502558231274, 49.12945064666529], [-122.98505305329753, 49.129447145448836], [-122.9850701287896, 49.12944316971127], [-122.98508052509469, 49.12944092394505], [-122.98510799689555, 49.12943466711549], [-122.98513546926958, 49.12942646982501], [-122.98513916974022, 49.12942515173683], [-122.98516294244536, 49.12941555531528], [-122.98517862993359, 49.12940712992759], [-122.98519041748449, 49.12939834415717], [-122.98520231651396, 49.12938910608427], [-122.98521770897861, 49.12937108117445], [-122.98521789559028, 49.12937075367553], [-122.98522960334, 49.12935305581505], [-122.98523627730877, 49.12933502978697], [-122.98523952029275, 49.129317003319876], [-122.9852402594518, 49.12929897653258], [-122.98523884538997, 49.12928094946996], [-122.98523530804741, 49.12926292213576], [-122.98522950514119, 49.12924489451161], [-122.98522121733039, 49.12922686656905], [-122.98521794011167, 49.12922099563485], [-122.9852116481724, 49.129208838461736], [-122.98519974659507, 49.1291908100546], [-122.98519048273744, 49.12917925773535], [-122.98518509333007, 49.12917278129314], [-122.98516729166265, 49.12915475212533], [-122.98516302140892, 49.12915092636055], [-122.98514496923305, 49.12913672237319], [-122.98513555791745, 49.129129934956104], [-122.98512053821015, 49.12911869234493], [-122.98510809411111, 49.129110072241154], [-122.98509316513078, 49.12910066193165], [-122.98508062924648, 49.12909380979769], [-122.98505316282724, 49.12908277881543], [-122.9850526744488, 49.129082629814356], [-122.9850256956893, 49.1290741747652], [-122.98499822779588, 49.12906810626599], [-122.98497724430484, 49.12906459314201], [-122.9849707595098, 49.12906335906397]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.5007764856425283, "info": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.98494324803137, 49.1292012673861], [-122.98491578006762, 49.12919523237685], [-122.98488831086375, 49.12919329993492], [-122.9848608405523, 49.129195012124555], [-122.9848333687381, 49.12920164488046], [-122.98481782786398, 49.12920878734839], [-122.98480589493995, 49.12921474618889], [-122.98478833773525, 49.129226810348925], [-122.98477841861266, 49.12923606183105], [-122.98476993696337, 49.129244834805185], [-122.98475626897196, 49.12926285988341], [-122.98475093858104, 49.12926937961622], [-122.9847393932436, 49.12928088453603], [-122.98472346115314, 49.129294102697166], [-122.98471729817409, 49.12929890849539], [-122.98469747301607, 49.12931693275133], [-122.98469598359316, 49.129319166127495], [-122.98468306850656, 49.12933495772306], [-122.98467922848201, 49.12935298409524], [-122.98468671797174, 49.12937101197045], [-122.98469596514828, 49.12937909362019], [-122.98470794826262, 49.1293890416658], [-122.98472342979554, 49.12939616697495], [-122.9847508977793, 49.12940242241904], [-122.98477836772207, 49.129402301212146], [-122.98480583791074, 49.12940137482367], [-122.98483330798264, 49.12940082789791], [-122.98486077988879, 49.12939425470908], [-122.98486642561268, 49.129389062546664], [-122.9848779951246, 49.129371037180974], [-122.98488085775168, 49.12935301067423], [-122.98488387770246, 49.129334984187985], [-122.98488826860351, 49.12933235145606], [-122.98491573877902, 49.12933133434957], [-122.98492335506351, 49.12933498934967], [-122.98493173095484, 49.12935301732475], [-122.9849354807206, 49.12937104469571], [-122.98494319251532, 49.12938460160723], [-122.98497066260988, 49.12938394405948], [-122.98499813388932, 49.129379356929455], [-122.985025606282, 49.12937105641965], [-122.985025606282, 49.12937105641965], [-122.98505260665374, 49.129353033036644], [-122.98505308181757, 49.12935227013621], [-122.98506571665213, 49.12933500785147], [-122.98507020525214, 49.12931698155023], [-122.98506646230827, 49.12929895418439], [-122.9850533185002, 49.12928092560177], [-122.98505310332524, 49.12928072185061], [-122.9850313233117, 49.1292628958704], [-122.98502563993733, 49.12925930269554], [-122.98500728061968, 49.129244865868934], [-122.984998177708, 49.12923412181702], [-122.9849924705575, 49.12922683706284], [-122.98497071454177, 49.12921213254241], [-122.98496211783618, 49.12920880623148], [-122.98494324803137, 49.1292012673861]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "1", "type": "Feature", "properties": {"index": "BB", "name": "Burns Bog 1", "Zm": 1.8, "lat": 49.129344, "lon": -122.984902, "canopy_height": 0.3, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/burnsbog.html#", "info": "https://ubc-micromet.github.io/Data.html#burns-bog-1"}, "geometry": {"type": "Point", "coordinates": [-122.984902, 49.129344]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "1", "type": "Feature", "properties": {"index": "BB", "name": "Burns Bog 1", "Zm": 1.8, "lat": 49.129344, "lon": -122.984902, "canopy_height": 0.3, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/burnsbog.html#", "info": "https://ubc-micromet.github.io/Data.html#burns-bog-1"}, "geometry": {"type": "Point", "coordinates": [-122.984902, 49.129344]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>