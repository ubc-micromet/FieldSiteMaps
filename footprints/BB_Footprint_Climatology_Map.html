<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-122.984902, 49.129344], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.900006711590886, "info": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.98461379830697, 49.128594324485526], [-122.98458632884572, 49.12859433098774], [-122.98456210888169, 49.1285958394154], [-122.984558858858, 49.12859603286418], [-122.98453138835441, 49.128599386882726], [-122.9845039172494, 49.128604658976265], [-122.98447644550255, 49.1286119682433], [-122.9844707115428, 49.12861385404257], [-122.98444897321149, 49.12862099180913], [-122.98442243955975, 49.1286318744238], [-122.98442150020577, 49.12863226460126], [-122.98439402654773, 49.128645576114096], [-122.9843863620747, 49.12864989643453], [-122.98436655204908, 49.12866151464118], [-122.98435690523432, 49.12866791933112], [-122.98433907659457, 49.12868043199279], [-122.98433193924544, 49.12868594282965], [-122.98431160003877, 49.12870277358228], [-122.9843102521432, 49.12870396676833], [-122.9842908609549, 49.1287219910153], [-122.98428412230345, 49.12872876903139], [-122.98427332374017, 49.128740015511475], [-122.98425749960023, 49.12875804023856], [-122.98425664317752, 49.12875906590545], [-122.98424257832987, 49.128776065086605], [-122.98422917313918, 49.12879409013977], [-122.98422916251394, 49.12879410506025], [-122.98421617673408, 49.128812115247214], [-122.98420443269748, 49.12883014052446], [-122.98420168007496, 49.1288346103716], [-122.98419308288555, 49.12884816585445], [-122.98418250025777, 49.12886619128836], [-122.98417419556114, 49.128881493897545], [-122.98417264686383, 49.12888421682121], [-122.98416269313529, 49.1289022423394], [-122.98415334554596, 49.12892026793988], [-122.98414670933472, 49.128933586381244], [-122.98414420231684, 49.12893829356761], [-122.98413455252934, 49.12895631912494], [-122.98412487429734, 49.1289743446775], [-122.98411922346584, 49.128984379098185], [-122.9841142982881, 49.128992370105685], [-122.98410225252422, 49.129010395330475], [-122.98409174081984, 49.129024922614185], [-122.98408897219296, 49.12902842038382], [-122.98407345059351, 49.129046445126455], [-122.98406426096658, 49.1290566123564], [-122.98405668239566, 49.1290644696948], [-122.9840389084716, 49.12908249412164], [-122.98403678227179, 49.12908458432831], [-122.98401972607597, 49.12910051835073], [-122.98400930432652, 49.1291101296173], [-122.98399976862706, 49.129118542469186], [-122.983981826667, 49.12913470019914], [-122.98397969870516, 49.12913656656855], [-122.98396019412061, 49.129154590742885], [-122.98395434866258, 49.12916025547909], [-122.98394112111205, 49.1291726149739], [-122.9839268705132, 49.12918617175278], [-122.98392200992859, 49.1291906391964], [-122.98390339460808, 49.12920866348482], [-122.98389939209436, 49.12921283172586], [-122.98388561850315, 49.1292266878873], [-122.98387191298546, 49.12924152824124], [-122.9838688557801, 49.12924471242857], [-122.9838523853475, 49.12926273700823], [-122.98384443321773, 49.129272154954315], [-122.98383684141066, 49.12928076171519], [-122.98382213960134, 49.12929878653802], [-122.98381695245922, 49.12930572183089], [-122.98380822933049, 49.129316811469906], [-122.98379548796602, 49.129334836564134], [-122.98378946998749, 49.12934442978585], [-122.98378386018176, 49.12935286181329], [-122.98377337695926, 49.129370887222095], [-122.98376468901067, 49.12938891288234], [-122.98376198326746, 49.12939601558466], [-122.98375748841535, 49.129406938751124], [-122.98375216518357, 49.129424964883604], [-122.98374902861728, 49.129442991323586], [-122.98374817014975, 49.12946101808411], [-122.98374974981355, 49.12947904518774], [-122.98375396917518, 49.12949707266275], [-122.9837610813823, 49.12951510054447], [-122.98376194386634, 49.12951666629011], [-122.98377080504817, 49.12953312879277], [-122.98378429090603, 49.12955115756866], [-122.98378940086027, 49.12955646389959], [-122.98380186122344, 49.12956918691601], [-122.98381686282205, 49.12958113291331], [-122.98382483179071, 49.12958721701729], [-122.98384432687924, 49.12959943675466], [-122.98385423378411, 49.12960524801348], [-122.98387179212426, 49.129614140834505], [-122.98389149299875, 49.12962328009861], [-122.98389925813358, 49.12962653486512], [-122.9839267246924, 49.12963727128429], [-122.98393798697434, 49.129641313456716], [-122.98395419164129, 49.129646835736956], [-122.98398165891147, 49.129655435696165], [-122.98399516632854, 49.12965934827775], [-122.98400912640604, 49.129663367504484], [-122.98403659407671, 49.12967077804423], [-122.98406375280597, 49.12967738464542], [-122.98406406198865, 49.129677461374115], [-122.98409152996118, 49.12968397837121], [-122.98411899819442, 49.129689701626745], [-122.98414646668337, 49.12969464280216], [-122.98415126329311, 49.129695423571484], [-122.98417393526594, 49.129699306897045], [-122.98420140400533, 49.12970349366644], [-122.9842288728937, 49.1297072253485], [-122.98425634191163, 49.129710560933944], [-122.9842834173404, 49.12971346851675], [-122.98428381105366, 49.12971351546072], [-122.98431128019774, 49.12971647391066], [-122.9843387495006, 49.12971893853645], [-122.9843662189728, 49.129720873355], [-122.98439368862556, 49.12972223963472], [-122.98442115846899, 49.129723002229106], [-122.98444862850731, 49.12972314429265], [-122.98447609873823, 49.129722670088455], [-122.98450356915325, 49.1297216034721], [-122.9845310397386, 49.12971998547557], [-122.98455851048558, 49.12971784140328], [-122.98458598140088, 49.12971514667075], [-122.9845995744312, 49.129713511119874], [-122.98461345240969, 49.12971214006914], [-122.98464092350386, 49.12970884647599], [-122.98466839481073, 49.129704851179746], [-122.98469586637674, 49.129699999679595], [-122.98471716258085, 49.129695499863814], [-122.98472333816274, 49.129694414652135], [-122.98475080991197, 49.1296889293945], [-122.98477828189552, 49.12968265894846], [-122.9847987701435, 49.129677483756396], [-122.98480575399421, 49.129675988996496], [-122.98483322596071, 49.12966972832571], [-122.98486069820261, 49.1296625404017], [-122.98487209153792, 49.129659466505856], [-122.98488817030685, 49.129655779206914], [-122.98491564217916, 49.12964975797837], [-122.98494311366713, 49.12964498388155], [-122.98497058443778, 49.12964256558676], [-122.9849980543872, 49.129642860258], [-122.98502552362368, 49.1296455232786], [-122.98505299245905, 49.12964953047331], [-122.98508046116106, 49.12965399685283], [-122.98510792988411, 49.1296584093693], [-122.98511484532655, 49.129659498057144], [-122.98513539839118, 49.12966356075809], [-122.98516286699146, 49.12966841883496], [-122.98519033584415, 49.12967244743405], [-122.9852178049399, 49.1296756734735], [-122.98523763496166, 49.12967754070268], [-122.98524527417136, 49.129678454183264], [-122.98527274343185, 49.129681147231686], [-122.98530021283109, 49.1296833810665], [-122.98532768233801, 49.12968525833613], [-122.98535515193933, 49.12968682208819], [-122.98538262163358, 49.129688075675865], [-122.9854100914255, 49.129689001085445], [-122.98543756132305, 49.12968956928924], [-122.98546503133561, 49.12968974630452], [-122.9854925014725, 49.12968949777532], [-122.98551997174253, 49.12968879114563], [-122.98554744215471, 49.129687592699746], [-122.98557491272012, 49.129685861602404], [-122.98560238345289, 49.129683545945674], [-122.98562985437027, 49.12968058266769], [-122.98565245185931, 49.12967759299503], [-122.98565732547536, 49.12967695719666], [-122.98568479672828, 49.12967280441999], [-122.98571226823381, 49.12966775658516], [-122.9857397400376, 49.12966164923706], [-122.98574794946846, 49.12965957794189], [-122.98576721219014, 49.129654300056615], [-122.985794684828, 49.12964522367169], [-122.98580445743902, 49.129641558022556], [-122.98582215802304, 49.12963415796311], [-122.98584486950708, 49.12962353610334], [-122.98584963178155, 49.129621069453556], [-122.98587710616978, 49.129605712855735], [-122.9858774437401, 49.12960551321147], [-122.98590279943421, 49.12958748942923], [-122.98590458182468, 49.12958582813897], [-122.98592140333615, 49.12956946481828], [-122.98593206030574, 49.12955587687796], [-122.9859355733324, 49.129551439664255], [-122.98594820609031, 49.12953341432135], [-122.98595692768563, 49.12951538850137], [-122.98595954428, 49.12950635478244], [-122.98596228437405, 49.12949736227161], [-122.98596662567606, 49.12947933591813], [-122.98596962314814, 49.12946130940116], [-122.98597120397257, 49.12944328271191], [-122.98597159201158, 49.129425255877685], [-122.98597087362029, 49.129407228908946], [-122.9859690331507, 49.12938920180381], [-122.98596604753583, 49.12937117455941], [-122.9859619162641, 49.129353147175564], [-122.98595958980782, 49.129345122727635], [-122.98595691874343, 49.129335119686175], [-122.98595105308564, 49.12931709209088], [-122.98594393803056, 49.12929906434312], [-122.98593527097259, 49.12928103640583], [-122.98593213961219, 49.12927556958271], [-122.98592533722534, 49.12926300831342], [-122.98591348892869, 49.129244979986545], [-122.98590468163444, 49.12923373959677], [-122.98589956287292, 49.12922695140466], [-122.98588369737861, 49.12920892258393], [-122.98587722070135, 49.12920247733953], [-122.98586583393003, 49.1291908935164], [-122.98584975832735, 49.12917639978561], [-122.9858459101029, 49.12917286419351], [-122.98582452713217, 49.12915483468795], [-122.98582229517935, 49.129153137680746], [-122.98580037646474, 49.12913680483805], [-122.98579483109954, 49.129133227241475], [-122.98577159594868, 49.129118774412554], [-122.98576736617676, 49.12911633862413], [-122.98573990082336, 49.129101016533355], [-122.98573940061466, 49.12910074355813], [-122.98571243518718, 49.129086737604894], [-122.98570425410372, 49.12908271232931], [-122.985684969249, 49.12907356233759], [-122.98566503483312, 49.12906468058412], [-122.98565750304303, 49.129061365975495], [-122.98563003668382, 49.12904974650465], [-122.98562241163772, 49.129046648401754], [-122.98560257024552, 49.12903844439818], [-122.98557744467205, 49.129028615910826], [-122.98557510366818, 49.12902766463468], [-122.98554763721727, 49.12901649096915], [-122.98553265101334, 49.129010583424055], [-122.98552017074971, 49.129005416760755], [-122.98549270425116, 49.12899449080878], [-122.9854876035006, 49.128992550887936], [-122.9854652376629, 49.12898391299839], [-122.98543800879007, 49.12897451776076], [-122.98543777076502, 49.12897443226142], [-122.98541030404321, 49.12896438708265], [-122.9853888374058, 49.12895648466581], [-122.98538283740936, 49.12895408061234], [-122.98535537115934, 49.12894250936593], [-122.98534617854263, 49.1289384523766], [-122.98532790526424, 49.12892977882444], [-122.98530911196146, 49.12892042078327], [-122.9853004397445, 49.12891582598576], [-122.98527616423421, 49.128902389703285], [-122.98527297463323, 49.12890054606498], [-122.98524574438771, 49.12888435893691], [-122.98524550985059, 49.12888421561351], [-122.98521804537474, 49.128866913743536], [-122.98521714839063, 49.12886632839601], [-122.98519058120557, 49.12884864635479], [-122.98519007058154, 49.12884829804271], [-122.98516383868166, 49.12883026779169], [-122.98516311723809, 49.128829770703675], [-122.98513723815178, 49.128812237487224], [-122.98513565320961, 49.12881116883668], [-122.98510996240104, 49.12879420708948], [-122.98510818906163, 49.12879303453645], [-122.98508235622852, 49.12877617664255], [-122.98508072487166, 49.12877510703421], [-122.98505427608136, 49.1287581461276], [-122.98505326060764, 49.12875749168808], [-122.98502579619932, 49.128740420165705], [-122.9850252827304, 49.12874011548733], [-122.98499833163797, 49.1287239184016], [-122.98499509946222, 49.1287220846851], [-122.98497086689257, 49.12870808578064], [-122.98496341406882, 49.12870405367929], [-122.98494340194752, 49.128692970297315], [-122.98492985606534, 49.12868602242033], [-122.98491593677053, 49.12867867439066], [-122.9848937713756, 49.12866799082101], [-122.9848884713151, 49.1286653467249], [-122.98486100562036, 49.12865285337889], [-122.98485384253661, 49.12864995870612], [-122.98483353963945, 49.128641343506246], [-122.9848077169244, 49.12863192576215], [-122.98480607322553, 49.12863129231703], [-122.98477860656867, 49.128622071042514], [-122.98475113942008, 49.12861448638268], [-122.98474851669674, 49.12861389107336], [-122.98472367200384, 49.128607800295136], [-122.98469620416671, 49.12860250569417], [-122.98466873592503, 49.128598542084234], [-122.984641267295, 49.128595849972484], [-122.984641267295, 49.128595849972484], [-122.98461379830697, 49.128594324485526]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.7500902170273458, "info": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.98486088598395, 49.12904579553153], [-122.98483341781538, 49.12904074638128], [-122.98480594888599, 49.129038205381185], [-122.98477847920397, 49.12903813213249], [-122.98475100868716, 49.12904078121805], [-122.98472404071343, 49.12904653303663], [-122.98472353718333, 49.1290466334347], [-122.9846960648766, 49.12905507323528], [-122.98467543818113, 49.12906455347855], [-122.98466859123411, 49.1290678150188], [-122.98464488405833, 49.12908257630168], [-122.98464111615837, 49.12908515127536], [-122.98462173582783, 49.1291006001033], [-122.98461363935961, 49.129107993773374], [-122.98460273058691, 49.1291186244528], [-122.98458690973298, 49.12913664922426], [-122.9845861604493, 49.1291375664919], [-122.98457172257564, 49.129154674078165], [-122.98455867981264, 49.129172593008825], [-122.98455859565911, 49.12917269920558], [-122.98454409856126, 49.129190724148025], [-122.9845311989621, 49.129208182521886], [-122.98453072824427, 49.12920874923958], [-122.98451557382342, 49.12922677409026], [-122.98450371857061, 49.129242172843725], [-122.98450144361658, 49.12924479907639], [-122.98448656591356, 49.12926282396031], [-122.98447623769461, 49.12927759474579], [-122.9844736701166, 49.129280849108774], [-122.98446119943968, 49.12929887431297], [-122.98445133160499, 49.1293168998663], [-122.98444875370713, 49.12932283994429], [-122.98444257107383, 49.129334925567946], [-122.98443616907716, 49.12935295158681], [-122.98443308013681, 49.12937097805202], [-122.98443366306576, 49.12938900501218], [-122.98443853982371, 49.12940703255108], [-122.98444872191969, 49.129424475441915], [-122.98444904075122, 49.12942506084737], [-122.98446489855155, 49.12944308986352], [-122.98447618334521, 49.129451676355906], [-122.9844894094716, 49.12946112004023], [-122.98450364786403, 49.129469048332226], [-122.98452463639582, 49.12947915164846], [-122.98453111382145, 49.129481857743166], [-122.98455858068417, 49.129491797581544], [-122.984578483225, 49.12949718573439], [-122.98458604834583, 49.12949919561271], [-122.9846135164274, 49.12950526309319], [-122.98464098503175, 49.129509659843286], [-122.98466845408375, 49.12951262057178], [-122.98469592353885, 49.12951428215483], [-122.98472339336145, 49.12951475372158], [-122.98475086354544, 49.12951404852172], [-122.98477833411879, 49.12951206888718], [-122.98480580513915, 49.129508619340335], [-122.9848332767412, 49.12950325022169], [-122.98485562355631, 49.1294972224185], [-122.9848607488511, 49.12949619366901], [-122.98488822041335, 49.12949091340758], [-122.98491569101614, 49.129488776599416], [-122.98494316013547, 49.12949153082368], [-122.98497062871044, 49.12949609612152], [-122.98497846842159, 49.12949723846627], [-122.98499809705173, 49.12950145262628], [-122.98502556580148, 49.12950547249514], [-122.98505303510662, 49.12950765951352], [-122.98508050490724, 49.12950820332381], [-122.98510797513838, 49.12950731169391], [-122.98513544580226, 49.12950496924081], [-122.98516291694904, 49.12950099981228], [-122.98518131283626, 49.129497264678626], [-122.98519038855804, 49.12949546374967], [-122.98521786063446, 49.12948833480597], [-122.98524318248532, 49.12947924572153], [-122.98524533354659, 49.12947836307501], [-122.98527280743343, 49.12946506322194], [-122.98527958662531, 49.12946122348732], [-122.98530028304049, 49.12944589492115], [-122.98530369021302, 49.129443199676544], [-122.98532048733684, 49.12942517493196], [-122.98532776297452, 49.12941199118719], [-122.98533061741038, 49.12940714933801], [-122.98533672616655, 49.12938912323248], [-122.98533939440766, 49.12937109668976], [-122.98533897298933, 49.129353069754615], [-122.98533562452543, 49.12933504244772], [-122.98532891612871, 49.12931701471378], [-122.98532779159467, 49.129314999966695], [-122.98532002304675, 49.12929898670161], [-122.9853073365864, 49.12928095820607], [-122.98530033409854, 49.129273187061266], [-122.98529175108857, 49.1292629293398], [-122.98527287215452, 49.12924654732624], [-122.98527099692048, 49.12924489981212], [-122.98524540817405, 49.12922686966294], [-122.98524540817405, 49.12922686966294], [-122.98521794328336, 49.12921032677733], [-122.98521533157555, 49.12920883893345], [-122.98519047793256, 49.12919539019223], [-122.98518133661865, 49.12919080769322], [-122.98516301221976, 49.12918172198819], [-122.98514318650996, 49.129172775908344], [-122.98513554619402, 49.12916915108439], [-122.9851080803325, 49.129156078305314], [-122.98510539929632, 49.1291547441576], [-122.98508061495859, 49.12914142852968], [-122.98507171534882, 49.12913671292507], [-122.98505314975458, 49.12912626737725], [-122.98503904813865, 49.12911868181437], [-122.98502568456361, 49.12911111846364], [-122.98500528679246, 49.129100650552296], [-122.98499821913246, 49.12909682120456], [-122.98497075336836, 49.129083677630604], [-122.9849681858422, 49.129082618845565], [-122.98494328737962, 49.129071323956836], [-122.98492455862875, 49.12906458627488], [-122.9849158207701, 49.12906106154691], [-122.98488835374833, 49.12905219287024], [-122.98486369392286, 49.12904655142918], [-122.98486088598395, 49.12904579553153]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.49983300342549564, "info": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.98488830782172, 49.12920330938082], [-122.98486083866483, 49.12920121137919], [-122.98483336831704, 49.12920302524596], [-122.98480909682316, 49.129208786199975], [-122.98480589655979, 49.12920944515991], [-122.98477842359092, 49.129219799797944], [-122.98476635403186, 49.12922680745049], [-122.98475094855755, 49.1292368488808], [-122.9847409731678, 49.12924483098097], [-122.98472347075327, 49.1292628555485], [-122.98472347075327, 49.1292628555485], [-122.98470791523658, 49.12928088037119], [-122.98469744018908, 49.129298905865184], [-122.98469598869413, 49.12930259294499], [-122.9846885198669, 49.12931693156437], [-122.98468360196225, 49.129334957793816], [-122.9846830987839, 49.129352984608744], [-122.98468844658099, 49.1293710121997], [-122.9846959644956, 49.129381214140494], [-122.98470129448499, 49.12938904078436], [-122.98472342699553, 49.12940528053252], [-122.98472640812679, 49.129407070990766], [-122.98475089308471, 49.12941773011454], [-122.98477836105086, 49.129424093289465], [-122.98478935826354, 49.12942510618246], [-122.98480583009412, 49.12942695466117], [-122.98483330054673, 49.129425205949126], [-122.9848336327585, 49.129425112006714], [-122.98486077209193, 49.129419862415006], [-122.98488437929433, 49.12940709178001], [-122.98488824714887, 49.12940294471649], [-122.98491571674813, 49.129403955603806], [-122.984918255617, 49.12940709621005], [-122.98494318167502, 49.12942039997414], [-122.98497065018542, 49.12942504889917], [-122.98499812013743, 49.12942493665169], [-122.98502559141382, 49.12942042646897], [-122.98505306441442, 49.1294101638449], [-122.98505920921552, 49.12940711453594], [-122.9850805398446, 49.129391766289935], [-122.98508383328411, 49.12938909083822], [-122.98509733022644, 49.129371065699566], [-122.98510191326453, 49.129353039409374], [-122.98510114145051, 49.12933501242812], [-122.98509494793855, 49.129316984747], [-122.9850816579477, 49.1292989561488], [-122.9850805679997, 49.129297932138975], [-122.98506356356958, 49.12928092692758], [-122.98505310553095, 49.129273384269275], [-122.98503799900551, 49.12926289673567], [-122.98502564108887, 49.12925547895784], [-122.98500616922847, 49.129244865724615], [-122.98499817579042, 49.1292404775348], [-122.98497070983463, 49.129227705777794], [-122.98496829568793, 49.129226833918025], [-122.98494324347661, 49.12921630886376], [-122.98491577585018, 49.12920913459818], [-122.98491365865789, 49.12920879990978], [-122.98488830782172, 49.12920330938082]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "1", "type": "Feature", "properties": {"index": "BB", "name": "Burns Bog 1", "Zm": 1.8, "bearing": 166, "lat": 49.129344, "lon": -122.984902, "canopy_height": 0.3, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/burnsbog.html#", "info": "https://ubc-micromet.github.io/Data.html#burns-bog-1"}, "geometry": {"type": "Point", "coordinates": [-122.984902, 49.129344]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "1", "type": "Feature", "properties": {"index": "BB", "name": "Burns Bog 1", "Zm": 1.8, "bearing": 166, "lat": 49.129344, "lon": -122.984902, "canopy_height": 0.3, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/burnsbog.html#", "info": "https://ubc-micromet.github.io/Data.html#burns-bog-1"}, "geometry": {"type": "Point", "coordinates": [-122.984902, 49.129344]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>