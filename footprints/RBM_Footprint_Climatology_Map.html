<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-123.196356, 49.131267], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.8999951389475871, "Contour_Level": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-123.19603724068621, 49.13046567151988], [-123.19600978776587, 49.130463159606094], [-123.19598234042307, 49.130462062004355], [-123.19595489797089, 49.13046220502328], [-123.19592745972425, 49.13046341531829], [-123.19590002498337, 49.13046551574474], [-123.19589135832888, 49.13046639556828], [-123.19587259241995, 49.13046816948337], [-123.19584516151176, 49.13047124418805], [-123.19581773193555, 49.130474657964946], [-123.19579030314843, 49.130478273084655], [-123.19576287470353, 49.13048197613862], [-123.19574296121768, 49.13048465609529], [-123.19573544598687, 49.13048561118852], [-123.19570801641652, 49.13048903036924], [-123.19568058675019, 49.13049242612726], [-123.19565315709653, 49.1304958260487], [-123.1956257276921, 49.130499290270365], [-123.19559829889606, 49.13050291010448], [-123.19559829889606, 49.13050291010448], [-123.19557087050417, 49.13050663370903], [-123.19554344390386, 49.1305108139048], [-123.19551601985305, 49.13051564360728], [-123.19548976793915, 49.130521102762266], [-123.19548859926277, 49.1305213548264], [-123.19546118293056, 49.13052815079288], [-123.19543377305556, 49.13053659144637], [-123.19542651984854, 49.130539218681086], [-123.19540637192246, 49.13054725882855], [-123.195385840031, 49.13055729637633], [-123.19537898336633, 49.13056112981476], [-123.1953575377215, 49.130575353115084], [-123.19535161466202, 49.1305800573308], [-123.19533701071379, 49.130593396692646], [-123.19532428208521, 49.13060818652828], [-123.19532178164602, 49.130611431304146], [-123.19531049890418, 49.130629459238094], [-123.19530223216496, 49.130647482069264], [-123.19529705542773, 49.130663289449934], [-123.19529637017847, 49.13066550083222], [-123.19529235195321, 49.13068351647625], [-123.19528990292301, 49.13070152946595], [-123.19528873070382, 49.13071954029593], [-123.19528858502784, 49.13073754938954], [-123.19528924369149, 49.13075555712263], [-123.19529050039489, 49.13077356384415], [-123.19529215378611, 49.130791569894605], [-123.19529399732436, 49.13080957562338], [-123.19529580990587, 49.13082758140442], [-123.19529734761778, 49.13084558765032], [-123.19529780394026, 49.1308538511088], [-123.19529829662864, 49.1308635948919], [-123.19529842641474, 49.13088160351914], [-123.19529794844581, 49.13089064012603], [-123.19529742761662, 49.13089961405531], [-123.19529484605599, 49.130917627268595], [-123.19529038869165, 49.13093564365454], [-123.19528375683014, 49.13095366371814], [-123.19527474095366, 49.13097168781335], [-123.19527084734561, 49.13097775902295], [-123.19526242054857, 49.13098971749637], [-123.19524705248071, 49.13100775233178], [-123.19524353569804, 49.13101128509871], [-123.19522788650777, 49.13102579358694], [-123.1952161875496, 49.131035524109265], [-123.19520547379811, 49.13104384032808], [-123.19518882391557, 49.13105582531772], [-123.19517990065341, 49.13106189240745], [-123.19516145139885, 49.1310738692447], [-123.1951516497082, 49.131079949007166], [-123.19513407383188, 49.131090631436564], [-123.19512149372991, 49.13109800881933], [-123.19510669358237, 49.13110671472281], [-123.19509033050967, 49.13111607032547], [-123.19507931225101, 49.1311225267979], [-123.19505903253949, 49.13113413205078], [-123.19505193107247, 49.13113838225575], [-123.19502835533868, 49.131152192718986], [-123.19502455117753, 49.13115456939531], [-123.19499890842414, 49.13117025130116], [-123.19499717380786, 49.13117140496378], [-123.19497116966126, 49.13118830699128], [-123.19496980055256, 49.13118929446589], [-123.1949455201694, 49.13120635914714], [-123.1949424336882, 49.131208818969995], [-123.19492228362112, 49.131224407223655], [-123.19491507676703, 49.13123088528488], [-123.1949017618773, 49.13124245071274], [-123.1948877357752, 49.13125702164283], [-123.19488426459314, 49.13126048909319], [-123.19486952679883, 49.131278522813574], [-123.19486043359892, 49.13129306923594], [-123.19485814214516, 49.131296550873074], [-123.1948497272014, 49.13131457391976], [-123.19484481234895, 49.13133259105922], [-123.19484341601066, 49.13135060226086], [-123.19484566014916, 49.13136860731892], [-123.1948517834043, 49.131386605830514], [-123.19486086215393, 49.13140241610752], [-123.19486208803217, 49.131404597284906], [-123.19487643498928, 49.131422581915636], [-123.19488842870076, 49.13143379843984], [-123.19489565837264, 49.13144055831326], [-123.19491595760455, 49.131455569922785], [-123.19492000616377, 49.1314585260567], [-123.19494346826599, 49.131472682673284], [-123.19494993760964, 49.13147648436731], [-123.1949709681695, 49.131487047236114], [-123.19498629411036, 49.13149443181978], [-123.19499846091715, 49.13149958321134], [-123.19502594803798, 49.131510681174134], [-123.19503025276418, 49.131512366419784], [-123.19505343035775, 49.13152055222643], [-123.19508090928616, 49.13152955615489], [-123.19508319760811, 49.13153028582016], [-123.19510838487955, 49.13153770769468], [-123.19513585781277, 49.13154517915219], [-123.19514750341027, 49.131548185994774], [-123.19516332839596, 49.13155204982442], [-123.19519079683066, 49.13155837129441], [-123.1952182631399, 49.13156414966197], [-123.19522783020606, 49.13156605904525], [-123.19524572787775, 49.13156952625814], [-123.19527319100142, 49.131574490348], [-123.19530065235644, 49.131579002782466], [-123.19532811201745, 49.1315830827548], [-123.19533386038013, 49.13158388855802], [-123.19535557080674, 49.13158693972245], [-123.19538302827544, 49.13159045956245], [-123.19541048428523, 49.13159360720795], [-123.19543793889042, 49.13159639664508], [-123.19546539214224, 49.131598841052174], [-123.19549284408859, 49.131600952757424], [-123.19550258237142, 49.131601611837624], [-123.19552029530375, 49.13160287793962], [-123.19554774554402, 49.13160455470262], [-123.1955751945424, 49.131605915284084], [-123.19560264231481, 49.13160696386377], [-123.1956300888692, 49.131607702589626], [-123.19565753420375, 49.13160813113656], [-123.1956849783046, 49.131608246110076], [-123.1957124211426, 49.131608040231534], [-123.19573986266882, 49.131607501210276], [-123.19576730280832, 49.13160661015787], [-123.19579474145122, 49.13160533931823], [-123.19582217843958, 49.131603648753554], [-123.19584961354795, 49.13160148139707], [-123.19585426890416, 49.13160101580945], [-123.19587704835446, 49.131599238026524], [-123.19590448176373, 49.131596640677174], [-123.1959319130453, 49.13159350413871], [-123.19595934165345, 49.13158969017859], [-123.19598676674464, 49.131584985082945], [-123.19599731401019, 49.13158276422963], [-123.19601419110369, 49.13158009559542], [-123.19604161381015, 49.131574788362975], [-123.19606903060127, 49.13156798259977], [-123.19607978248077, 49.131564615362514], [-123.19609644567245, 49.13156074267237], [-123.1961238565642, 49.13155244524754], [-123.19613887274949, 49.13154650615272], [-123.19615126218922, 49.131542815165716], [-123.196178667638, 49.1315331431103], [-123.19619707189503, 49.13152839842688], [-123.19620608529205, 49.13152656658536], [-123.19621567200903, 49.13152836681888], [-123.1962335619524, 49.13153494207107], [-123.19624381120009, 49.131546327839835], [-123.19625926722594, 49.131564310413474], [-123.19626113048372, 49.131566588877234], [-123.1962726194364, 49.131582296561305], [-123.1962887050746, 49.13159976162046], [-123.19628919571808, 49.131600277226475], [-123.19630639098563, 49.13161825683681], [-123.19631625795638, 49.13162742702415], [-123.19632625473761, 49.13163623190712], [-123.19634379379455, 49.13165076883314], [-123.19634821047482, 49.13165420341642], [-123.19637132049907, 49.13167179156063], [-123.19637185642407, 49.131672172046834], [-123.19639661885851, 49.13169013877321], [-123.19639884304844, 49.131691756506505], [-123.19642281521845, 49.131708103054834], [-123.19642636100717, 49.131710553893434], [-123.1964503733176, 49.13172606501354], [-123.19645387517119, 49.13172838564004], [-123.19647919001721, 49.13174402482385], [-123.1964813862402, 49.1317454292148], [-123.19650889477464, 49.131761826734426], [-123.19650917465735, 49.13176198263914], [-123.19653640238481, 49.131777985849915], [-123.19654001054481, 49.131779938997575], [-123.1965639080175, 49.13179364025846], [-123.19657196550922, 49.131797893442496], [-123.19659141169721, 49.13180879636435], [-123.1966050687141, 49.131815845923306], [-123.1966189134171, 49.13182345265538], [-123.19663935701783, 49.13183379637626], [-123.19664641314918, 49.13183760226648], [-123.19667391118314, 49.1318513186281], [-123.19667481680919, 49.131851744823486], [-123.19670140984992, 49.131865191111615], [-123.19671111692823, 49.1318696918281], [-123.19672890651889, 49.131878554805375], [-123.19674876151058, 49.13188763653023], [-123.19675640111471, 49.131891390906986], [-123.19678389465038, 49.13190395556724], [-123.19678768254535, 49.13190557904451], [-123.19681138829388, 49.131916543945636], [-123.19682783357908, 49.13192351944884], [-123.1968388797322, 49.13192857181439], [-123.19686636962679, 49.13194020645504], [-123.19686950968615, 49.13194145723877], [-123.19689385994748, 49.131951945445905], [-123.19691270556781, 49.13195939242172], [-123.19692134789017, 49.13196308075599], [-123.19694883511437, 49.1319740315805], [-123.1969577027091, 49.131977324515816], [-123.19697632164288, 49.13198480375285], [-123.19700380573897, 49.13199495903666], [-123.19700465034019, 49.13199525326431], [-123.19703129058816, 49.1320053015236], [-123.19705401351237, 49.13201317787113], [-123.19705877274278, 49.13201496127931], [-123.19708625489095, 49.132024616708385], [-123.19710621795507, 49.132031097606415], [-123.19711373492625, 49.13203373651553], [-123.19714121448476, 49.132042733535094], [-123.19716193966836, 49.13204901131197], [-123.19716869203954, 49.13205122278206], [-123.19719616910297, 49.132059585782244], [-123.19722224047197, 49.13206691716896], [-123.19722364377516, 49.132067343643875], [-123.19725111829275, 49.13207506036786], [-123.19727859040464, 49.13208216866497], [-123.19728972873158, 49.13208481071328], [-123.19730606141606, 49.132088997679205], [-123.19733353079859, 49.132095414391216], [-123.19736099796701, 49.13210127155226], [-123.19736842702376, 49.132102685056196], [-123.19738846384556, 49.132106802190684], [-123.19741592764697, 49.13211180817749], [-123.19744338907466, 49.13211621504973], [-123.19747084808897, 49.13212001306585], [-123.19747534417056, 49.132120511085326], [-123.19749830489675, 49.13212325455595], [-123.19752575881539, 49.132125767943904], [-123.19755320951758, 49.13212747114866], [-123.19758065663882, 49.132128272790474], [-123.19760809968152, 49.132128048064786], [-123.19763553798427, 49.13212663100075], [-123.19766297067937, 49.132123803847534], [-123.19768546431798, 49.13212015151939], [-123.19769039656417, 49.1321192647272], [-123.19771781351182, 49.13211247954516], [-123.19774521942928, 49.13210292299094], [-123.19774727905828, 49.13210203682349], [-123.1977726083438, 49.13208909472777], [-123.19778068741603, 49.132083970757314], [-123.19779997126878, 49.132068737709034], [-123.19780301352729, 49.13206592366772], [-123.19781861962613, 49.13204788808733], [-123.19782727785868, 49.13203422818093], [-123.19782979448557, 49.13202986009735], [-123.19783763379353, 49.13201183782165], [-123.19784290174742, 49.13199381995142], [-123.19784608828576, 49.13197580564753], [-123.19784756759009, 49.13195779426893], [-123.1978476295793, 49.131939785318906], [-123.19784650220618, 49.13192177840687], [-123.19784436765467, 49.13190377322059], [-123.19784137442053, 49.13188576950558], [-123.19783764657261, 49.13186776704918], [-123.19783329105056, 49.13184976566808], [-123.19782840356034, 49.13183176519822], [-123.19782644603417, 49.13182517278673], [-123.1978232811955, 49.13181376513053], [-123.19781797566982, 49.131795765376374], [-123.19781245334359, 49.131777765993355], [-123.19780679497549, 49.13175976684308], [-123.19780108317322, 49.13174176778401], [-123.19779863943224, 49.1317339715648], [-123.19779564418471, 49.13172376825725], [-123.19779051053395, 49.131705768207105], [-123.19778557122685, 49.13168776782376], [-123.19778088232675, 49.13166976701123], [-123.1977764826416, 49.13165176570303], [-123.19777238512427, 49.131633763877026], [-123.1977707664128, 49.13162604751078], [-123.19776874692363, 49.13161576126407], [-123.19776543742806, 49.13159775808793], [-123.19776221581476, 49.1315797547611], [-123.19775892424747, 49.13156175155395], [-123.19775535676564, 49.131543748819226], [-123.19775126282703, 49.131525746986014], [-123.19774635306497, 49.13150774654985], [-123.19774281001715, 49.13149712940657], [-123.19774050755552, 49.13148974771602], [-123.1977335748792, 49.131471750743685], [-123.19772491701323, 49.131453756725286], [-123.19771512875492, 49.131437361951136], [-123.19771423288367, 49.131435766175976], [-123.19770201762283, 49.131417778247396], [-123.19768753818742, 49.131400387740285], [-123.19768707056333, 49.131399794994806], [-123.19767028983425, 49.131381814879525], [-123.1976599839032, 49.13137252983384], [-123.19765074159376, 49.131363839499386], [-123.19763244760641, 49.13134918931506], [-123.19762845034647, 49.13134586881101], [-123.1976049238541, 49.131328998594554], [-123.19760344018201, 49.13132790277158], [-123.19757740917517, 49.13131108549736], [-123.19757567591589, 49.13130994143958], [-123.19754990123317, 49.131294862959216], [-123.1975450414961, 49.131291985011536], [-123.19752239847806, 49.1312799415022], [-123.1975113105387, 49.13127403387245], [-123.19749489992448, 49.131266073627096], [-123.19747410399394, 49.131256088667904], [-123.19746740501363, 49.13125311906574], [-123.19743991331892, 49.131240970785676], [-123.19743350918804, 49.13123814924523], [-123.19741242419917, 49.13122946763319], [-123.1973890809867, 49.131220216361825], [-123.1973849378441, 49.13121865767631], [-123.19735745332726, 49.13120830779311], [-123.19734077687349, 49.13120229008595], [-123.19732997110786, 49.13119853389251], [-123.19730249066045, 49.13118920379621], [-123.19728766198223, 49.13118437201016], [-123.19727501205159, 49.13118033447338], [-123.197247535001, 49.1311718554657], [-123.19722897943889, 49.13116646342074], [-123.19722005993613, 49.131163874688944], [-123.1971925856678, 49.13115609252967], [-123.19716511434713, 49.13114905151383], [-123.19716321718738, 49.131148566891206], [-123.19713764255992, 49.13114189087193], [-123.19711017344035, 49.13113540111579], [-123.19708825930323, 49.13113068602137], [-123.19708270637574, 49.131129427973974], [-123.19705523897022, 49.13112336714906], [-123.19702777441188, 49.1311180231144], [-123.19700031259617, 49.13111336977751], [-123.19699699939471, 49.13111283291844], [-123.19697284996755, 49.13110850994889], [-123.19694538966365, 49.131104235646326], [-123.19691793211452, 49.13110065570156], [-123.19689047724692, 49.13109775190706], [-123.19686302499963, 49.131095509082144], [-123.19685606909567, 49.13109506444081], [-123.19683557336546, 49.13109342050265], [-123.1968081241788, 49.13109194964911], [-123.19678067824299, 49.13109129976717], [-123.19675323575369, 49.131091520630385], [-123.19672579700291, 49.13109268641688], [-123.19669836227006, 49.13109486814154], [-123.19669356163276, 49.131095341397646], [-123.19667092547715, 49.13109652967069], [-123.1966434847301, 49.131097191898256], [-123.19662615087937, 49.13109545621676], [-123.19661602225742, 49.13109236040021], [-123.196601891484, 49.131077488681264], [-123.19659580391371, 49.1310594902005], [-123.19659303198347, 49.13104148607387], [-123.19659096147527, 49.13102348075284], [-123.19658862264255, 49.13100547588857], [-123.19658822554923, 49.13100299514303], [-123.19658649212593, 49.1309874706695], [-123.19658372053578, 49.13096946654187], [-123.19657999346015, 49.1309514640409], [-123.19657518296845, 49.130933463384316], [-123.19656918408296, 49.13091546475072], [-123.19656190540437, 49.13089746829553], [-123.19656035085639, 49.13089387826455], [-123.19655483471631, 49.130879471485734], [-123.19654682389923, 49.13086147627585], [-123.19653744298601, 49.13084348339756], [-123.19653267478007, 49.130834977576015], [-123.19652764619202, 49.13082549122635], [-123.19651730521566, 49.130807499980456], [-123.19650552190177, 49.13078951118838], [-123.19650504901811, 49.130788790907374], [-123.19649390423896, 49.13077152211315], [-123.19648089893779, 49.130753535398064], [-123.19647744804487, 49.13074886420112], [-123.1964675115944, 49.13073554933157], [-123.196453017481, 49.13071756514663], [-123.19644986592469, 49.13071369784513], [-123.19643799507328, 49.13069958185863], [-123.1964222981858, 49.13068216192935], [-123.1964217651832, 49.13068160062283], [-123.19640494799712, 49.130663620383714], [-123.19639474046738, 49.13065315398457], [-123.19638690333186, 49.13064564222996], [-123.19636772318262, 49.13062766600451], [-123.19636719469436, 49.130627162470034], [-123.19634732005217, 49.13060969185558], [-123.1963396562584, 49.13060302166988], [-123.1963253534161, 49.13059172036159], [-123.19631212708333, 49.13058121961353], [-123.19630160280462, 49.130573751896456], [-123.19628460606422, 49.13056147741126], [-123.1962756519176, 49.13055578716677], [-123.19625709261801, 49.13054364820982], [-123.19624681809404, 49.13053782733137], [-123.19622958653764, 49.13052768036301], [-123.19621402700582, 49.13051987421385], [-123.196202087901, 49.130513594389654], [-123.19617559163883, 49.130501930677234], [-123.19617459701217, 49.1305014681485], [-123.19614711168215, 49.13049074759438], [-123.1961254303334, 49.13048400704666], [-123.19611963443964, 49.13048207438707], [-123.19609216288302, 49.13047484045816], [-123.19606469863723, 49.13046945847449], [-123.19604040253294, 49.13046614259991], [-123.19603724068621, 49.13046567151988]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.7500149751197286, "Contour_Level": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-123.19625861897488, 49.13093033766223], [-123.1962311576982, 49.130925776339154], [-123.1962037048938, 49.13092336069505], [-123.19617625992647, 49.13092293064059], [-123.19614882278994, 49.130924485414745], [-123.1961213939595, 49.130928146357455], [-123.19609397431559, 49.13093413757563], [-123.19609346481069, 49.13093428252571], [-123.19606656128639, 49.130941807870855], [-123.1960391594923, 49.130952329786034], [-123.19603903842396, 49.13095238379579], [-123.19601176536482, 49.130964799323735], [-123.19600135030431, 49.1309704566269], [-123.19598438202235, 49.13098000843062], [-123.19597104806215, 49.13098851690974], [-123.19595700938217, 49.13099793725346], [-123.19594520278186, 49.1310065696208], [-123.19592964794766, 49.13101871466315], [-123.1959224805422, 49.13102461702662], [-123.19590229897283, 49.13104266011711], [-123.19590229897283, 49.13104266011711], [-123.19588333199673, 49.13106070114342], [-123.19587496193405, 49.13106964202355], [-123.19586633605324, 49.131078738822886], [-123.19585102015067, 49.13109677364999], [-123.1958476428465, 49.13110118870842], [-123.19583667570606, 49.13111480682729], [-123.19582424348374, 49.13113283675954], [-123.19582034990673, 49.13113938319154], [-123.19581287649734, 49.13115086488384], [-123.19580306332496, 49.13116889037192], [-123.19579532164653, 49.13118691234631], [-123.19579312004882, 49.13119360724433], [-123.19578881698337, 49.131204932222495], [-123.1957840832948, 49.13122294909524], [-123.1957815643921, 49.1312409622122], [-123.19578138589523, 49.131258971360545], [-123.1957838070613, 49.131276976100644], [-123.195789261762, 49.131294975696605], [-123.19579355367259, 49.131303720755035], [-123.19579770280477, 49.131312970228024], [-123.19580962797318, 49.13133095885007], [-123.19582115303395, 49.13134329913639], [-123.19582625612371, 49.13134893949442], [-123.1958480929446, 49.13136691130128], [-123.19584869112967, 49.131367313143734], [-123.19587602182733, 49.131384872769004], [-123.19587620420882, 49.13138497044573], [-123.19590370326036, 49.13139906267397], [-123.19591189379142, 49.131402820752456], [-123.1959311928187, 49.131410741964935], [-123.19595867419874, 49.13142034295644], [-123.1959599222502, 49.1314207480932], [-123.19598615095455, 49.1314287681524], [-123.19601362087515, 49.13143545722943], [-123.1960300814341, 49.131438637842095], [-123.19604108517123, 49.131440717961404], [-123.19606854467484, 49.131444761945254], [-123.19609599807923, 49.13144725837336], [-123.19612344545926, 49.131448226876074], [-123.1961508864775, 49.131447582556845], [-123.19617831993192, 49.13144502145971], [-123.19620574267168, 49.13143974596309], [-123.19621097356855, 49.131438330578426], [-123.1962331632997, 49.13143393687951], [-123.19626060102055, 49.13143245959014], [-123.19627542707929, 49.13143822102911], [-123.19628809413966, 49.131445014865], [-123.19630038834677, 49.1314561874388], [-123.19631563365724, 49.13146931751894], [-123.19632164741552, 49.13147416013812], [-123.19634316002792, 49.13149028422811], [-123.19634623036183, 49.13149212718107], [-123.19637067150933, 49.13150747525252], [-123.19637590850405, 49.13151008555289], [-123.19639817402657, 49.13152239214267], [-123.19641101530539, 49.13152803468237], [-123.19642566895132, 49.13153538305271], [-123.19645208832155, 49.13154597364993], [-123.1964531563644, 49.13154646925724], [-123.1964806437932, 49.131557556329085], [-123.19650038486088, 49.13156390030942], [-123.19650812417514, 49.13156685736308], [-123.1965356028268, 49.13157571807651], [-123.19655887517071, 49.13158180959526], [-123.19656307576412, 49.131583130915025], [-123.1965905480858, 49.13159038599114], [-123.19661801491549, 49.13159625026518], [-123.19663794452755, 49.131599683805504], [-123.19664547835485, 49.131601255719204], [-123.19667293952831, 49.13160568695569], [-123.19670039605163, 49.13160894156077], [-123.1967278480798, 49.13161105920499], [-123.19675529542045, 49.131611991750255], [-123.19678273752645, 49.13161160146563], [-123.19681017345168, 49.13160964987951], [-123.19683760176467, 49.13160577607826], [-123.1968650204093, 49.13159946159326], [-123.1968655698766, 49.13159929591658], [-123.1968924271516, 49.13159014331439], [-123.19691114105505, 49.13158120936153], [-123.1969198155534, 49.13157619698292], [-123.1969380672538, 49.13156315459233], [-123.19694717368674, 49.13155461332739], [-123.19695610873428, 49.13154511497301], [-123.19696855755316, 49.13152708489172], [-123.19697445878614, 49.13151460096283], [-123.19697701399615, 49.13150906162018], [-123.19698269483479, 49.131491043083344], [-123.1969857739285, 49.13147302898504], [-123.19698664457867, 49.13145501865444], [-123.19698552584524, 49.13143701171787], [-123.19698248968743, 49.13141900805251], [-123.19697747149785, 49.131401007768424], [-123.19697397390473, 49.13139221026352], [-123.19697083314945, 49.131383010248015], [-123.19696264275453, 49.13136501537481], [-123.19695192592397, 49.13134702481059], [-123.19694632164192, 49.131339515509985], [-123.19693941596275, 49.131329037303885], [-123.19692443077348, 49.131311054017445], [-123.19691874323583, 49.13130545372832], [-123.19690731065722, 49.13129307436999], [-123.19689119546332, 49.13127911802038], [-123.19688690796585, 49.13127510031756], [-123.196863665963, 49.13125738970612], [-123.19686334602845, 49.13125713164815], [-123.19683658103638, 49.13123916843452], [-123.19683614938458, 49.13123891928188], [-123.19680864244094, 49.13122287770604], [-123.19680575686579, 49.13122121213372], [-123.19678114317263, 49.13120877090995], [-123.19676946610652, 49.13120326514108], [-123.19675365122197, 49.13119650933195], [-123.19672616713494, 49.131186231732684], [-123.19672362728234, 49.131185334405615], [-123.19669868736644, 49.131177042849686], [-123.19667121669062, 49.13117015006937], [-123.1966566618517, 49.13116743963771], [-123.19664375292284, 49.131165002003414], [-123.19661629604053, 49.13116159365774], [-123.19658884775336, 49.13116035816106], [-123.19656140565688, 49.13116068824194], [-123.19653396152651, 49.13116050386718], [-123.1965064758836, 49.13114981605253], [-123.19650631996932, 49.131149686763216], [-123.19649509523907, 49.131131697020415], [-123.19649054257201, 49.13111369592211], [-123.1964863791041, 49.131095694161246], [-123.19647967281249, 49.131077696727345], [-123.19647873979726, 49.131075749754956], [-123.19647132365773, 49.131059702088585], [-123.19645899886054, 49.13104171421394], [-123.19645112465305, 49.1310322716673], [-123.19644293870908, 49.13102373269332], [-123.19642357833418, 49.13100620276541], [-123.19642297356478, 49.13100575781374], [-123.19639872013852, 49.13098779022517], [-123.19639605454246, 49.1309858295408], [-123.19636876146805, 49.13096983233483], [-123.1963685475369, 49.130969700786615], [-123.19634105024633, 49.13095602766354], [-123.19632976588206, 49.13095188980357], [-123.19631356405152, 49.13094516090027], [-123.19628608774468, 49.13093679573979], [-123.19627296308582, 49.13093397753139], [-123.19625861897488, 49.13093033766223]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.500004086883136, "Contour_Level": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-123.1963416572123, 49.1311097302887], [-123.19631419921244, 49.131106025914825], [-123.19628675592897, 49.13110604817194], [-123.19625932158574, 49.13110833532097], [-123.19623189163278, 49.13111173548225], [-123.19621967945206, 49.13111415656175], [-123.19620446770512, 49.1311166634376], [-123.196177055697, 49.131124613693935], [-123.19616006465944, 49.13113226670563], [-123.19614966294442, 49.131137447010026], [-123.19613001348625, 49.13115032660312], [-123.1961222966414, 49.13115698921582], [-123.19611008363839, 49.13116836930196], [-123.19609710079777, 49.1311864001987], [-123.19609498728111, 49.13119097457098], [-123.19608779605178, 49.1312044248474], [-123.19608246999081, 49.13122244273846], [-123.19608085425716, 49.13124045432817], [-123.19608286970792, 49.13125845975111], [-123.19608955517569, 49.1312764572428], [-123.19609535688525, 49.131284686640626], [-123.19610145069338, 49.13129444588521], [-123.19612218573242, 49.13131241951173], [-123.19612291154318, 49.131312874001736], [-123.19615041199836, 49.1313273143931], [-123.19615923704666, 49.13133036541529], [-123.19617789631509, 49.13133766062259], [-123.19620538178376, 49.13134829585449], [-123.19620538178376, 49.13134829585449], [-123.19623285314714, 49.131355354269076], [-123.19626029574287, 49.13135512292004], [-123.19627567124863, 49.13134817638757], [-123.19628769422533, 49.131343717858385], [-123.19629817079048, 49.131330129291904], [-123.19630532012224, 49.13131210829128], [-123.19630845802438, 49.1312940941106], [-123.19630927883811, 49.13127608386938], [-123.19631480867552, 49.13126038117711], [-123.19631658934236, 49.13125806259386], [-123.1963422123466, 49.13125030638236], [-123.19636529250594, 49.13123997092778], [-123.19636960570742, 49.1312376239186], [-123.19639700794157, 49.13122719133426], [-123.19642110366645, 49.13122186714913], [-123.19642294711855, 49.131203855167136], [-123.19642021860889, 49.131185850962964], [-123.19641984279377, 49.13116784275632], [-123.19641351697999, 49.13114984467155], [-123.19639663236232, 49.13113211036651], [-123.19639619214531, 49.13113186529615], [-123.19636913093376, 49.13111741425091], [-123.19635517895634, 49.13111392620581], [-123.1963416572123, 49.1311097302887]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "4", "type": "Feature", "properties": {"name": "RBM", "Zm": 4.0, "lat": 49.131267, "lon": -123.196356, "canopy_height": 1.5}, "geometry": {"type": "Point", "coordinates": [-123.196356, 49.131267]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "4", "type": "Feature", "properties": {"name": "RBM", "Zm": 4.0, "lat": 49.131267, "lon": -123.196356, "canopy_height": 1.5}, "geometry": {"type": "Point", "coordinates": [-123.196356, 49.131267]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>