<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-123.196356, 49.131267], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.9000018011160866, "info": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-123.19628512638063, 49.130710691145076], [-123.1962576374444, 49.1307060587966], [-123.19623015611282, 49.13070335199625], [-123.19620268226785, 49.13070254164347], [-123.1961752161397, 49.13070368687339], [-123.19614775829442, 49.130706932000805], [-123.19612030963366, 49.13071250649618], [-123.19610286629603, 49.13071761002303], [-123.19609287029743, 49.13072044682048], [-123.19606544015656, 49.130730721217134], [-123.19605478819622, 49.13073571856379], [-123.19603801966014, 49.13074344455943], [-123.19601936529355, 49.13075380560002], [-123.19601060860226, 49.13075856565303], [-123.19598936283795, 49.13077188342441], [-123.1959832051867, 49.13077562979788], [-123.19596207684008, 49.13078995663048], [-123.1959558070562, 49.130794039693484], [-123.19593601432794, 49.1308080277538], [-123.19592841161996, 49.13081313844401], [-123.19591026315035, 49.130826098342865], [-123.19590101656377, 49.130832338992136], [-123.1958842181966, 49.13084416942458], [-123.19587362017344, 49.13085120624567], [-123.1958574368141, 49.13086224174955], [-123.19584622133173, 49.130869456431824], [-123.19582953782827, 49.1308803159638], [-123.1958188193387, 49.13088691157058], [-123.1958001232724, 49.13089839274141], [-123.19579141376043, 49.130903461144094], [-123.19576873652863, 49.13091647285543], [-123.19576400438785, 49.13091905166944], [-123.19573659079478, 49.130933574487216], [-123.19573464739621, 49.13093455754217], [-123.19570917203193, 49.1309467879904], [-123.19569657433993, 49.130952648971316], [-123.19568175020765, 49.130959227327274], [-123.19565512818097, 49.13097074610386], [-123.19565432605948, 49.13097107959994], [-123.19562689763744, 49.13098184895891], [-123.1956089115941, 49.130988851303506], [-123.19559946845675, 49.13099242849064], [-123.19557203778467, 49.131002631841525], [-123.19556033449483, 49.131006960482715], [-123.19554460665664, 49.131012722110086], [-123.19551717616622, 49.1310229773573], [-123.19551156967346, 49.1310250699593], [-123.19548974594045, 49.13103330278576], [-123.19546482707271, 49.13104317599177], [-123.19546231794256, 49.13104419782073], [-123.195434891393, 49.131055464362014], [-123.19542133839944, 49.13106127649785], [-123.19540746790933, 49.131067514158886], [-123.19538223806038, 49.13107936956158], [-123.19538004796021, 49.131080466794536], [-123.19535263197325, 49.13109443147692], [-123.19534684867811, 49.131097456333485], [-123.19532522122641, 49.13110973394064], [-123.19531522573119, 49.1311155367231], [-123.19529781695259, 49.13112668861261], [-123.19528712909059, 49.131133611139724], [-123.19527042098505, 49.131145762973944], [-123.19526228521282, 49.1311516800485], [-123.19524303625396, 49.13116770408804], [-123.19524056022946, 49.13116974367791], [-123.19522146473393, 49.13118780285721], [-123.19521566995556, 49.131194345975594], [-123.19520516192124, 49.13120585731181], [-123.1951917688584, 49.13122390684499], [-123.19518833805581, 49.13122975752326], [-123.19518082885492, 49.13124195222975], [-123.19517261460284, 49.13125999300588], [-123.19516725390388, 49.13127802895788], [-123.1951646816067, 49.13129606019632], [-123.19516493020534, 49.13131408666644], [-123.19516813771895, 49.131332108134934], [-123.19517456195783, 49.13135012416573], [-123.19518460292694, 49.131368134082116], [-123.19518890336124, 49.13137375447433], [-123.19519811983588, 49.13138613812116], [-123.19521601278885, 49.13140413475977], [-123.19521649521006, 49.13140452867941], [-123.19523806003424, 49.1314221243709], [-123.19524405103849, 49.13142612155334], [-123.19526538721081, 49.13144010504848], [-123.19527159049781, 49.13144354051002], [-123.19529883200715, 49.131458075371874], [-123.19529911917094, 49.131458208618405], [-123.19532663941924, 49.13147072810554], [-123.19533905216683, 49.13147603422294], [-123.19535415404032, 49.13148181189756], [-123.19538166374583, 49.131491641696336], [-123.1953885201199, 49.131493977410635], [-123.19540916946411, 49.13150045423377], [-123.19543667158796, 49.131508349860425], [-123.19544996722267, 49.13151190029949], [-123.19546417077383, 49.1315154959575], [-123.1954916673303, 49.13152197131474], [-123.19551916103237, 49.131527718992665], [-123.19552986406788, 49.13152979191271], [-123.19554665285925, 49.13153298827855], [-123.1955741427395, 49.1315377612091], [-123.19560163028783, 49.13154194006066], [-123.19562911562478, 49.13154555571216], [-123.19564703491855, 49.13154762031586], [-123.19565659934848, 49.13154876040009], [-123.19568408196504, 49.13155168289055], [-123.19571156264108, 49.1315541115822], [-123.1957390414463, 49.131556064393706], [-123.19576651844716, 49.131557558399535], [-123.19579399371564, 49.131558612079544], [-123.19582146734598, 49.13155924953917], [-123.19584893948313, 49.13155950774604], [-123.19587641036902, 49.13155944828206], [-123.19590388041627, 49.13155917599014], [-123.19593135032453, 49.13155886849955], [-123.19595882126471, 49.131558822916865], [-123.19598629516256, 49.13155952766401], [-123.19601377509788, 49.13156176361275], [-123.19603182423872, 49.13156499453894], [-123.1960412689296, 49.13156752325601], [-123.19606879486872, 49.131581423011], [-123.19607067320298, 49.131582955463024], [-123.19608555636864, 49.13160095707751], [-123.19609641407301, 49.13161896552691], [-123.19609641407301, 49.13161896552691], [-123.19610329777697, 49.13163698072494], [-123.19610997346807, 49.13165499627584], [-123.1961169148827, 49.13167301137493], [-123.19612416737395, 49.13169049172565], [-123.19612437190237, 49.131691025597725], [-123.19613138075854, 49.131709040581285], [-123.19613922060488, 49.131727054152705], [-123.19614795059746, 49.13174506621135], [-123.19615188441236, 49.13175280616933], [-123.19615700605925, 49.13176307771632], [-123.19616657923109, 49.131781088340944], [-123.19617713809103, 49.13179909728996], [-123.19617955422173, 49.13180313355729], [-123.19618804319168, 49.13181710564962], [-123.19619979622772, 49.131835112567316], [-123.1962071942366, 49.13184589687272], [-123.19621235927004, 49.13185311810725], [-123.1962256525608, 49.131871122404704], [-123.1962348116638, 49.13188292528508], [-123.19623994850248, 49.13188912499645], [-123.19625519383473, 49.13190712597263], [-123.1962624111897, 49.13191540839451], [-123.19627165038342, 49.1319251248878], [-123.19628934943971, 49.13194312168824], [-123.19628999453131, 49.131943783061814], [-123.19630882671365, 49.131961115462545], [-123.196317565504, 49.131969017269725], [-123.19633027953158, 49.13197910587431], [-123.196345123144, 49.13199086829892], [-123.19635428779132, 49.131997091936206], [-123.1963726690287, 49.132009736963944], [-123.19638195320718, 49.13201507177283], [-123.19640020396592, 49.13202582901155], [-123.196415284889, 49.13203304196374], [-123.19642772822407, 49.132039213556304], [-123.19645524205686, 49.132049955946904], [-123.19645871244421, 49.13205099496703], [-123.19648274759997, 49.13205859771027], [-123.19651024370356, 49.1320648488138], [-123.19653683666843, 49.13206888889843], [-123.19653773164934, 49.13206903449653], [-123.19656521373004, 49.13207173552961], [-123.19659268996506, 49.13207295744252], [-123.19662016178887, 49.13207306359122], [-123.19664763057212, 49.13207240096138], [-123.19667509756316, 49.13207128546459], [-123.19670256381302, 49.13206998293866], [-123.19673003010891, 49.13206869240253], [-123.19673327809615, 49.132068554348386], [-123.19675749729291, 49.132067626641756], [-123.19678496516451, 49.13206673490668], [-123.19681243358878, 49.132065983020354], [-123.19683990227477, 49.132065297458894], [-123.19686737076799, 49.13206456339334], [-123.19689483848273, 49.13206363296704], [-123.19692230472351, 49.13206233065011], [-123.19694976869535, 49.13206045593478], [-123.19697722950865, 49.13205778450549], [-123.19700468618475, 49.132054069719736], [-123.1970270008874, 49.132050026611324], [-123.1970321379218, 49.132049109670895], [-123.19705958477515, 49.1320429188539], [-123.19708702476181, 49.13203499754009], [-123.19709610657728, 49.13203188177711], [-123.19711445897178, 49.132025621376435], [-123.19714188691061, 49.13201466627983], [-123.19714393428201, 49.132013773234725], [-123.1971693119909, 49.132002993420315], [-123.19718543462629, 49.13199567547862], [-123.19719673496489, 49.13199079275763], [-123.19722415881289, 49.131978815809276], [-123.19722707856339, 49.13197757746226], [-123.19725158739377, 49.13196803512667], [-123.19727500840614, 49.13195946869089], [-123.19727901948372, 49.131958141792616], [-123.19730645832789, 49.13194995316894], [-123.19733390094021, 49.13194271619739], [-123.1973399578697, 49.13194133081159], [-123.19736134931352, 49.131936932513234], [-123.19738880139325, 49.13193208400555], [-123.19741625626216, 49.131927939282235], [-123.1974437134783, 49.13192438676229], [-123.1974551655535, 49.13192310695717], [-123.19747117311606, 49.13192144493346], [-123.1974986343489, 49.13191890546749], [-123.19752609636382, 49.13191656355359], [-123.19755355878111, 49.13191432355542], [-123.19758102124206, 49.13191209516561], [-123.19760848340633, 49.131909792745326], [-123.19763594494754, 49.13190733422901], [-123.19766256362847, 49.13190472519887], [-123.19766340555928, 49.131904642604376], [-123.19769086523318, 49.13190171585858], [-123.19771832324456, 49.13189837187405], [-123.19774577924868, 49.1318945241349], [-123.19777323287819, 49.13189008051267], [-123.19779279860437, 49.13188647528034], [-123.19780068372613, 49.13188493896035], [-123.19782813117348, 49.131878944191456], [-123.19785557461562, 49.13187194463166], [-123.19786822379434, 49.13186831915727], [-123.19788301290272, 49.131863651808416], [-123.1979104449073, 49.13185378300892], [-123.19791936672237, 49.13185020461151], [-123.1979378681675, 49.13184172052151], [-123.19795646119667, 49.13183211412994], [-123.19796527971471, 49.1318267196871], [-123.19798412264548, 49.13181403981194], [-123.1979926721073, 49.13180691304864], [-123.19800485070989, 49.131795977377664], [-123.19802002812295, 49.131777978443886], [-123.19802007123857, 49.131777924385425], [-123.19803102604999, 49.131759878707534], [-123.19803818197006, 49.13174183954449], [-123.198042111976, 49.131723805914206], [-123.19804324803673, 49.131705777076085], [-123.19804191130052, 49.131687752479365], [-123.19803833375137, 49.13166973172607], [-123.19803267371458, 49.13165171454443], [-123.19802502681684, 49.1316337007701], [-123.19801941173178, 49.13162321570768], [-123.19801563486516, 49.13161568998805], [-123.19800470675595, 49.131597681839565], [-123.1979919266667, 49.131579676865805], [-123.19799176641075, 49.131579480216764], [-123.19797804137941, 49.13156167378564], [-123.19796416124787, 49.13154581823743], [-123.19796238246394, 49.13154367374476], [-123.19794565282153, 49.131525675537354], [-123.19793657501462, 49.13151690170352], [-123.1979274761091, 49.131507679808145], [-123.19790899997376, 49.13149078886062], [-123.19790784753323, 49.13148968656465], [-123.19788726133214, 49.131471694959025], [-123.19788143432012, 49.13146702732279], [-123.19786541906838, 49.13145370550223], [-123.19785387511234, 49.13144487894973], [-123.1978423042795, 49.131435718221745], [-123.19782632111979, 49.131424035113746], [-123.19781796872407, 49.131417733028144], [-123.19779877156279, 49.131404300399396], [-123.19779244999945, 49.131399749856236], [-123.1977712258165, 49.13138551817171], [-123.19776577051776, 49.13138176866684], [-123.19774368338187, 49.1313675633708], [-123.19773793599742, 49.13136378944937], [-123.19771614386447, 49.13135033714348], [-123.19770893334, 49.13134581222542], [-123.19768860695842, 49.13133376287631], [-123.1976787277146, 49.13132783705375], [-123.19766107243511, 49.13131778333003], [-123.19764725860668, 49.131309864037], [-123.19763354013519, 49.13130235867353], [-123.1976144344966, 49.131291893330776], [-123.19760600996388, 49.13128746528669], [-123.19758012570487, 49.131273925155824], [-123.19757848188883, 49.131273095257086], [-123.19755095525393, 49.13125908367007], [-123.19754478564631, 49.13125595873508], [-123.19752343027544, 49.131245485114334], [-123.1975078961735, 49.13123799495395], [-123.19749590719206, 49.13123235986149], [-123.19746901998577, 49.13122003455885], [-123.19746838616749, 49.13121974930843], [-123.19744086567833, 49.13120727007607], [-123.197429051668, 49.13120207601807], [-123.19741334706933, 49.13119526087288], [-123.19738655263991, 49.1311841217899], [-123.197385830742, 49.13118382305546], [-123.19735831443172, 49.13117238634223], [-123.19734256729843, 49.13116617008643], [-123.19733080036508, 49.131161511741], [-123.19730328782634, 49.13115101913254], [-123.19729577087291, 49.13114822316972], [-123.19727577597685, 49.131140697299095], [-123.19724826690282, 49.1311310721793], [-123.19724598815968, 49.131130281335686], [-123.19722075734853, 49.13112132330466], [-123.1971932514161, 49.13111248489947], [-123.19719281474383, 49.13111234527111], [-123.19716574440481, 49.131103371978945], [-123.19713824127548, 49.13109523556026], [-123.19713541415342, 49.13109441639956], [-123.19711073730373, 49.13108688438135], [-123.19708323663244, 49.1310793635001], [-123.19707207238578, 49.13107649764027], [-123.19705573657413, 49.13107199517382], [-123.19702823803833, 49.13106500899277], [-123.19700074305301, 49.13105891694388], [-123.19699923251156, 49.13105859505241], [-123.19697324670796, 49.1310524799675], [-123.19694575349646, 49.131046832270826], [-123.1969182634174, 49.13104197390194], [-123.19691059659954, 49.13104071935896], [-123.19689077281154, 49.13103698114188], [-123.19686328322571, 49.13103224460147], [-123.19683579513676, 49.13102788484518], [-123.1968083074963, 49.13102363716974], [-123.19680387856579, 49.13102287442025], [-123.19678081426557, 49.131017975841075], [-123.19675331755717, 49.13101143411122], [-123.1967292334767, 49.13100497473897], [-123.19672581664507, 49.131003828125515], [-123.19669830260763, 49.13099290229446], [-123.19668495433534, 49.13098702328517], [-123.19667077753118, 49.130979182652254], [-123.19665432663543, 49.13096904856364], [-123.19664323241624, 49.130960392585195], [-123.19663273007097, 49.13095105845388], [-123.19661601688546, 49.13093306002424], [-123.19661565172687, 49.13093260123046], [-123.1966025278721, 49.130915056102104], [-123.19658810925937, 49.13089705376114], [-123.19658804005707, 49.130896966659485], [-123.19657313978287, 49.13087905235617], [-123.19656044406373, 49.130865287432584], [-123.19655620860081, 49.13086105428882], [-123.19653765979739, 49.130843058972495], [-123.19653286754875, 49.130838527039494], [-123.19651713044453, 49.130825067024105], [-123.19650530465192, 49.130815204811014], [-123.19649431584976, 49.13080707896118], [-123.196477753447, 49.130794834754035], [-123.19646883523785, 49.130789095430295], [-123.19645021176602, 49.13077686941968], [-123.19643996586147, 49.13077111765934], [-123.196422678596, 49.130761053404626], [-123.1964065081314, 49.13075314768638], [-123.19639515363592, 49.13074731141946], [-123.19636763685006, 49.13073563528091], [-123.19636635327363, 49.13073518909393], [-123.19634012559146, 49.1307253555661], [-123.19631262336395, 49.130717360286525], [-123.19631214334049, 49.13071725438572], [-123.19628512638063, 49.130710691145076]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.7499442679741651, "info": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-123.1963689113448, 49.131058334234936], [-123.19634143082402, 49.131055883618636], [-123.19631395279734, 49.13105406398217], [-123.19628646597657, 49.13105001628152], [-123.19625898047728, 49.1310463022259], [-123.19623150251462, 49.13104449669636], [-123.19620403307324, 49.13104485002671], [-123.19617657248729, 49.13104744780868], [-123.19614912130548, 49.131052430071634], [-123.19612168067646, 49.131060089010035], [-123.19612168067646, 49.131060089010035], [-123.19609424443682, 49.13106886300963], [-123.1960724504923, 49.13107819951388], [-123.1960668198412, 49.13108059222138], [-123.1960394040781, 49.13109456481469], [-123.19603637510872, 49.13109628766219], [-123.19601199915647, 49.131111291319556], [-123.19600737803925, 49.131114363783055], [-123.19598460875103, 49.131131705121525], [-123.19598366492046, 49.13113243092763], [-123.19596304993732, 49.131150492809006], [-123.19595723710827, 49.13115688521118], [-123.1959456595152, 49.13116854921434], [-123.19593157585224, 49.131186600005556], [-123.19592989387601, 49.13118928181318], [-123.19591861993935, 49.131204648881386], [-123.19590843155893, 49.13122269305988], [-123.19590260899396, 49.13123649651776], [-123.19590049410766, 49.13124073341828], [-123.19589441800416, 49.131258770618054], [-123.19589177834453, 49.13127680198715], [-123.19589294343963, 49.13129482690092], [-123.19589833947916, 49.13131284463616], [-123.1959029425363, 49.13132114815742], [-123.19590778345022, 49.13133085550278], [-123.19592196657598, 49.13134885832689], [-123.19593055295235, 49.131356529194726], [-123.1959418490649, 49.13136685147721], [-123.19595810786416, 49.13137781754629], [-123.1959689129783, 49.131384832435344], [-123.19598564057534, 49.131393467878254], [-123.19600591105637, 49.13140279652317], [-123.19601315968602, 49.13140566402105], [-123.19604067032493, 49.131415708159714], [-123.19605627222894, 49.131420737908726], [-123.19606817565756, 49.13142440390076], [-123.19609567906639, 49.13143260943887], [-123.19611776838248, 49.13143866035917], [-123.19612318013925, 49.13144022048018], [-123.19615068320904, 49.13144833555417], [-123.1961781822701, 49.131455432390084], [-123.1961825520394, 49.131456577190974], [-123.19620569073963, 49.13146491135817], [-123.19622589060558, 49.1314745304346], [-123.19623321947617, 49.131479522645606], [-123.19624830290108, 49.13149251923236], [-123.19626078744848, 49.13150406946739], [-123.1962675655002, 49.13151051337985], [-123.19628761767656, 49.13152850618175], [-123.19628835763017, 49.131529168997716], [-123.196308910386, 49.131546496870946], [-123.19631591889531, 49.13155200327367], [-123.19633351577964, 49.13156448192316], [-123.19634346620037, 49.131571296116704], [-123.19636211867058, 49.13158246017165], [-123.19637100246297, 49.13158778771715], [-123.1963962585092, 49.131600428994844], [-123.19639852820632, 49.13160161171356], [-123.19642604747641, 49.131613793343256], [-123.19643962089673, 49.13161838211736], [-123.1964535575399, 49.1316236415457], [-123.19648106033813, 49.13163164853665], [-123.19650289040669, 49.13163630134509], [-123.19650855546176, 49.1316377115381], [-123.196536046471, 49.13164273199676], [-123.19656353045606, 49.13164597436081], [-123.19659100827522, 49.131647656438375], [-123.19661848026104, 49.13164786297337], [-123.1966459463495, 49.13164657840178], [-123.19667340618645, 49.131643713813816], [-123.19670085923003, 49.131639132916526], [-123.19671503522613, 49.131635940098484], [-123.19672830635135, 49.1316330565781], [-123.19675574751207, 49.131625475729514], [-123.19677813155477, 49.13161780569138], [-123.19678318143976, 49.131616069518], [-123.19681061062012, 49.13160546664915], [-123.19682394536545, 49.13159970071237], [-123.19683803413928, 49.131593436782886], [-123.19686251494936, 49.131581608066945], [-123.19686545255605, 49.13158012164936], [-123.19689286682565, 49.131565762983335], [-123.19689702526291, 49.13156352233101], [-123.19692027563207, 49.131550028958785], [-123.1969279452431, 49.131545442708415], [-123.19694767643486, 49.13153227881494], [-123.19695485171047, 49.13152736992389], [-123.19697506393179, 49.131511175043386], [-123.19697735011273, 49.13150930465337], [-123.1969957520565, 49.13149124636778], [-123.19700242187389, 49.13148261816607], [-123.19700970496987, 49.13147319567067], [-123.19701969571106, 49.131455151732894], [-123.1970257704771, 49.13143711447664], [-123.19702849140575, 49.13141908294327], [-123.19702825664781, 49.13140105645359], [-123.19702530534721, 49.13138303459949], [-123.19701971785945, 49.13136501724366], [-123.19701140806589, 49.13134700453265], [-123.19700182386678, 49.13133169413138], [-123.1970003374844, 49.13132899653154], [-123.19698761911182, 49.131310991340655], [-123.19697421156069, 49.13129602500086], [-123.19697176816764, 49.131292991492444], [-123.19695408544676, 49.131274994766706], [-123.19694663235488, 49.13126870204363], [-123.19693378280476, 49.1312570025069], [-123.19691907090986, 49.131245855770956], [-123.1969105566204, 49.13123901522945], [-123.19689152171154, 49.13122609565164], [-123.19688432691743, 49.131221033068975], [-123.19686398196698, 49.13120871760931], [-123.19685468134965, 49.131203056726456], [-123.19683644995963, 49.13119328906435], [-123.19682057604689, 49.13118508797875], [-123.1968089249652, 49.131179627851125], [-123.19678140706499, 49.131167755264116], [-123.19677991645241, 49.13116713039169], [-123.19675389302616, 49.13115685512563], [-123.19673021108557, 49.131149188203544], [-123.19672638682773, 49.13114793347441], [-123.19669888200791, 49.13113935778666], [-123.19667138283849, 49.13113220815341], [-123.1966678139987, 49.13113126761305], [-123.19664387827402, 49.13112369242707], [-123.1966163749873, 49.131115497427224], [-123.19660893506548, 49.131113340998006], [-123.19658886807218, 49.131106382479416], [-123.19656136771081, 49.13109892271777], [-123.1965423422719, 49.131095427484155], [-123.19653387505201, 49.1310934094812], [-123.19650638883698, 49.13108952509049], [-123.1964789108408, 49.131087719419305], [-123.19645140981405, 49.13108008446219], [-123.19644407648052, 49.13107756782485], [-123.19642389769658, 49.13106964003567], [-123.1963963994187, 49.13106269631164], [-123.19637601153387, 49.131059656719714], [-123.1963689113448, 49.131058334234936]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.499577057588805, "info": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-123.1962594465834, 49.13116438386206], [-123.19623198725438, 49.13116731610928], [-123.19622941185791, 49.13116806731255], [-123.19620454902643, 49.13117559631329], [-123.19618525883, 49.13118616923515], [-123.19617714502235, 49.131192552588864], [-123.1961642405858, 49.13120423183751], [-123.19615406705884, 49.13122227601249], [-123.19615227475677, 49.13124030594812], [-123.19615803526858, 49.13125832305222], [-123.19616455930914, 49.13127633885877], [-123.19616908671306, 49.13129435805725], [-123.19617760103513, 49.13130812482271], [-123.19617986657218, 49.131312366632], [-123.19619520233314, 49.13133036746419], [-123.19620519619957, 49.13133959334616], [-123.19621409738824, 49.1313483622456], [-123.19623274783261, 49.13136002352936], [-123.19625152117534, 49.13136632553141], [-123.19626025384444, 49.131368890627925], [-123.1962877464141, 49.131374350377754], [-123.19631254757225, 49.13138424867675], [-123.19631526224568, 49.13138569994007], [-123.19633099163305, 49.13140224420573], [-123.19634284169355, 49.13141315561989], [-123.19634954970813, 49.13142023953781], [-123.19637040705366, 49.13143703668593], [-123.19637280572513, 49.131438226876746], [-123.19639793632925, 49.13145177608328], [-123.19641417078789, 49.131456183406286], [-123.19642544008497, 49.13146005179105], [-123.19645292929647, 49.131464644285224], [-123.19648040435055, 49.131465652979315], [-123.19650786674163, 49.13146345749513], [-123.19653531491889, 49.13145766684563], [-123.1965406006003, 49.13145596826164], [-123.19656274951302, 49.13144844206381], [-123.19658353130043, 49.131437868285204], [-123.19659016287457, 49.13143384999234], [-123.19660932321308, 49.13141979747855], [-123.19661754636256, 49.13141170780113], [-123.19662726316957, 49.131401740038136], [-123.19663985393244, 49.131383691705224], [-123.1966448637236, 49.13137285242566], [-123.1966486207252, 49.13136564988381], [-123.19665473100477, 49.13134761258637], [-123.19665764084152, 49.13132958073976], [-123.19665766845077, 49.13131155380222], [-123.1966546811282, 49.13129353199978], [-123.19664806676697, 49.131275516374735], [-123.19664445520382, 49.1312695631453], [-123.19663853701181, 49.13125750571448], [-123.19662434199077, 49.13123950299826], [-123.19661683994943, 49.13123307485809], [-123.19660425593318, 49.13122151031163], [-123.19658928678379, 49.13121227916853], [-123.19657340239124, 49.13120353595385], [-123.19656176011269, 49.13119817932492], [-123.1965342448303, 49.13118695665536], [-123.19653018388837, 49.13118558263551], [-123.19650673796265, 49.13117785990623], [-123.19647925156866, 49.13117394150959], [-123.19645178806948, 49.13117581640926], [-123.19642435403877, 49.131185150966864], [-123.19642020144705, 49.13118576978996], [-123.19639690087753, 49.131189645079374], [-123.19636941661645, 49.13118626617771], [-123.19634194768139, 49.13118676731501], [-123.1963385208446, 49.13118590871605], [-123.19631444311982, 49.131178245671265], [-123.19628693357073, 49.131168458290105], [-123.1962823673617, 49.13116797730004], [-123.1962594465834, 49.13116438386206]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "4", "type": "Feature", "properties": {"index": "RBM", "name": "Richmond Brackish Marsh", "Zm": 4.0, "lat": 49.131267, "lon": -123.196356, "canopy_height": 1.5, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/RichmondBrackishMarsh.html#", "info": "https://ubc-micromet.github.io/Data.html#delta-salt-marsh"}, "geometry": {"type": "Point", "coordinates": [-123.196356, 49.131267]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "4", "type": "Feature", "properties": {"index": "RBM", "name": "Richmond Brackish Marsh", "Zm": 4.0, "lat": 49.131267, "lon": -123.196356, "canopy_height": 1.5, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/RichmondBrackishMarsh.html#", "info": "https://ubc-micromet.github.io/Data.html#delta-salt-marsh"}, "geometry": {"type": "Point", "coordinates": [-123.196356, 49.131267]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>