<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-122.895226, 49.088835], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.900004637113204, "info": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.89543396146941, 49.087832580776315], [-122.89540652549444, 49.087827344848485], [-122.89537908460727, 49.08782444972083], [-122.89535163911387, 49.08782374793543], [-122.8953241891872, 49.08782515548212], [-122.89529673487532, 49.08782864786786], [-122.89526927609994, 49.087834260655136], [-122.89526827792746, 49.08783453905756], [-122.89524181370967, 49.087841588815316], [-122.89521434664593, 49.087851134032434], [-122.8952110723403, 49.08785251415779], [-122.89518687589688, 49.0878624251052], [-122.8951704040285, 49.08787050424882], [-122.89515940076399, 49.08787579245155], [-122.89513655849932, 49.08788850052366], [-122.8951319216396, 49.08789104810585], [-122.8951068185421, 49.08790650051927], [-122.89510443901644, 49.087907956710154], [-122.89507952853813, 49.08792450273398], [-122.89507695353862, 49.08792621123634], [-122.89505362852783, 49.08794250620591], [-122.895049466035, 49.08794541738273], [-122.89502837174295, 49.087960510256906], [-122.89502197753363, 49.087965086745285], [-122.8950031328368, 49.087978514318586], [-122.89499448923208, 49.087984651029274], [-122.89497725517413, 49.08799651779354], [-122.89496700241146, 49.088003502973415], [-122.89494988290836, 49.08801451990252], [-122.894939518312, 49.088021055294476], [-122.89491973618964, 49.08803251947939], [-122.89491203791783, 49.088036842678704], [-122.89488492775105, 49.088050514803456], [-122.894884561597, 49.08805069219042], [-122.89485708982139, 49.08806238182656], [-122.89484135118799, 49.0880685021297], [-122.89482962051052, 49.08807289837358], [-122.89480215241922, 49.0880828321481], [-122.89479232446602, 49.088086484472264], [-122.89477468382975, 49.08809299646526], [-122.89474721246101, 49.088104470363454], [-122.89474721246101, 49.088104470363454], [-122.89471973757742, 49.08811760072975], [-122.89471088384703, 49.088122464248734], [-122.89469225763246, 49.088133117529296], [-122.89468078305734, 49.088140463804805], [-122.8946647717792, 49.088151419267774], [-122.89465581392649, 49.088158468036156], [-122.89463727442505, 49.08817514688362], [-122.89463596697136, 49.08817647693749], [-122.89461962853537, 49.088194489038344], [-122.89460976052327, 49.08820668060339], [-122.89460511638995, 49.08821250280431], [-122.89459154038171, 49.088230517423206], [-122.89458223432051, 49.08824400834545], [-122.89457908964951, 49.08824853306813], [-122.89456720050502, 49.08826654922459], [-122.89455640595466, 49.08828456637963], [-122.89455469489472, 49.08828756097429], [-122.89454583673945, 49.08830258373946], [-122.89453599264947, 49.088320601760756], [-122.89452714044221, 49.08833818514293], [-122.89452691090985, 49.088338620477735], [-122.89451764006007, 49.08835663902113], [-122.89450891587123, 49.08837465806331], [-122.89450057601776, 49.08839267745601], [-122.89449957319691, 49.08839482085781], [-122.8944915491384, 49.088410696220116], [-122.89448226888572, 49.08842871475187], [-122.89447255200069, 49.08844673288364], [-122.89447201398636, 49.088447635626565], [-122.89446071873998, 49.08846474907961], [-122.8944475359894, 49.08848276404037], [-122.89444448445008, 49.088486424226986], [-122.89443124793101, 49.088500776159705], [-122.89441697756826, 49.08851450836216], [-122.89441212068613, 49.088518785679724], [-122.89438948344961, 49.08853656009478], [-122.89438916707796, 49.08853679169587], [-122.89436199772311, 49.08855464454243], [-122.89436175927526, 49.08855479363128], [-122.89433451749335, 49.088570129240495], [-122.89432963944913, 49.088572791246804], [-122.89430704092605, 49.08858388040116], [-122.89429276295506, 49.0885907844976], [-122.89427956670768, 49.08859651805476], [-122.89425209395314, 49.08860845985747], [-122.894251355141, 49.08860877358555], [-122.89422462399249, 49.08861908020901], [-122.89420519397534, 49.088626758302304], [-122.89419715402303, 49.08862969917792], [-122.89416968501551, 49.08863986003546], [-122.89415680459129, 49.088644740957506], [-122.89414221603343, 49.088650003647956], [-122.89411474673946, 49.08866028866991], [-122.89410833900482, 49.08866272352248], [-122.89408727765876, 49.08867046808218], [-122.89406086811498, 49.088680706979915], [-122.89405980758887, 49.08868110714053], [-122.89403233803297, 49.088691499176335], [-122.89401418261403, 49.08869869113888], [-122.89400486757697, 49.088702308658014], [-122.89397739684314, 49.08871324303041], [-122.89396894568183, 49.08871667660951], [-122.8939499257592, 49.08872433611553], [-122.89392534102326, 49.08873466356228], [-122.89392245370544, 49.088735878709564], [-122.89389498141199, 49.088747527790524], [-122.8938832450762, 49.08875265188545], [-122.89386750819888, 49.088759602331066], [-122.8938432901962, 49.088770642162224], [-122.89384003395195, 49.088772155529426], [-122.8938125590423, 49.08878501298646], [-122.89380495167005, 49.08878863391212], [-122.89378508312598, 49.088798335730914], [-122.89376843865072, 49.08880662732919], [-122.89375760600839, 49.08881221458278], [-122.89373389036004, 49.08882462254336], [-122.89373012759462, 49.08882669361151], [-122.893702647628, 49.088841892566435], [-122.89370133163486, 49.08884261957925], [-122.89367516551954, 49.088858086722084], [-122.89367088904943, 49.08886061855515], [-122.89364768088993, 49.08887545290745], [-122.89364270422716, 49.08887861960321], [-122.89362019366665, 49.0888940241525], [-122.89361636147585, 49.08889662234198], [-122.89359270392865, 49.08891376256712], [-122.89359149552045, 49.088914626436], [-122.89356787108117, 49.08893263166931], [-122.893565211289, 49.088934848287046], [-122.89354578117407, 49.0889506383129], [-122.8935377141699, 49.0889580182042], [-122.89352572381996, 49.088968646827], [-122.89351020999534, 49.088984475234035], [-122.89350799087167, 49.088986657481904], [-122.89349206331444, 49.08900466979982], [-122.8934826926481, 49.0890170764445], [-122.89347826122362, 49.089022684076866], [-122.8934659381258, 49.08904069971717], [-122.89345602070256, 49.08905871757649], [-122.89345514989215, 49.08906153557563], [-122.89345006221042, 49.08907673908918], [-122.89344808676945, 49.08909476427812], [-122.89344895168894, 49.089112792088784], [-122.89345352588388, 49.089130823323075], [-122.89345499518784, 49.08913383652517], [-122.89346246311045, 49.089148858583975], [-122.89347787448293, 49.089166899818544], [-122.89348236426068, 49.089170587669884], [-122.89350091934585, 49.08918494809385], [-122.89350976970601, 49.08919035034271], [-122.89353222569602, 49.089203003984466], [-122.89353718552003, 49.089205273674914], [-122.89356460873414, 49.08921674271182], [-122.89357632317142, 49.08922107165982], [-122.89359203678326, 49.08922595512124], [-122.8936194684929, 49.08923345890336], [-122.89364384519601, 49.089239160902856], [-122.89364690268266, 49.089239805386306], [-122.89367433903989, 49.089245140092146], [-122.89370177683487, 49.08924980406377], [-122.89372921584392, 49.08925390158712], [-122.89375480947939, 49.089257290098224], [-122.89375665585285, 49.08925753260166], [-122.89378409636133, 49.089260931308175], [-122.89381153751236, 49.089264030475874], [-122.89383897925421, 49.089266854118534], [-122.89386642160522, 49.089269393430136], [-122.89389386463395, 49.08927161601365], [-122.89392130839839, 49.08927349439975], [-122.89394875287984, 49.089275037113815], [-122.8939586802542, 49.08927550457023], [-122.8939761978074, 49.08927637109843], [-122.89400364307458, 49.0892775462451], [-122.89403108864023, 49.08927858174482], [-122.89405853444515, 49.08927950531977], [-122.89408598047858, 49.089280321945665], [-122.89411342675339, 49.08928102547494], [-122.89414087328879, 49.08928160679947], [-122.8941683201051, 49.08928205625427], [-122.89419576722486, 49.089282363140484], [-122.89422321467349, 49.089282515366115], [-122.89425066247817, 49.08928250001134], [-122.89427811066614, 49.089282304131025], [-122.8943055592641, 49.08928191499788], [-122.89433300829937, 49.08928131959221], [-122.89436045780177, 49.089280503681806], [-122.89438790780565, 49.08927945091192], [-122.89441535835151, 49.0892781420026], [-122.89444280948803, 49.08927655378716], [-122.8944514367611, 49.089275956175506], [-122.89447026084612, 49.08927486019739], [-122.89449771260193, 49.089272978002874], [-122.89452516502526, 49.0892707797152], [-122.89455261820098, 49.08926822498662], [-122.89458007221863, 49.08926527125744], [-122.89460752717359, 49.089261873138824], [-122.89463417487505, 49.08925809610638], [-122.89463498312848, 49.08925800071354], [-122.8946624385361, 49.08925438496236], [-122.89468989491418, 49.08925030845927], [-122.89471735243114, 49.089245691194684], [-122.89474481130247, 49.08924043080021], [-122.89474604786373, 49.0892401711548], [-122.89477226925197, 49.089235603863415], [-122.89479972847163, 49.08923017322433], [-122.89482718929429, 49.08922398080672], [-122.8948344301893, 49.089222224696314], [-122.89485464934639, 49.08921815007362], [-122.89488210988995, 49.08921208348185], [-122.89490957176672, 49.08920538202268], [-122.89491418949119, 49.0892042703205], [-122.89493703154365, 49.08919967225822], [-122.89496449150104, 49.08919387395596], [-122.8949919522503, 49.089187697127436], [-122.89499823261005, 49.08918631978626], [-122.89501941106222, 49.08918243595506], [-122.89504686980551, 49.08917720460426], [-122.89507432897358, 49.08917176893003], [-122.89509194814042, 49.089168377981515], [-122.89510178718528, 49.08916678436886], [-122.89512924375053, 49.089162578959254], [-122.89515669962488, 49.089158699473884], [-122.8951841536941, 49.08915567548016], [-122.89521160477744, 49.089154068751476], [-122.89523905139858, 49.08915458210235], [-122.89526649271716, 49.08915761670552], [-122.89529392993398, 49.089162603521224], [-122.89532136538753, 49.089168431706945], [-122.89532219026042, 49.089168586997125], [-122.89534880011175, 49.089174609948856], [-122.8953762392969, 49.08917866836258], [-122.89540367931959, 49.08918233016633], [-122.89543111807373, 49.08918659796738], [-122.89543191337616, 49.08918671345498], [-122.8954585557017, 49.08919140440088], [-122.8954859957846, 49.08919504374931], [-122.89551343713315, 49.089198081854946], [-122.8955408787068, 49.08920101426484], [-122.8955683206753, 49.08920375993379], [-122.89558121277847, 49.08920487561461], [-122.89559576287598, 49.08920639631615], [-122.89562320573556, 49.089208719764876], [-122.89565064970769, 49.089210513534155], [-122.8956780947318, 49.08921180612593], [-122.89570554078402, 49.0892126085543], [-122.89573298787597, 49.089212914864156], [-122.89576043605058, 49.08921270416949], [-122.89578788538286, 49.08921194021029], [-122.8958153359808, 49.08921057095928], [-122.89584278798333, 49.08920852949504], [-122.89587024155877, 49.0892057348057], [-122.89587495543327, 49.08920514095066], [-122.89589769625634, 49.08920240190878], [-122.89592515270117, 49.08919823130475], [-122.89595261121491, 49.08919306837071], [-122.89597854340288, 49.089187207331015], [-122.89598007189537, 49.08918686553073], [-122.89600753379023, 49.089180077925064], [-122.89603499809272, 49.08917213361742], [-122.89604415876359, 49.089169239428124], [-122.8960624640662, 49.089163384572636], [-122.89608993233304, 49.08915353194142], [-122.89609586011785, 49.08915125896463], [-122.89611740273543, 49.089142650453525], [-122.89613859974192, 49.089133270415054], [-122.89614487622043, 49.08913028524295], [-122.89617235338198, 49.08911615029401], [-122.89617396402485, 49.08911527521624], [-122.89619983599121, 49.08909939455937], [-122.89620308842383, 49.08909727439591], [-122.89622649907881, 49.08907926843182], [-122.89622732722277, 49.0890784926468], [-122.89624528826003, 49.08906125830916], [-122.8962548358364, 49.08904923692036], [-122.8962595876901, 49.08904324414857], [-122.896270450486, 49.08902522689807], [-122.89627785810839, 49.08900720654195], [-122.89628232780274, 49.08898918354564], [-122.89628241012255, 49.08898843689526], [-122.89628443679825, 49.08897115842808], [-122.89628415816739, 49.08895313116523], [-122.89628251026801, 49.088940357876865], [-122.89628190085999, 49.0889351021245], [-122.89627825766358, 49.08891707183842], [-122.89627332898635, 49.08889904039708], [-122.89626729881935, 49.08888100796564], [-122.89626031626325, 49.08886297467794], [-122.8962552486598, 49.08885109608373], [-122.89625282646152, 49.08884494093387], [-122.89624535417734, 49.088826907205004], [-122.89623761957166, 49.0888088732398], [-122.8962297728678, 49.08879083917324], [-122.8962279355994, 49.0887865700407], [-122.89622242553968, 49.08877280555505], [-122.896215029518, 49.08875477189255], [-122.89620719314071, 49.088736737833585], [-122.89620062115945, 49.08872273967966], [-122.8961988394784, 49.08871870330886], [-122.89619015572389, 49.08870066848663], [-122.89618012483221, 49.08868263245212], [-122.89617327960701, 49.08867194577164], [-122.89616875155622, 49.08866459520923], [-122.89615586537333, 49.08864655660416], [-122.89614590986109, 49.088634696391885], [-122.89614082582023, 49.088628516060204], [-122.89612373798563, 49.08861047367105], [-122.8961185231811, 49.088605583805254], [-122.89610457816337, 49.08859242941447], [-122.89609112687569, 49.08858109918041], [-122.89608318136617, 49.08857438314091], [-122.89606372512046, 49.088559238400116], [-122.89606001904924, 49.088556335273594], [-122.89603632060212, 49.08853871255872], [-122.89603575604819, 49.08853828641028], [-122.89601145639026, 49.08852023750878], [-122.89600891574905, 49.088518357810585], [-122.89598789479125, 49.08850218926714], [-122.89598151263496, 49.088497181317884], [-122.89596589368871, 49.08848414242701], [-122.89595411410362, 49.08847382272805], [-122.89594603791497, 49.08846609751647], [-122.8959284318393, 49.088448054630724], [-122.89592672457366, 49.0884461696436], [-122.89591335766255, 49.08843001402526], [-122.89589934689081, 49.08841286419218], [-122.89589867536056, 49.08841197377115], [-122.89588554953674, 49.088393934918976], [-122.8958725602552, 49.088375896188424], [-122.89587197869906, 49.08837503753389], [-122.89586160460908, 49.08835785929099], [-122.89585125704978, 49.088339822941094], [-122.8958446306849, 49.08832758412627], [-122.8958418575088, 49.08832178744562], [-122.89583369286093, 49.08830375306369], [-122.8958257148977, 49.08828571884958], [-122.89581780105952, 49.08826768469275], [-122.89581731115355, 49.08826654196397], [-122.8958107523643, 49.08824965131619], [-122.89580355723899, 49.08823161780695], [-122.89579605840487, 49.08821358402306], [-122.89579000400018, 49.08819961710524], [-122.89578836237968, 49.08819555006059], [-122.89578084161461, 49.08817751625579], [-122.89577274649078, 49.08815948193185], [-122.89576400411839, 49.088141447022835], [-122.89576268409843, 49.08813881729326], [-122.89575524335388, 49.08812341209647], [-122.89574580484593, 49.0881053765573], [-122.89573550334262, 49.08808734023781], [-122.89573534530508, 49.0880870716735], [-122.8957250416861, 49.08806930377268], [-122.89571358403475, 49.08805126640673], [-122.89570799061957, 49.088042941056706], [-122.89570144114452, 49.088033228420436], [-122.89568846423187, 49.08801518967918], [-122.89568062311446, 49.088004952841686], [-122.8956745083343, 49.08799715005164], [-122.89565953580944, 49.08797910950341], [-122.89565324528967, 49.087971909214225], [-122.89564334436075, 49.08796106785125], [-122.89562585843845, 49.08794318933064], [-122.89562568669454, 49.08794302487104], [-122.895606311985, 49.087924980335266], [-122.89559846411908, 49.087918046521224], [-122.89558464808889, 49.08790693372553], [-122.89557106239175, 49.08789644930413], [-122.89555998126065, 49.087888884394786], [-122.8955436539655, 49.087878056876704], [-122.89553091589406, 49.08787083107807], [-122.8955162393138, 49.08786264108105], [-122.89549470393617, 49.08785277128425], [-122.89548881867891, 49.08785008415639], [-122.89546139278644, 49.087840038194656], [-122.89544163448491, 49.087834696211], [-122.89543396146941, 49.087832580776315]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.7499700390067146, "info": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.89532293891907, 49.08841991803592], [-122.89529550251969, 49.088414735656265], [-122.89526805816536, 49.08841333817227], [-122.8952406067435, 49.08841530078771], [-122.8952131483046, 49.088420596893485], [-122.89518603039515, 49.08842935590811], [-122.89518568235493, 49.088429458419405], [-122.89515821196937, 49.088440422140806], [-122.89514441734211, 49.088447345130454], [-122.89513073621676, 49.088453928537504], [-122.89511012462252, 49.08846534098963], [-122.8951032570546, 49.088469046373056], [-122.89507870198922, 49.08848333944728], [-122.89507577607003, 49.08848502115882], [-122.89504848534695, 49.088501338992806], [-122.89504829410264, 49.08850145388861], [-122.89502081066425, 49.08851857574218], [-122.8950196482827, 49.088519339785016], [-122.8949936677141, 49.08853734316843], [-122.89499332319676, 49.088537599241654], [-122.89497169599038, 49.088555350193474], [-122.89496582648663, 49.08856099453793], [-122.89495359263807, 49.0885733607346], [-122.89493831501505, 49.08859137384465], [-122.89493831501505, 49.08859137384465], [-122.89492312281841, 49.088609387030395], [-122.89491079456735, 49.088625990397624], [-122.894909658512, 49.08862740178715], [-122.89489477352141, 49.08864541524874], [-122.89488327695679, 49.08865924483981], [-122.89487932783419, 49.08866342819777], [-122.89485996442005, 49.08868143757638], [-122.89485577571848, 49.088684728252254], [-122.89483493077717, 49.088699441786076], [-122.89482828892407, 49.08870335974045], [-122.89480305974206, 49.088717439759506], [-122.89480080944504, 49.08871851887203], [-122.89477333499597, 49.08873128984822], [-122.89476453265816, 49.088735431656346], [-122.89474586156346, 49.088743573240514], [-122.89472459835599, 49.08875342225689], [-122.89471838725848, 49.08875626285217], [-122.89469091220747, 49.08876929859461], [-122.89468654382729, 49.08877141455856], [-122.89466343568226, 49.08878302441561], [-122.89465121935207, 49.08878940933917], [-122.89463595644689, 49.08879802386852], [-122.89461958811708, 49.088807407480544], [-122.89460847392472, 49.0888145684076], [-122.89459149103114, 49.088825408840435], [-122.89458098671865, 49.088833316734686], [-122.89456710379899, 49.088843413581884], [-122.89455349182502, 49.08885568551101], [-122.89454674745556, 49.08886142200056], [-122.89453011555653, 49.08887943381856], [-122.89452598069663, 49.088885707007755], [-122.89451735788519, 49.0888974491744], [-122.89450902290919, 49.088915468570555], [-122.89450602048653, 49.088933492839494], [-122.89450983533641, 49.08895152333848], [-122.8945215373628, 49.08896956104443], [-122.89452579529909, 49.088973232610684], [-122.89454391561046, 49.08898760850292], [-122.89455320195692, 49.08899256698328], [-122.89458062343536, 49.08900491103471], [-122.89458257420947, 49.08900567082569], [-122.89460805218015, 49.08901382841899], [-122.89463548483067, 49.089020904643434], [-122.89464867258266, 49.08902375818151], [-122.89466292023045, 49.08902668496609], [-122.89469035775124, 49.089031465398655], [-122.89471779726838, 49.0890353041463], [-122.89474523848173, 49.089038342449534], [-122.89477268128006, 49.08904063231601], [-122.89479476514839, 49.08904191843226], [-122.89480012546022, 49.0890422693255], [-122.8948275707126, 49.08904339955246], [-122.89485501755445, 49.089043777627616], [-122.89488246599753, 49.08904339740464], [-122.8949099161637, 49.08904220054374], [-122.89491215691714, 49.08904202536111], [-122.89493736712885, 49.0890406243834], [-122.89496481944927, 49.08903840490986], [-122.89499227349745, 49.08903536497926], [-122.8950197297648, 49.08903127087674], [-122.8950471890926, 49.08902572263008], [-122.89505349233116, 49.08902412692877], [-122.89507464809274, 49.08902032696265], [-122.89510210964264, 49.08901371814495], [-122.89512482340719, 49.089006164744156], [-122.8951295756467, 49.089004990954436], [-122.89515704120795, 49.08899646950573], [-122.89517738075752, 49.08898818546916], [-122.8951845115551, 49.088985669979834], [-122.89521197641548, 49.08897747202891], [-122.89523942555655, 49.088976741350955], [-122.89526686079196, 49.08898262155623], [-122.89529429740332, 49.08898785046897], [-122.89529747217911, 49.08898829445763], [-122.89532173420895, 49.08899298972594], [-122.8953491744461, 49.08899649892647], [-122.89537661769297, 49.088998577508804], [-122.89540406325528, 49.088999554926794], [-122.8954315112832, 49.088999358748126], [-122.89545896200514, 49.08899787929198], [-122.89548641582267, 49.08899492420802], [-122.89551387338426, 49.08899018330133], [-122.89552134272745, 49.08898849729686], [-122.89554133387365, 49.08898404426169], [-122.89556879946701, 49.08897546835744], [-122.89558140474125, 49.08897052463003], [-122.89559627149073, 49.08896382107735], [-122.8956168114616, 49.08895252963975], [-122.89562375319233, 49.088947550701754], [-122.89564037574895, 49.08893452393294], [-122.89565125559402, 49.088921393915385], [-122.89565532356491, 49.08891651043295], [-122.89566477717491, 49.08889849196522], [-122.89566902684221, 49.08888046879337], [-122.89566939708087, 49.08886244211516], [-122.89566660685449, 49.088844412580414], [-122.89566090620794, 49.08882638041489], [-122.8956523535675, 49.08880834567102], [-122.89565149554986, 49.08880688941111], [-122.89564294209488, 49.08879031015005], [-122.89563100670449, 49.08877227234631], [-122.89562413905493, 49.0887634692948], [-122.89561762272781, 49.08875423323139], [-122.89560278865616, 49.08873619280345], [-122.89559676266035, 49.088729562890876], [-122.89558738803477, 49.08871815186107], [-122.89557110531439, 49.08870011011859], [-122.89556938098991, 49.08869818987768], [-122.89555692251957, 49.08868207027374], [-122.89554257914718, 49.08866403028179], [-122.89554200678359, 49.08866327519875], [-122.89553102230128, 49.08864599280983], [-122.89551893694096, 49.088627954858325], [-122.89551464701671, 49.08862149738615], [-122.89550826674059, 49.08860991818648], [-122.89549816582345, 49.08859188202897], [-122.8954873992979, 49.0885738452679], [-122.89548729997657, 49.08857367783013], [-122.89547789580291, 49.08855580964938], [-122.8954669364713, 49.0885377727117], [-122.89545994977156, 49.088527390755516], [-122.89545491445487, 49.08851973481048], [-122.89544153119228, 49.08850169567498], [-122.895432578574, 49.08849112446142], [-122.89542571859415, 49.088483654337104], [-122.89540685176274, 49.088465610229676], [-122.89540518797499, 49.08846411363715], [-122.89538298547227, 49.08844756158825], [-122.8953777830189, 49.088443950197615], [-122.89535036554376, 49.088429754177035], [-122.89534964978996, 49.08842950435752], [-122.89532293891907, 49.08841991803592]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.49991531039953774, "info": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.89526757586698, 49.088642645945086], [-122.89524013577078, 49.08863916516208], [-122.89521268309515, 49.088641663876814], [-122.89519902412327, 49.08864569187274], [-122.89518521992392, 49.08864914745068], [-122.89515774582966, 49.08866181495343], [-122.8951546779597, 49.0886636786168], [-122.89513026161515, 49.0886792811328], [-122.89512704547857, 49.088681680529405], [-122.89510542150963, 49.088699687895385], [-122.89510276566811, 49.08870230754607], [-122.89508673469825, 49.08871769792675], [-122.89507525924837, 49.088730291941985], [-122.89506950608526, 49.08873570928055], [-122.8950483997459, 49.08875371710621], [-122.89504776150463, 49.08875414533403], [-122.89502027817304, 49.088771150227956], [-122.89501931584945, 49.088771717673154], [-122.89499279962968, 49.08878587564212], [-122.89498590106408, 49.08878971429289], [-122.89496531769859, 49.08880219937315], [-122.89495640767362, 49.08880771447136], [-122.89493782721046, 49.08882257015855], [-122.89493365510742, 49.08882572077778], [-122.8949169183182, 49.08884373255613], [-122.89491030554608, 49.088857702379784], [-122.89490791862613, 49.08886175137612], [-122.89490605156116, 49.088879776689225], [-122.8949102420829, 49.08888777280317], [-122.89491536331376, 49.08889781217929], [-122.89493763485052, 49.088913738872435], [-122.89494126894515, 49.088915862772], [-122.89496505829935, 49.088925173407034], [-122.89499249108238, 49.088932187687945], [-122.89500277887913, 49.08893394574924], [-122.89501992873214, 49.08893689725629], [-122.89504737063052, 49.0889395935529], [-122.89507481717241, 49.0889400875979], [-122.8951022688694, 49.08893813483531], [-122.89512248239663, 49.08893405456695], [-122.89512972689282, 49.0889331771608], [-122.89515718936205, 49.088926105386626], [-122.89517488561546, 49.08891607515286], [-122.89518466967836, 49.08891055140555], [-122.89519866820696, 49.088898069734334], [-122.89520570921954, 49.0888800491137], [-122.89520522606013, 49.088862021662194], [-122.89520341043557, 49.08884399300097], [-122.89519657579686, 49.08882595978301], [-122.89521230653142, 49.088820604530525], [-122.89523975187818, 49.088821636241306], [-122.89526397489216, 49.08882602095499], [-122.895262305513, 49.08884404645332], [-122.89525556750284, 49.08886206735245], [-122.89525591456581, 49.08888009468025], [-122.89526705012084, 49.08889260756987], [-122.89528124166748, 49.08889814467176], [-122.89529447560196, 49.08890310603899], [-122.89532191805445, 49.08890553695739], [-122.89534937145571, 49.08890275959704], [-122.8953661550461, 49.08889822167111], [-122.89537683564828, 49.08889484477767], [-122.89540283242907, 49.08888022789798], [-122.89540431727889, 49.08887862420764], [-122.89541874385596, 49.08886221530158], [-122.89542335860251, 49.08884419246941], [-122.89542080205648, 49.08882616314035], [-122.89541258999215, 49.088808128687226], [-122.89540449086066, 49.08879598823327], [-122.89540146209205, 49.0887900915914], [-122.89539182136248, 49.08877205584214], [-122.89538178658565, 49.088754019734886], [-122.89537714811945, 49.08874612749509], [-122.89537278814815, 49.08873598456603], [-122.89536306490461, 49.08871794873939], [-122.89534979777677, 49.088699909699145], [-122.89534979777677, 49.088699909699145], [-122.89533518375764, 49.0886818694361], [-122.89532241327649, 49.08866996456183], [-122.89531365426417, 49.088663822899804], [-122.89529500343542, 49.088652086382126], [-122.89527625492602, 49.08864576196321], [-122.89526757586698, 49.088642645945086]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "3", "type": "Feature", "properties": {"index": "DSM", "name": "Delta Salt Marsh", "Zm": 1.83, "bearing": 195, "lat": 49.088835, "lon": -122.895226, "canopy_height": 0.16, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/DeltaSaltMarsh.html#", "info": "https://ubc-micromet.github.io/Data.html#delta-salt-marsh"}, "geometry": {"type": "Point", "coordinates": [-122.895226, 49.088835]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "3", "type": "Feature", "properties": {"index": "DSM", "name": "Delta Salt Marsh", "Zm": 1.83, "bearing": 195, "lat": 49.088835, "lon": -122.895226, "canopy_height": 0.16, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/DeltaSaltMarsh.html#", "info": "https://ubc-micromet.github.io/Data.html#delta-salt-marsh"}, "geometry": {"type": "Point", "coordinates": [-122.895226, 49.088835]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>