<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-122.895226, 49.088835], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.8999971970533551, "Contour_Level": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.89535163203146, 49.087827118025416], [-122.89532419747837, 49.08782121123637], [-122.89529675663667, 49.08781829836092], [-122.89526930931969, 49.087818465782135], [-122.89524185534991, 49.08782179547062], [-122.8952143945534, 49.08782836759288], [-122.89519722071813, 49.08783447456663], [-122.8951869273007, 49.08783800354616], [-122.89515945428032, 49.08785037393024], [-122.89515557993472, 49.087852463769586], [-122.89513197653102, 49.087864983318134], [-122.89512292675347, 49.087870461123444], [-122.89510449472958, 49.087881508666705], [-122.89509383806079, 49.08788846170746], [-122.89507701006016, 49.08789938648781], [-122.89506661474667, 49.08790646397979], [-122.89504952366904, 49.087918071827055], [-122.89504027505976, 49.087924467049106], [-122.89502203663935, 49.08793705026999], [-122.89501413284512, 49.087942470291935], [-122.89499454999105, 49.08795583792201], [-122.89498757324965, 49.08796047314912], [-122.89496706471013, 49.087973967450374], [-122.89495987872372, 49.0879784749674], [-122.89493958175618, 49.08799098458109], [-122.89493002843356, 49.087996474816805], [-122.89491210195769, 49.08800649759738], [-122.89489646976142, 49.088014471282], [-122.89488462576895, 49.088020292466396], [-122.89485715302881, 49.08803244686651], [-122.89485711334852, 49.08803246245668], [-122.89482968409517, 49.08804279263861], [-122.8948081420929, 49.08805044485661], [-122.89480221653392, 49.088052483373446], [-122.89477474957502, 49.088061884000496], [-122.89475734437407, 49.088068425570505], [-122.89474728057368, 49.08807224599716], [-122.89471980738784, 49.08808458177939], [-122.89471637263125, 49.08808641522434], [-122.89469232732225, 49.08810016426843], [-122.89468617028164, 49.088104414689276], [-122.89466483672919, 49.08812071529074], [-122.89466291033236, 49.08812242048159], [-122.89464425247314, 49.08814043046954], [-122.89463733187867, 49.08814799378896], [-122.89462851636948, 49.08815844312149], [-122.89461495649785, 49.08817645775806], [-122.8946098084686, 49.0881840271594], [-122.89460287417246, 49.08819447374204], [-122.8945919969767, 49.08821249082518], [-122.89458239065284, 49.08823050906782], [-122.89458226235405, 49.08823076640719], [-122.89457326987801, 49.08824852775307], [-122.89456526412806, 49.08826654745597], [-122.89455834961555, 49.08828456815504], [-122.8945546778854, 49.08829559339859], [-122.89455227480497, 49.088302589620724], [-122.89454687443562, 49.08832061170212], [-122.89454233382358, 49.088338634568686], [-122.89453846769142, 49.088356658051204], [-122.89453504729536, 49.08837468194079], [-122.8945318017394, 49.08839270598997], [-122.89452841629075, 49.08841072991118], [-122.89452697270535, 49.08841737560597], [-122.89452412924929, 49.088428753008415], [-122.89451847719776, 49.08844677485814], [-122.8945111393336, 49.088464795166985], [-122.89450154892316, 49.088482813416675], [-122.89449938005005, 49.08848598362641], [-122.89448742361681, 49.0885008275205], [-122.89447186839413, 49.088516335208034], [-122.8944689902025, 49.08851883768413], [-122.89444437763451, 49.0885368133525], [-122.894444334117, 49.0885368421548], [-122.89441689672029, 49.088552637585806], [-122.894412841901, 49.08855484036741], [-122.89438942064761, 49.08856617082717], [-122.89437532672981, 49.08857283306045], [-122.89436194702051, 49.08857854423277], [-122.89433447474461, 49.088590274477184], [-122.89433316470439, 49.08859082148767], [-122.89430700505665, 49.08860077936349], [-122.8942864419519, 49.08860880572288], [-122.89427953539327, 49.08861126721894], [-122.89425206718595, 49.088621063983396], [-122.89423636045782, 49.08862678686186], [-122.89422459929321, 49.08863070756267], [-122.8941971321236, 49.08864000581645], [-122.8941833370363, 49.08864476528228], [-122.89416966539315, 49.08864909260618], [-122.89414219908026, 49.08865797825634], [-122.8941277998793, 49.08866274137285], [-122.89411473304384, 49.0886667292848], [-122.8940872673664, 49.08867530698485], [-122.89407046984124, 49.088680715791405], [-122.89405980160721, 49.08868391866858], [-122.89403233625298, 49.088692335594175], [-122.8940124431721, 49.088698689541815], [-122.89400487039818, 49.088700983320294], [-122.89397740494326, 49.08870943874453], [-122.89395510323747, 49.08871666389389], [-122.8939499386379, 49.08871828910163], [-122.8939224725249, 49.08872704456944], [-122.89389992072385, 49.088734640200414], [-122.89389500534512, 49.08873629615556], [-122.8938675378705, 49.08874568126109], [-122.89384820373695, 49.0887526196674], [-122.89384006918058, 49.08875563154705], [-122.89381259950001, 49.08876604123638], [-122.89380092110981, 49.08877060319082], [-122.89378512831887, 49.08877714900559], [-122.8937585985094, 49.08878859125994], [-122.89375765547109, 49.088789032152704], [-122.89373018047135, 49.08880191749415], [-122.89372046987033, 49.088806583174886], [-122.89370270299948, 49.0888159542215], [-122.89368659138276, 49.08882457899158], [-122.89367522272632, 49.088831295577805], [-122.89365621034251, 49.08884257802034], [-122.89364773925782, 49.08884812507734], [-122.8936286403129, 49.088860579631394], [-122.893620252251, 49.088866602082746], [-122.89360337797925, 49.08887858336283], [-122.89359276138761, 49.08888687423314], [-122.89358010993844, 49.08889658892725], [-122.8935652662226, 49.08890914837475], [-122.89355868589256, 49.088914596187266], [-122.89353899066936, 49.08893260503769], [-122.89353776586091, 49.088933841558536], [-122.89352062506522, 49.08895061511119], [-122.89351025796415, 49.08896204533737], [-122.89350407700013, 49.088968626858495], [-122.89348902875902, 49.088986639987276], [-122.89348273940824, 49.08899521738032], [-122.89347551703146, 49.089004654531955], [-122.89346354421751, 49.08902267049529], [-122.89345520132437, 49.08903749870153], [-122.89345331295004, 49.0890406880648], [-122.8934445728881, 49.08905870700984], [-122.89343797956643, 49.08907672793592], [-122.89343385325199, 49.089094751139065], [-122.89343274108573, 49.08911277712464], [-122.89343549557213, 49.08913080667972], [-122.89344337975929, 49.08914884096997], [-122.89345493242828, 49.089163167071845], [-122.89345809670876, 49.08916688156617], [-122.89348172218531, 49.08918493038118], [-122.89348233284011, 49.08918527576109], [-122.89350974987966, 49.0891996208971], [-122.89351689214928, 49.08920298984106], [-122.89353717329288, 49.08921099240713], [-122.89356460019386, 49.08922073808998], [-122.89356555812248, 49.089221061734655], [-122.8935920295994, 49.089229316791425], [-122.89361946074006, 49.089237087765824], [-122.89362724064151, 49.08923914560306], [-122.8936468939265, 49.089243904927436], [-122.8936743293535, 49.089249676333495], [-122.89370176697292, 49.08925442371682], [-122.89372186682954, 49.0892572597735], [-122.89372920668056, 49.089258195103355], [-122.89375664808097, 49.08926117507331], [-122.89378409061878, 49.08926362338899], [-122.89381153398857, 49.08926568283838], [-122.89383897794735, 49.08926746707965], [-122.89386642232442, 49.08926905601422], [-122.893893867021, 49.08927049582578], [-122.89392131200073, 49.089271803458495], [-122.8939487572718, 49.089272974992056], [-122.89397620286441, 49.08927399610456], [-122.8940036488103, 49.08927485180273], [-122.89403109512851, 49.08927553298886], [-122.89403321333663, 49.08927557301389], [-122.8940585417099, 49.08927609082857], [-122.89408598867114, 49.08927647037246], [-122.89411343599272, 49.089276680658806], [-122.89414088363841, 49.08927673861091], [-122.89416833156758, 49.08927666320741], [-122.89419577973872, 49.08927647389453], [-122.89422322811345, 49.08927618863847], [-122.89425067666214, 49.08927582131269], [-122.89425352890447, 49.08927577504814], [-122.89427812524194, 49.08927543915352], [-122.89430557394836, 49.089274997141935], [-122.8943330228363, 49.08927446936301], [-122.89436047197836, 49.089273821516365], [-122.89438792147756, 49.08927300495927], [-122.89441537145862, 49.08927196073203], [-122.89444282205478, 49.08927062580743], [-122.89447027339456, 49.0892689393082], [-122.89449772559428, 49.089266846075624], [-122.89452517875895, 49.089264296204746], [-122.89455263299058, 49.08926124117618], [-122.89457694518326, 49.08925804385463], [-122.89458008824857, 49.08925769976874], [-122.89460754334706, 49.089254231867805], [-122.89463499947118, 49.089250277479536], [-122.89466245672438, 49.089245787298545], [-122.89468991523972, 49.08924069799421], [-122.89469278473558, 49.089240122577124], [-122.89471737283178, 49.089236042706126], [-122.89474483120708, 49.089231014458065], [-122.89477229073455, 49.0892254383735], [-122.89478729862438, 49.08922218174814], [-122.89479975006131, 49.08921995437186], [-122.89482720867275, 49.089214806187584], [-122.894854668198, 49.08920922254541], [-122.89487777487447, 49.0892042371649], [-122.89488212808486, 49.089203464696496], [-122.89490958599859, 49.08919863874523], [-122.8949370445317, 49.089193516706516], [-122.89496450358509, 49.08918814535329], [-122.8949742716087, 49.08918629798844], [-122.89499196102882, 49.08918353445054], [-122.89501941746323, 49.08917939988476], [-122.89504687308454, 49.08917564892179], [-122.89507432655175, 49.089172918234475], [-122.8951017762804, 49.08917196075456], [-122.89512922126792, 49.08917325390024], [-122.89515666214659, 49.08917649915129], [-122.89518410133634, 49.08918054843265], [-122.89521154138484, 49.08918419177647], [-122.89523410874125, 49.0891865341022], [-122.89523898292003, 49.08918713038926], [-122.89526642541055, 49.089189616341876], [-122.8952938695788, 49.08919130575683], [-122.89532131428332, 49.089192740962574], [-122.89534875839425, 49.08919445933957], [-122.89537620130595, 49.08919674937028], [-122.89540364309106, 49.08919957691449], [-122.89543108424502, 49.08920270649137], [-122.89544839491782, 49.08920475539561], [-122.89545852468251, 49.0892061789596], [-122.89548596420022, 49.08921009146498], [-122.8955134043759, 49.089213692454194], [-122.89554084570187, 49.089216747026285], [-122.89556828834793, 49.08921917377209], [-122.89559573230478, 49.08922097664074], [-122.89562317748732, 49.089222195727196], [-122.89565062378188, 49.08922288482828], [-122.89566246067932, 49.08922297609193], [-122.89567807103168, 49.089223118337344], [-122.89569069052139, 49.08922300160437], [-122.89570551926235, 49.089222883687846], [-122.89573296829856, 49.089222264198135], [-122.89576041818347, 49.08922123898321], [-122.89578786897934, 49.08921977796777], [-122.89581532080011, 49.08921782633267], [-122.89584277379042, 49.089215314562345], [-122.89587022810798, 49.08921216679047], [-122.8958976839454, 49.08920829038421], [-122.89591617951518, 49.08920517812833], [-122.8959251412223, 49.08920372324156], [-122.89595259983024, 49.08919851669101], [-122.89598006071613, 49.089192216943516], [-122.89599877897045, 49.08918722556401], [-122.89600752381958, 49.08918485206169], [-122.89603498910401, 49.08917643871648], [-122.89605527855231, 49.08916924944159], [-122.89606245746627, 49.089166546423336], [-122.8960899291695, 49.08915504789712], [-122.89609812948298, 49.08915126100728], [-122.89611740552996, 49.089141310965054], [-122.89613156677366, 49.089133264087], [-122.8961448884431, 49.08912442504762], [-122.89615779712062, 49.08911526067408], [-122.89617238157587, 49.08910262905868], [-122.89617835280124, 49.089097252151475], [-122.89619465077165, 49.089079239796504], [-122.89619989304265, 49.08907202654713], [-122.89620781215359, 49.089061224619], [-122.89621865597569, 49.08904320735636], [-122.89622743831171, 49.08902518823946], [-122.89622743831171, 49.08902518823946], [-122.89623487736294, 49.089007167914346], [-122.89623969903961, 49.088989145236084], [-122.8962414583605, 49.08897111980501], [-122.89624030817217, 49.08895309175864], [-122.89623715840457, 49.088935061914825], [-122.89623334305064, 49.08891703147258], [-122.89622993105554, 49.08889900139274], [-122.89622773026038, 49.088885100163], [-122.89622713815358, 49.08888097186929], [-122.89622440559829, 49.08886294239997], [-122.89622081444062, 49.08884491215862], [-122.89621641063441, 49.088826881186485], [-122.8962120244295, 49.088808850229945], [-122.89620861871039, 49.088790820154784], [-122.89620656507569, 49.088772791295185], [-122.89620547536168, 49.088754763302234], [-122.89620456736627, 49.0887367354726], [-122.89620307821309, 49.08871870712033], [-122.89620066399335, 49.088702191499074], [-122.896200459387, 49.0887006777522], [-122.89619666308879, 49.08868264732512], [-122.89619116438999, 49.08866461536694], [-122.89618369997712, 49.08864658164057], [-122.89617398810871, 49.08862854589226], [-122.8961733720952, 49.088627589135946], [-122.89616265501853, 49.088610508684745], [-122.89614852878475, 49.088592468963235], [-122.8961460037383, 49.08858968540446], [-122.89613216758677, 49.08857442722893], [-122.89611861440576, 49.088561856096725], [-122.89611262892257, 49.08855638263267], [-122.89609121383579, 49.08853942661547], [-122.89608979681573, 49.08853833506848], [-122.89606380599153, 49.08852049397421], [-122.89606348916371, 49.088520284370404], [-122.89603639346991, 49.08850381159496], [-122.89603369747847, 49.08850223052843], [-122.89600897832652, 49.08848839342118], [-122.89600136268201, 49.08848417438754], [-122.89598156288373, 49.088473126676085], [-122.8959696393661, 49.088466118788624], [-122.89595415069216, 49.088456311992736], [-122.89594259017191, 49.08844806739447], [-122.89592674703671, 49.088435421965855], [-122.8959207803265, 49.08843002071798], [-122.8959021353273, 49.088411976891365], [-122.89589935453657, 49.08840920697451], [-122.89588499923356, 49.08839393442264], [-122.89587196790268, 49.08838020045791], [-122.8958682811351, 49.088375892328386], [-122.89585425605542, 49.08835785266132], [-122.89584459780204, 49.088343304903894], [-122.89584269314035, 49.088339815214155], [-122.89583464511794, 49.088321780937555], [-122.89582801683288, 49.0883037479416], [-122.89582227085894, 49.08828571574145], [-122.89581730608352, 49.08826896523437], [-122.89581696287749, 49.08826768393627], [-122.89581215236691, 49.088249652579805], [-122.89580692994667, 49.08823162085126], [-122.89580106428217, 49.08821358854181], [-122.89579434945115, 49.088195555465425], [-122.89579003408986, 49.08818523916784], [-122.89578680079765, 49.08817752163584], [-122.89577828471617, 49.08815948693225], [-122.8957683368432, 49.08814145093514], [-122.89576269773627, 49.088132302334444], [-122.89575703149299, 49.088123413711266], [-122.89574421487838, 49.08810537512131], [-122.89573533049636, 49.08809414412207], [-122.89572972485337, 49.08808733501833], [-122.89571363987703, 49.08806929347255], [-122.8957079479505, 49.08806331394036], [-122.89569608135899, 49.08805125059305], [-122.89568055705818, 49.088036484005265], [-122.89567702417048, 49.088033206356386], [-122.89565689564452, 49.08801516114813], [-122.89565316147164, 49.0880119082707], [-122.8956358629682, 49.08799711511888], [-122.8956257629597, 49.08798874111135], [-122.89561385140121, 49.08797906820053], [-122.89559836191403, 49.08796679458218], [-122.89559086931148, 49.087961020400094], [-122.89557095851767, 49.08794598047379], [-122.89556682377336, 49.087942971632934], [-122.89554355276098, 49.08792630247085], [-122.89554153088726, 49.087924921731975], [-122.89551614461152, 49.087907775155536], [-122.89551472309438, 49.0879068704542], [-122.8954887340149, 49.08789042352902], [-122.89548599897866, 49.08788881743512], [-122.89546132080686, 49.08787432491976], [-122.89545463183646, 49.08787076201515], [-122.89543390461776, 49.087859654372245], [-122.89541909271789, 49.08785270280695], [-122.89540648481723, 49.08784671086645], [-122.89537906067693, 49.08783583972743], [-122.89537518205438, 49.087834636000444], [-122.89535163203146, 49.087827118025416]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.7500283168957653, "Contour_Level": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.89532292280225, 49.08842758481286], [-122.89529549385267, 49.08841885746712], [-122.89526805609763, 49.08841432125868], [-122.89524061040976, 49.08841355811799], [-122.89521315711825, 49.08841640863587], [-122.89518569608539, 49.08842293540203], [-122.89516824601355, 49.088429339758626], [-122.89515822811939, 49.088432751647154], [-122.8951307547642, 49.08844512169807], [-122.89512651133025, 49.08844732886406], [-122.89510327820626, 49.08845900561353], [-122.89509186078035, 49.08846532439272], [-122.89507579926091, 49.088474015273995], [-122.89505945067444, 49.08848332194771], [-122.89504831906991, 49.088489608059966], [-122.89502864419622, 49.088501320951835], [-122.89502083701562, 49.088506076497715], [-122.89500101870865, 49.08851932284114], [-122.89499335003725, 49.08852487133694], [-122.89497806886192, 49.08853732897773], [-122.89496585180133, 49.08854899332792], [-122.89495980803807, 49.088555339376605], [-122.89494507616907, 49.08857335298424], [-122.89493833189141, 49.088583375192], [-122.89493288503654, 49.088591368902485], [-122.89492209533233, 49.08860938609511], [-122.89491297777866, 49.088627404808925], [-122.89491078230276, 49.08863180174204], [-122.89490283158942, 49.088645422585444], [-122.89489119145593, 49.088663439000754], [-122.89488324726783, 49.08867330868997], [-122.89487512313312, 49.08868145138219], [-122.89485575131869, 49.08869628354464], [-122.89485088867447, 49.08869945632316], [-122.89482827253703, 49.08871111832624], [-122.89481534969944, 49.08871745095881], [-122.89480079892827, 49.088723496813074], [-122.89477332637183, 49.088735370880265], [-122.89477316331295, 49.0887354395241], [-122.89474585693911, 49.08874576095075], [-122.89472720510324, 49.08875342463419], [-122.89471838600969, 49.08875685348141], [-122.89469091487193, 49.08876803873927], [-122.89468291206741, 49.08877141124518], [-122.8946634426764, 49.08877971817709], [-122.8946422319439, 49.0887894011367], [-122.89463596807744, 49.08879252736504], [-122.89460849067599, 49.08880665394892], [-122.89460704854288, 49.08880739603251], [-122.89458100823312, 49.08882315447922], [-122.89457730988792, 49.08882539589016], [-122.89455351783893, 49.088843401172305], [-122.89455351783893, 49.088843401172305], [-122.89453397792606, 49.08886141033451], [-122.89452601076073, 49.08887151381031], [-122.89451920073897, 49.08887942384546], [-122.89450824851725, 49.08889744085004], [-122.89450172729764, 49.08891546190319], [-122.89449981687076, 49.08893348716996], [-122.89450361270954, 49.08895151765178], [-122.89451532818305, 49.08896955537063], [-122.89452578405113, 49.0889785427266], [-122.8945371084476, 49.088987602284014], [-122.89455319362082, 49.08899650343586], [-122.8945727795523, 49.089005661880606], [-122.89458061605195, 49.089008398515986], [-122.89460804669, 49.089016422313236], [-122.89463548170373, 49.08902238239723], [-122.89464302673801, 49.08902375302872], [-122.89466291896026, 49.08902728538803], [-122.8946903577186, 49.08903148084202], [-122.89471779797904, 49.08903496803581], [-122.89474523967553, 49.08903777768353], [-122.89477268277925, 49.08903992290614], [-122.89480012727074, 49.08904141236032], [-122.89481695781167, 49.08904193865608], [-122.89482757298812, 49.08904232220921], [-122.89485502017861, 49.0890425348905], [-122.89487692726118, 49.08904199328394], [-122.8948824691686, 49.08904189526822], [-122.89490991934537, 49.08904069300068], [-122.89493737100086, 49.08903878927268], [-122.8949648242224, 49.089036142119696], [-122.89499227925344, 49.08903263553116], [-122.89501973659421, 49.089028031577826], [-122.8950379924233, 49.08902411283616], [-122.89504719537669, 49.089022741211544], [-122.8950746536135, 49.08901770701302], [-122.89510211569319, 49.08901084601167], [-122.8951170107896, 49.089006157645954], [-122.89512957939237, 49.08900321245921], [-122.89515704392608, 49.088995178563216], [-122.89517849366331, 49.08898818647975], [-122.8951845097871, 49.0889865098963], [-122.89521196553667, 49.088982641499854], [-122.89523940882913, 49.088984692092566], [-122.89525710953933, 49.08898825784061], [-122.89526684381245, 49.08899069421753], [-122.89529428026876, 49.08899599899261], [-122.89532172057022, 49.088999477458096], [-122.89534916297016, 49.08900195927992], [-122.89537660697434, 49.08900367889379], [-122.89540405356401, 49.08900416854252], [-122.89543150279803, 49.08900339926442], [-122.8954589545928, 49.08900140986359], [-122.89548640916918, 49.08899809416982], [-122.89551386713038, 49.08899316364841], [-122.89553224441583, 49.088988507163315], [-122.89554132962334, 49.088986070323664], [-122.8955687985453, 49.088975907842816], [-122.8955801230448, 49.088970523470635], [-122.89559627756284, 49.08896092506674], [-122.89560850492364, 49.088952522128196], [-122.89562377277248, 49.08893820975582], [-122.89562759553002, 49.08893451237821], [-122.89564171625861, 49.08891649813216], [-122.89565052270488, 49.08889847908051], [-122.89565130963621, 49.088895605595134], [-122.89565603977331, 49.08888045705484], [-122.89565773485478, 49.088862431574206], [-122.89565632917525, 49.088844403290686], [-122.89565190755465, 49.08882637228087], [-122.89565145735236, 49.088825116919836], [-122.8956463979144, 49.08880834028724], [-122.89563971605071, 49.08879030723355], [-122.89563167130353, 49.08877227294719], [-122.89562414893798, 49.088758754408374], [-122.89562192187113, 49.08875423711883], [-122.89561084172009, 49.0887362000862], [-122.89559678511901, 49.08871885140171], [-122.89559627382444, 49.08871815989806], [-122.89558141742489, 49.08870011944705], [-122.8955694042825, 49.0886870835565], [-122.89556544201065, 49.08868207798169], [-122.89555126539561, 49.08866403814169], [-122.89554202930164, 49.08865254098057], [-122.89553753270566, 49.0886459987016], [-122.8955244333272, 49.08862795983301], [-122.89551465967499, 49.088615464835584], [-122.89551092378572, 49.08860992059161], [-122.895498989081, 49.08859188277426], [-122.89548729770515, 49.088574760044594], [-122.89548674860029, 49.08857384467876], [-122.89547587265383, 49.08855580781747], [-122.89546319453386, 49.088537769323096], [-122.89545993703919, 49.088533455459405], [-122.89544947564768, 49.088519729884624], [-122.89543300705722, 49.08850168795368], [-122.89543255737011, 49.088501221695154], [-122.89541421039422, 49.088483643911054], [-122.89540516324696, 49.08847588599721], [-122.89539155852215, 49.08846559637175], [-122.89537775819817, 49.08845576360358], [-122.8953638558493, 49.08844754424973], [-122.8953503446669, 49.08843968791331], [-122.89532714306846, 49.088429483951266], [-122.89532292280225, 49.08842758481286]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.499740275630995, "Contour_Level": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.89526757182725, 49.08864456661955], [-122.89524013486745, 49.08863959452742], [-122.89521268507991, 49.08864072072376], [-122.89519268459733, 49.088645686117026], [-122.89518522396281, 49.088647228687634], [-122.89515775403265, 49.088657918971855], [-122.89514751270603, 49.08866367210863], [-122.89513027350208, 49.088673636955285], [-122.89511913425615, 49.08868167334177], [-122.89510277969195, 49.08869565047863], [-122.89509850408392, 49.088699681609384], [-122.89508209882284, 49.08871769371333], [-122.89507526637804, 49.08872690838705], [-122.89506774725763, 49.088735707681764], [-122.8950507036419, 49.08875371920085], [-122.8950477577137, 49.08875594393588], [-122.8950229793435, 49.08877172100481], [-122.89502027404795, 49.08877310684181], [-122.89499279772892, 49.08878677697349], [-122.89498700020197, 49.08878971529279], [-122.89496531988475, 49.08880116296247], [-122.89495358554737, 49.088807711903236], [-122.89493783431043, 49.08881920513137], [-122.89492860127208, 49.08882571617778], [-122.89491253571728, 49.08884372856647], [-122.8949103238697, 49.08884902020325], [-122.89490364350263, 49.08886174748396], [-122.89490334198526, 49.088879774222356], [-122.89491023255388, 49.08889228787439], [-122.89491314370314, 49.08889781015868], [-122.89493763037619, 49.088915859460435], [-122.89493763037619, 49.088915859460435], [-122.89496505601066, 49.088926258401656], [-122.89499248965927, 49.08893286251026], [-122.89499888572965, 49.08893394220805], [-122.8950199274035, 49.088937527443214], [-122.89504736975182, 49.08894001043992], [-122.89507481692412, 49.088940205426205], [-122.89510226947344, 49.088937848097665], [-122.89511951271824, 49.08893405186883], [-122.89512972788471, 49.08893270619567], [-122.89515719139543, 49.088925139659835], [-122.89517294215818, 49.08891607338802], [-122.89518467252104, 49.08890920095378], [-122.89519783139053, 49.08889806897459], [-122.89520566276427, 49.08888004907153], [-122.89520524426561, 49.08886202167873], [-122.89520355867609, 49.08884399313555], [-122.89519710315479, 49.088825960261794], [-122.89521230619883, 49.088820762577676], [-122.89523975235736, 49.088821408490716], [-122.89526398308863, 49.08882602096243], [-122.89526338772004, 49.08884404743523], [-122.89525533223637, 49.08886206713898], [-122.89525321870926, 49.088880092234035], [-122.89526704357942, 49.088895717605936], [-122.89527366040399, 49.08889813779403], [-122.89529447091273, 49.0889053360682], [-122.89532191501209, 49.088906984173036], [-122.89534936991718, 49.08890349163883], [-122.89536664010211, 49.08889822211077], [-122.89537683647168, 49.08889445288361], [-122.8953997675662, 49.08888022512083], [-122.89540432500814, 49.088874944601905], [-122.89541513074357, 49.08886221202814], [-122.89542036339887, 49.088844189755925], [-122.89541819624729, 49.08882616077955], [-122.89541102958644, 49.088808127273445], [-122.89540449015577, 49.088796323814556], [-122.89540189663701, 49.08879009198515], [-122.89539373361309, 49.08877205757502], [-122.8953848380728, 49.08875402250039], [-122.89537715869734, 49.08874109304648], [-122.89537479929196, 49.088735986388855], [-122.89536374297765, 49.088717949354034], [-122.89534979467015, 49.08870138787965], [-122.89534861102229, 49.08869990862327], [-122.89533206851422, 49.088681866611466], [-122.89532240637351, 49.08867324826406], [-122.89530893954843, 49.088663818624], [-122.89529499744796, 49.08865493383546], [-122.8952705650516, 49.08864575680116], [-122.89526757182725, 49.08864456661955]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "3", "type": "Feature", "properties": {"name": "DSM", "Zm": 1.83, "lat": 49.088835, "lon": -122.895226, "canopy_height": 0.16}, "geometry": {"type": "Point", "coordinates": [-122.895226, 49.088835]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "3", "type": "Feature", "properties": {"name": "DSM", "Zm": 1.83, "lat": 49.088835, "lon": -122.895226, "canopy_height": 0.16}, "geometry": {"type": "Point", "coordinates": [-122.895226, 49.088835]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>