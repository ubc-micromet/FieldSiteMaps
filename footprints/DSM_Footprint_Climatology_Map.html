<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add a polygon to a map using a GeoJSON source</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<!-- Import Turf Module - Needed to calculate bounding boxes -->
<script src='https://api.mapbox.com/mapbox.js/plugins/turf/v2.0.2/turf.min.js'></script>
<style>
    body { margin: 0; padding: 0; }
    #map { position: absolute; top: 0; bottom: 0; width: 100%; }

    /* Control the zoom to button */
    .btn-control {
        font: bold 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
        background-color: #3386c0;
        color: #fff;
        position: absolute;
        top: 20px;
        left: 50%;
        z-index: 1;
        border: none;
        width: 200px;
        margin-left: -100px;
        display: block;
        cursor: pointer;
        padding: 10px 20px;
        border-radius: 3px;
    }
    .btn-control:hover {
        background-color: #4ea0da;
    }
</style>
</head>
<body>
<button id="zoomto" class="btn-control">Zoom to Footprint</button>
<div id="map"></div>
<script>
	// Replace access token!
    mapboxgl.accessToken = 'pk.eyJ1IjoidWJjbWljcm9tZXQiLCJhIjoiY2xmMnJzYzlnMGFsYTNxcW1kYWhubjBiaSJ9.rhIOVatxQoS4M__qIFv6Pg';
  
    //  Custom mapStyle lest us use ESRI raster tiles
    const mapStyle = {
        version: 8,
        sources: {
        worldImagery: {
            type: "raster",
            tiles: ["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],
            tileSize: 256
            }
        },
        layers: [{
            id: "worldImagery",
            type: "raster",
            source: "worldImagery",
            minzoom: 0,
            maxzoom: 22
            }
        ]
    };

    //  Create the map - zoom and center are "arbitrary"
    const map = new mapboxgl.Map({
                container: 'map',
                zoom: 10,
                center: [-122.895226, 49.088835], // starting position
                style: mapStyle,
                });

    //  Locate the user
    var geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
        enableHighAccuracy: true
        },
        trackUserLocation: true,
        showUserHeading: true},);

    map.addControl(geolocate);
    map.addControl(new mapboxgl.NavigationControl());  

    var FP_Contour_Levels = {"type": "FeatureCollection", "features": [{"id": "2", "type": "Feature", "properties": {"r": 0.9, "r_true": 0.9000002034990511, "info": "90 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.89559902084036, 49.08765250853527], [-122.89557158966907, 49.087645021028166], [-122.89554414991343, 49.08764162977876], [-122.89551670340894, 49.08764145680186], [-122.8954892511611, 49.087644020446554], [-122.89546179353415, 49.08764914504087], [-122.89544305996787, 49.08765442733818], [-122.89543433065482, 49.087656768236506], [-122.89540686259942, 49.087666851730596], [-122.89539519561312, 49.08767241099079], [-122.89537938872367, 49.08767970023491], [-122.89536095244299, 49.08769040697167], [-122.89535190855926, 49.08769553440308], [-122.89533333560965, 49.087708408950746], [-122.89532442179666, 49.08771449914198], [-122.89530974871768, 49.08772641457812], [-122.89529692803417, 49.087736783016226], [-122.89528874942685, 49.08774442254785], [-122.89526958983551, 49.08776243218286], [-122.89526942685173, 49.08776258312304], [-122.89525224665972, 49.08778044346289], [-122.89524191938351, 49.087791357589765], [-122.89523573995004, 49.08779845549941], [-122.89522014869453, 49.08781646836448], [-122.89521440556402, 49.08782313514695], [-122.89520509605083, 49.08783448171636], [-122.89519057337847, 49.08785249554744], [-122.89518688719805, 49.0878570560119], [-122.89517611516027, 49.08787050943514], [-122.89516200340589, 49.08788852363564], [-122.89515936693513, 49.0878918600479], [-122.89514734166352, 49.087906537334796], [-122.89513289817859, 49.087924551230316], [-122.89513184837759, 49.08792583600304], [-122.89511688872444, 49.087942563701134], [-122.8951043362393, 49.08795674678688], [-122.89510039046527, 49.0879605757255], [-122.89508142452777, 49.0879785855046], [-122.89507683419251, 49.08798285200526], [-122.89505820522119, 49.08799659141386], [-122.89504934485818, 49.088002911878476], [-122.89502672648491, 49.08801458980777], [-122.89502186814757, 49.088016973289086], [-122.8949944029257, 49.088025579149964], [-122.8949669455439, 49.08803046357677], [-122.89494404639106, 49.08803254160646], [-122.89493949324668, 49.08803293551627], [-122.89491204291673, 49.08803447397815], [-122.89488459114936, 49.08803669256398], [-122.89485713454516, 49.08804120071753], [-122.894829668705, 49.08805007949298], [-122.89482891873321, 49.08805046378784], [-122.89480218744792, 49.0880662512751], [-122.89479970087328, 49.088068464179536], [-122.89478242059985, 49.088086475445415], [-122.89477467584541, 49.08809677487025], [-122.89477017890742, 49.088104491301905], [-122.89476155622884, 49.08812251045646], [-122.89475504911803, 49.088140531539175], [-122.8947502501466, 49.0881585541789], [-122.89474706273818, 49.08817530460842], [-122.89474684260573, 49.08817657808709], [-122.8947445362778, 49.08819460299922], [-122.8947431355834, 49.08821262873705], [-122.89474252681907, 49.0882306551969], [-122.89474262244545, 49.08824868229901], [-122.89474335745803, 49.08826670998406], [-122.8947446869454, 49.08828473821111], [-122.89474658468079, 49.08830276695621], [-122.89474679023074, 49.08830422782451], [-122.89474874646943, 49.08832079594198], [-122.89475129185057, 49.08833882527741], [-122.8947542416137, 49.0883568549814], [-122.89475760920459, 49.088374885066216], [-122.89476142614171, 49.08839291556052], [-122.89476574511775, 49.08841094651232], [-122.89477064492442, 49.08842897799338], [-122.8947739512473, 49.08843967099208], [-122.89477572551881, 49.08844700963897], [-122.89478056417158, 49.08846504106375], [-122.89478595051258, 49.088483072987465], [-122.89479203860446, 49.08850110555047], [-122.89479904716316, 49.088519138951945], [-122.89480122023949, 49.08852407479459], [-122.89480548667883, 49.088537171834375], [-122.89481213443727, 49.08855520490614], [-122.89481993116688, 49.088573239024406], [-122.89482852892324, 49.08858972984896], [-122.8948291049331, 49.08859127439666], [-122.8948366962236, 49.088609308326475], [-122.89484608929193, 49.08862734389707], [-122.89485586591708, 49.08864201174592], [-122.89485742193666, 49.08864538123348], [-122.894867364851, 49.08866341730305], [-122.89488135390137, 49.08868145705631], [-122.8948832258132, 49.08868347186743], [-122.89489355549959, 49.08869949518029], [-122.89490993615331, 49.08871753710756], [-122.89491059884396, 49.088718729986915], [-122.8949176122049, 49.088735571108835], [-122.89491055088772, 49.08874145301879], [-122.89488308780021, 49.08874884931461], [-122.89485563289202, 49.08875236819013], [-122.89484440716171, 49.08875353145908], [-122.8948281812623, 49.088754333001475], [-122.89480073048371, 49.08875589392944], [-122.89477327891662, 49.08875782716462], [-122.89474582645128, 49.08876018433545], [-122.89471837299679, 49.08876300809808], [-122.8946909184638, 49.08876634035878], [-122.89466346275816, 49.08877022520417], [-122.89465558774543, 49.08877138631258], [-122.89463600858357, 49.08877338445556], [-122.89460855445158, 49.088776521946365], [-122.89458109928741, 49.08878014534435], [-122.89455364300547, 49.08878429468814], [-122.89452618551282, 49.08878901344457], [-122.89452455221982, 49.0887892936701], [-122.8944987301172, 49.08879273998663], [-122.89447127390477, 49.08879685000741], [-122.89444381660437, 49.0888014711214], [-122.89441635812827, 49.08880664429796], [-122.8944133080993, 49.08880721898344], [-122.89438890123529, 49.0888110683616], [-122.89436144366373, 49.088815809997165], [-122.89433398502025, 49.088821054280004], [-122.89431389915298, 49.0888251550258], [-122.8943065259643, 49.08882649016478], [-122.89427906777904, 49.08883151313542], [-122.89425160860782, 49.08883699775625], [-122.89422414837274, 49.08884298032684], [-122.89422359435505, 49.08884309932527], [-122.89419668925645, 49.08884843328149], [-122.8941692292727, 49.08885429152896], [-122.8941417683066, 49.08886060882482], [-122.89413983084779, 49.08886104955297], [-122.89411430798944, 49.088866617673844], [-122.89408684695275, 49.088872961683485], [-122.89406210272817, 49.08887900525883], [-122.89405938513617, 49.08887966896332], [-122.89403192358692, 49.08888624714014], [-122.89400446128582, 49.08889317511631], [-122.89398970732934, 49.08889696580978], [-122.89397699849307, 49.08890033040285], [-122.89394953540285, 49.08890762164837], [-122.89392305016496, 49.08891493158846], [-122.89392207164899, 49.088915220645774], [-122.89389460731665, 49.088923087164254], [-122.89386714251303, 49.088931170728806], [-122.89386118023829, 49.088932901730416], [-122.89383967661449, 49.088939763680905], [-122.89381221030231, 49.088948546138695], [-122.89380479371003, 49.088950876883814], [-122.89378474238066, 49.08895807858368], [-122.89375727404487, 49.088967800197494], [-122.89375419446647, 49.08896885733632], [-122.89372980286734, 49.088978848289436], [-122.89370960319489, 49.0889868432988], [-122.89370233031076, 49.08899053668781], [-122.89367485473741, 49.0890036318345], [-122.89367218375406, 49.089004835850226], [-122.89364737159711, 49.0890202630314], [-122.8936428672438, 49.08902283585548], [-122.89362375177164, 49.089040845254196], [-122.89361985237652, 49.08905377387237], [-122.89361806189295, 49.08905886702314], [-122.89361983584254, 49.08906151300314], [-122.89363199591523, 49.08907690687592], [-122.89364723626916, 49.089083622871264], [-122.89367466370506, 49.08909309529908], [-122.89368137483496, 49.089094979378046], [-122.8937020991711, 49.08909881100765], [-122.89372953805731, 49.08910292712271], [-122.89375697884134, 49.089106155894704], [-122.8937844211806, 49.08910865724623], [-122.89381186480655, 49.0891105565321], [-122.89383930950657, 49.089111953023185], [-122.89386675511084, 49.089112925985454], [-122.89387797566206, 49.0891131872972], [-122.89389420149314, 49.08911353434102], [-122.89392164850845, 49.089113845873406], [-122.89394909608352, 49.0891138947424], [-122.89397654417401, 49.089113701555966], [-122.89400263310102, 49.089113301830224], [-122.89400399274393, 49.0891132830594], [-122.89403144167437, 49.08911269494056], [-122.89405889096426, 49.08911193756469], [-122.8940863405878, 49.08911102293579], [-122.89411379052754, 49.08910995912832], [-122.89414124077402, 49.08910875049826], [-122.89416869132548, 49.08910739774191], [-122.89419614218816, 49.089105897799946], [-122.89422359337692, 49.089104243592594], [-122.89425104491603, 49.08910242355859], [-122.89427849684074, 49.08910042095284], [-122.89430594919949, 49.08909821283416], [-122.89433340205676, 49.08909576864157], [-122.89433531713543, 49.089095579823066], [-122.89436085427118, 49.08909362618217], [-122.89438830670909, 49.08909137724848], [-122.8944157595166, 49.089088952838], [-122.89444321277516, 49.08908631438504], [-122.89447066659196, 49.08908341115777], [-122.89449812110892, 49.089080175962906], [-122.89451677274388, 49.08907771876542], [-122.89452557574641, 49.08907688218398], [-122.89455302935647, 49.08907407185962], [-122.89458048354531, 49.089070986675225], [-122.89460793850728, 49.08906753462654], [-122.89463539451282, 49.089063587589656], [-122.89465804538528, 49.08905982075996], [-122.89466285126647, 49.08905928484319], [-122.8946903059182, 49.08905597372695], [-122.89471776155348, 49.08905219569812], [-122.89474521861835, 49.089047739395774], [-122.89477267780069, 49.089042278772], [-122.89477438164528, 49.089041899853335], [-122.89480013361417, 49.089038409849614], [-122.89482759063714, 49.089033966286124], [-122.8948550501774, 49.08902832828236], [-122.89487205715939, 49.08902396183639], [-122.89488251027906, 49.08902242138276], [-122.89490996784076, 49.089017714886566], [-122.89493742904035, 49.08901128177342], [-122.89495423638766, 49.089006009636186], [-122.89496489155222, 49.0890042231857], [-122.89499235123556, 49.08899850216612], [-122.89501981857555, 49.08898914647555], [-122.89502247256753, 49.08898804469837], [-122.89504727942116, 49.08898286707815], [-122.89507474949168, 49.088972206576514], [-122.89507897219997, 49.088970069053204], [-122.8951022141693, 49.08896410044547], [-122.89512444143676, 49.08895208335949], [-122.89512969015132, 49.088950622567545], [-122.895157171664, 49.08893451090126], [-122.89516375856547, 49.08895211907337], [-122.89516452465512, 49.08897014678172], [-122.8951667414911, 49.08898817580752], [-122.89517228128682, 49.08900620785089], [-122.89518284619797, 49.08902424445694], [-122.89518442539311, 49.089026602253], [-122.89519486171734, 49.089042282379], [-122.89521180345305, 49.08905966134948], [-122.89521260880548, 49.089060325502786], [-122.89523383912858, 49.08907837178513], [-122.89523920257044, 49.089082728922705], [-122.89526049383647, 49.089096422985435], [-122.89526661266248, 49.08910059084575], [-122.89529282863849, 49.08911447933189], [-122.89529402963034, 49.0891151922735], [-122.89532144908546, 49.089128618190216], [-122.89533185581953, 49.08913254173756], [-122.89534887244413, 49.08914019381795], [-122.89537629985273, 49.0891498480233], [-122.89537891509814, 49.08915061140991], [-122.89540372747138, 49.08915940727841], [-122.8954311588973, 49.08916715860977], [-122.89543765789224, 49.08916869164665], [-122.89545859078721, 49.0891746930076], [-122.89548602494878, 49.08918114906912], [-122.89551346143644, 49.08918650002394], [-122.89551525678759, 49.089186788922355], [-122.8955408980891, 49.08919177511326], [-122.89556833671446, 49.089196112387924], [-122.89559577712694, 49.08919959961163], [-122.8956232191472, 49.089202321673035], [-122.89565066269232, 49.08920431751286], [-122.89566469556516, 49.08920495110017], [-122.89567810758969, 49.08920566897599], [-122.89570555410953, 49.089206246534594], [-122.89573300248306, 49.08920593914494], [-122.89575339076815, 49.089205031232666], [-122.89576045275393, 49.0892047252541], [-122.8957879048079, 49.089202658748825], [-122.89581535902349, 49.08919955804371], [-122.89584281561308, 49.089195320773435], [-122.89587027479892, 49.0891898397758], [-122.89588176405509, 49.08918712008019], [-122.89589773604297, 49.08918337141877], [-122.89592519948376, 49.08917584864191], [-122.8959463488019, 49.0891691513033], [-122.89595266520699, 49.089167229582024], [-122.89598013177265, 49.089158202717144], [-122.89599956655411, 49.08915117224981], [-122.8960075997891, 49.08914847639292], [-122.89603506769585, 49.08913879748163], [-122.8960501230114, 49.08913319077524], [-122.89606253590061, 49.08912897068129], [-122.89609000390315, 49.089119235574195], [-122.89610100366605, 49.08911520957029], [-122.89611747159339, 49.089109645021274], [-122.89614493954383, 49.08909992462965], [-122.89615239563578, 49.08909722880284], [-122.89617240724841, 49.08909031700516], [-122.89619987588672, 49.08908025638394], [-122.89620259628079, 49.08907924694127], [-122.89622734487557, 49.089070022228846], [-122.8962493754287, 49.08906126198269], [-122.89625481556362, 49.08905896709254], [-122.89628228823578, 49.08904695355056], [-122.89629037102061, 49.08904327180915], [-122.89630976461804, 49.08903315197829], [-122.8963241779904, 49.08902527516493], [-122.8963372472851, 49.08901632422696], [-122.89635008079944, 49.089007271413806], [-122.89636474466921, 49.08899241640323], [-122.89636783216447, 49.08898926033911], [-122.89637806357442, 49.0889712425115], [-122.89638061174675, 49.088953217786376], [-122.89637597596092, 49.08893518661243], [-122.89636489900896, 49.088918260253955], [-122.89636423232818, 49.088917149057174], [-122.89634638449982, 49.088899106019625], [-122.89633750457638, 49.088892735324585], [-122.8963219652069, 49.088881057077245], [-122.89631009562781, 49.08887419476487], [-122.89629122716721, 49.088863002452975], [-122.89628268001297, 49.0888588644256], [-122.89625526030618, 49.08884550620221], [-122.89625413389037, 49.088844942108906], [-122.89622783730678, 49.08883373495995], [-122.89621145729821, 49.088826876733], [-122.89620041265931, 49.08882276053262], [-122.8961729862642, 49.08881263005489], [-122.89616256113334, 49.08880880574671], [-122.89614555877299, 49.088803030457214], [-122.89611813015671, 49.08879397521212], [-122.89610825089703, 49.0887907298671], [-122.8960907010629, 49.08878515357382], [-122.89606327126454, 49.08877667412841], [-122.89605010353435, 49.08877265050656], [-122.89603584143583, 49.088768213699275], [-122.896008411644, 49.08875974006943], [-122.8959914443478, 49.088754570655524], [-122.89598098218222, 49.088751112905754], [-122.89595355408248, 49.088741838442836], [-122.89593790248593, 49.088736495387884], [-122.89592612768084, 49.08873175642042], [-122.89589870431155, 49.088720229242014], [-122.89589473615044, 49.08871842945298], [-122.89587129019523, 49.088704283366305], [-122.89586548160644, 49.08870037605265], [-122.89584886936929, 49.088682334052066], [-122.89584391445358, 49.08866999990332], [-122.89584206477689, 49.08866430089898], [-122.89584207048038, 49.088646273890596], [-122.89584398421253, 49.08863664983583], [-122.89584595847234, 49.08862825038514], [-122.89585227344905, 49.088610229069204], [-122.89585915807587, 49.088592208266775], [-122.89586585097099, 49.08857418729094], [-122.8958715974875, 49.088557335469886], [-122.89587206792747, 49.08855616588531], [-122.89587848235126, 49.08853814465742], [-122.8958839612999, 49.088520122585365], [-122.89588852775938, 49.08850209969003], [-122.89589221821402, 49.088484076004406], [-122.89589506605395, 49.08846605155869], [-122.89589709524904, 49.088448026374586], [-122.89589831894831, 49.08843000046397], [-122.8958987403588, 49.08841197382977], [-122.89589835465752, 49.08839394646764], [-122.89589715140023, 49.08837591836815], [-122.89589511723223, 49.08835788951925], [-122.8958922388532, 49.088339859908885], [-122.8958885062215, 49.08832182952792], [-122.89588391595514, 49.08830379837325], [-122.8958784748171, 49.08828576645086], [-122.89587220308503, 49.08826773377893], [-122.89587220308503, 49.08826773377893], [-122.89586596424807, 49.08824970113627], [-122.89585910768139, 49.088231667935915], [-122.89585171665611, 49.0882136342529], [-122.89584490201672, 49.088197864151034], [-122.89584402684513, 49.08819560029976], [-122.8958370119372, 49.08817756695506], [-122.89582987343246, 49.08815953349832], [-122.89582270570482, 49.088141500014736], [-122.89581759999163, 49.08812848837092], [-122.89581590352842, 49.088123466860544], [-122.8958100050207, 49.088105434521566], [-122.89580425472697, 49.088087402316006], [-122.89579866764747, 49.08806937025742], [-122.8957932461874, 49.08805133834804], [-122.8957903353049, 49.08804130710877], [-122.89578832398395, 49.088033306889045], [-122.89578391145291, 49.08801527588993], [-122.89577954674296, 49.087997244933774], [-122.8957751984601, 49.08797921399222], [-122.89577083210166, 49.08796118303412], [-122.89576641058271, 49.08794315202599], [-122.89576312136877, 49.0879299269004], [-122.89576200723171, 49.087925121034054], [-122.8957577360529, 49.08790709016124], [-122.89575322342976, 49.087889059070164], [-122.89574841992133, 49.087871027716155], [-122.8957432723789, 49.08785299605117], [-122.89573772339403, 49.08783496402329], [-122.89573588509106, 49.08782927486026], [-122.8957317638912, 49.087816931624296], [-122.89572520113747, 49.087798898680006], [-122.89571790249693, 49.08778086507049], [-122.89570976516725, 49.087762830702744], [-122.89570858246589, 49.08776035421901], [-122.8957001779763, 49.08774479502435], [-122.89568916843919, 49.08772675805984], [-122.8956812304403, 49.08771505066562], [-122.89567599413161, 49.08770871913781], [-122.89565951697459, 49.08769067722884], [-122.89565384648368, 49.08768500901026], [-122.89563731461234, 49.08767263014151], [-122.89562644121727, 49.08766514992843], [-122.89560369357382, 49.087654572723615], [-122.89559902084036, 49.08765250853527]]]}}, {"id": "1", "type": "Feature", "properties": {"r": 0.75, "r_true": 0.7499981470906705, "info": "75 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.89537801017183, 49.08833583663873], [-122.8953505724377, 49.08833130866992], [-122.89532312276681, 49.08833246143039], [-122.89529566286616, 49.08833847862919], [-122.89529344024413, 49.08833931831358], [-122.8952681956386, 49.08834797625487], [-122.8952490419746, 49.08835730504751], [-122.89524072083472, 49.08836107014096], [-122.89521582543676, 49.08837530191491], [-122.89521324067208, 49.088376703655655], [-122.89518677413736, 49.088393302554756], [-122.89518575716397, 49.08839391833438], [-122.89515909730966, 49.088411304435596], [-122.89515827216627, 49.088411831453385], [-122.89513152058686, 49.08842930640067], [-122.89513078706935, 49.088429782304374], [-122.895103800846, 49.08844730822916], [-122.89510330215612, 49.0884476365353], [-122.89507699928345, 49.0884653108855], [-122.89507581584037, 49.08846614700166], [-122.89505320687648, 49.088483316271365], [-122.89504832357032, 49.088487472816915], [-122.89503386471324, 49.088501325699035], [-122.89502081420522, 49.08851689614559], [-122.89501900032222, 49.088519339195734], [-122.89500734247406, 49.088537355606995], [-122.89499886770912, 49.08855537491245], [-122.89499324979003, 49.08857240903609], [-122.89499292771842, 49.08857339652308], [-122.89498835221696, 49.08859141937461], [-122.89498557215695, 49.08860944385928], [-122.89498438012639, 49.088627469788555], [-122.89498468112001, 49.08864549707601], [-122.89498653158148, 49.08866352577301], [-122.89499023615397, 49.0886815561566], [-122.89499300288422, 49.08868949239666], [-122.89499525746109, 49.08869958773778], [-122.89500133093638, 49.08871762027573], [-122.8950104480975, 49.08873565558164], [-122.89502032259709, 49.08875007887951], [-122.89502194150798, 49.088753693047764], [-122.89502299277429, 49.088771721017025], [-122.89502027429077, 49.08877299166812], [-122.89499281301329, 49.08877952914759], [-122.89496535499252, 49.08878451926783], [-122.89493850873231, 49.088789671169145], [-122.89493789645114, 49.088789753533575], [-122.89491044092779, 49.08879355502739], [-122.89488298314235, 49.08879842609837], [-122.8948555228294, 49.088804491600335], [-122.89484251228156, 49.08880761077251], [-122.89482806188207, 49.08881085428568], [-122.89480060019343, 49.08881756452995], [-122.8947731359719, 49.088825469847784], [-122.89477276438215, 49.08882557422645], [-122.89474567117382, 49.088833643797784], [-122.89471820416499, 49.088842859084856], [-122.89471609436839, 49.08884354956678], [-122.89469073438589, 49.08885337943498], [-122.89467032355783, 49.08886153482486], [-122.89466326143544, 49.08886539344239], [-122.89463578397975, 49.088879530316646], [-122.89463578397975, 49.088879530316646], [-122.89461176467056, 49.08889753540321], [-122.89460828376048, 49.08890441483497], [-122.89460135023059, 49.08891555290752], [-122.89460822873498, 49.088930412516994], [-122.89460986382656, 49.088933587693354], [-122.89463564302783, 49.088946142670046], [-122.89465154128591, 49.08895165274934], [-122.89466307372412, 49.08895412691968], [-122.89469051140522, 49.08895881267142], [-122.89471795209539, 49.08896207769317], [-122.89474539513346, 49.088964233677146], [-122.89477284003208, 49.088965510358705], [-122.89480028643415, 49.08896607607902], [-122.8948277340854, 49.08896605067426], [-122.89485518281948, 49.08896551243834], [-122.89488263255524, 49.088964499441], [-122.89491008330866, 49.088963003712095], [-122.89493753523013, 49.08896095362413], [-122.89496498869133, 49.08895817251026], [-122.89499244448884, 49.08895428207357], [-122.89500406404505, 49.08895197393089], [-122.89501990046901, 49.08895030296996], [-122.89504735589126, 49.0889465864794], [-122.89507481500434, 49.088941116492734], [-122.8950957771259, 49.088934030301004], [-122.89510227967448, 49.08893300576254], [-122.89512974072574, 49.08892660908304], [-122.8951499926816, 49.088916052545216], [-122.89515721446918, 49.088914181025345], [-122.89518186411102, 49.088898054476964], [-122.89518469911447, 49.0888965673539], [-122.89519185813819, 49.0888980635514], [-122.89519581079476, 49.08891609415287], [-122.89519757162567, 49.08893412276423], [-122.89520487068908, 49.08895215640343], [-122.89521200894279, 49.088962015471175], [-122.89522296807408, 49.08897019984391], [-122.89523941528509, 49.088981623499436], [-122.89525952488488, 49.088988260032224], [-122.89526684234845, 49.088991390252744], [-122.89529427666363, 49.08899771344674], [-122.89532171767614, 49.08900085412433], [-122.89534916257234, 49.08900214856953], [-122.89537661012011, 49.089002181701744], [-122.89540405974904, 49.08900122410563], [-122.89543151129293, 49.088999354120666], [-122.89545896483865, 49.0889965296635], [-122.89548642062495, 49.0889926362343], [-122.89550911207797, 49.08898848622643], [-122.89551387852289, 49.088987734436586], [-122.89554133710787, 49.08898250255391], [-122.89556879914164, 49.088975623508794], [-122.89558566127684, 49.08897052848027], [-122.895596264401, 49.088967202437594], [-122.89562373356172, 49.08895691572877], [-122.89563385974431, 49.08895254505456], [-122.89565120956004, 49.08894336077738], [-122.89566598354638, 49.088934547080974], [-122.89567869885452, 49.088923452262115], [-122.89568634539165, 49.08891653847022], [-122.89569756133945, 49.08889852159233], [-122.89570070064005, 49.08888049741604], [-122.8956972642201, 49.08886246729824], [-122.89568765035224, 49.0888444315982], [-122.89567888524748, 49.08883448408836], [-122.89567283004796, 49.08882639119198], [-122.89565336653209, 49.08880834658669], [-122.89565149543787, 49.088806942854134], [-122.89563129775172, 49.08879029962258], [-122.89562409357723, 49.08878516519903], [-122.89560749932016, 49.08877225109001], [-122.8955966908036, 49.08876383440213], [-122.89558591882246, 49.088754204558676], [-122.8955693002837, 49.088736672017546], [-122.89556890766231, 49.08873616215711], [-122.89555972111677, 49.088718126832596], [-122.89555426538634, 49.088700094883], [-122.89555135984843, 49.088682065240626], [-122.89554942407061, 49.08866403647558], [-122.89554725166127, 49.08864600749632], [-122.8955442017608, 49.08862797772296], [-122.89554210066763, 49.08861852121773], [-122.89554050573432, 49.088609947364745], [-122.89553641933814, 49.088591916653115], [-122.89553157204517, 49.088573885252664], [-122.8955260605653, 49.08855585325082], [-122.89551995316238, 49.088537820709305], [-122.89551485193347, 49.088523840041624], [-122.89551360817887, 49.08851978795236], [-122.89550778029005, 49.08850175566307], [-122.89550125670291, 49.08848372274364], [-122.89549391465127, 49.08846568908282], [-122.89548755616379, 49.08845161813583], [-122.89548584161197, 49.088447654759655], [-122.89547731315204, 49.08842962002348], [-122.89546718159319, 49.08841158383494], [-122.89546021586563, 49.0884006439063], [-122.89545511087606, 49.08839354588923], [-122.89544025274544, 49.08837550541744], [-122.89543283797893, 49.08836759600103], [-122.89542002987262, 49.0883574600835], [-122.8954054336889, 49.088347135384126], [-122.8953869108736, 49.08833940305954], [-122.89537801017183, 49.08833583663873]]]}}, {"id": "0", "type": "Feature", "properties": {"r": 0.5, "r_true": 0.4995630113608912, "info": "50 % Flux Source Area Contour"}, "geometry": {"type": "Polygon", "coordinates": [[[-122.89529510267639, 49.08860489036548], [-122.89526766388776, 49.08860079686267], [-122.89524021089487, 49.08860345710244], [-122.89522029883373, 49.08860965715837], [-122.89521274627909, 49.08861163910671], [-122.89518527237752, 49.088624228231296], [-122.89517984445199, 49.088627647444696], [-122.89515778777388, 49.08864189368463], [-122.89515314929298, 49.08864565021478], [-122.89513343882022, 49.0886636593241], [-122.89513028719199, 49.0886671366803], [-122.89511846849952, 49.088681672736875], [-122.8951087665291, 49.08869969093493], [-122.89510374483717, 49.08871771338521], [-122.89510270875566, 49.08872932369523], [-122.89510195182048, 49.088735738769216], [-122.89510268478479, 49.08874070258049], [-122.89510374452898, 49.08875376741155], [-122.89510939144816, 49.08877179955603], [-122.89511666024241, 49.0887898331738], [-122.89510256741303, 49.08879641838164], [-122.89507510015737, 49.08880579191501], [-122.89506837206144, 49.08880781630252], [-122.89504763737602, 49.0888130377244], [-122.89502017089092, 49.08882203650697], [-122.89500971487671, 49.088825789980646], [-122.89499269620399, 49.08883491986293], [-122.89497591948113, 49.08884378625116], [-122.89496520172915, 49.08885717739167], [-122.89496047271649, 49.08886179920945], [-122.89496515394511, 49.08887983048191], [-122.89496515394511, 49.08887983048191], [-122.89499257301141, 49.08889333734064], [-122.89500939965545, 49.08889789774566], [-122.8950200069998, 49.088899773410276], [-122.89504744827417, 49.08890275606966], [-122.8950748942512, 49.088903508555795], [-122.89510234499537, 49.08890199851278], [-122.89512366286733, 49.08889800161396], [-122.89512980215311, 49.08889744239785], [-122.89515726092937, 49.088892115208125], [-122.89517727425056, 49.08888002329633], [-122.89518474260774, 49.08887590522069], [-122.89519960641248, 49.0888620165604], [-122.8952032431428, 49.08884399284909], [-122.89518678851196, 49.08882595089671], [-122.89521231056658, 49.088818687060424], [-122.89523975293046, 49.08882113607447], [-122.8952671963732, 49.08882307344994], [-122.89527156692013, 49.08882602784311], [-122.89526717859827, 49.08883152436537], [-122.89525361354194, 49.08884403856649], [-122.89524656371036, 49.088862059182155], [-122.8952396344917, 49.08887743179393], [-122.89523754767359, 49.08888007801292], [-122.89523960450731, 49.08889168379625], [-122.8952440462787, 49.088898110923346], [-122.89526701810193, 49.08890783057348], [-122.89529445667844, 49.08891210536087], [-122.89532190391346, 49.08891226365259], [-122.89534935866519, 49.088908845474265], [-122.89537682275044, 49.08890098333094], [-122.89538381254478, 49.08889823767507], [-122.89540429952913, 49.088887074198404], [-122.895414641691, 49.08888023859791], [-122.89543179667179, 49.088863460681296], [-122.89543303005046, 49.08886222824364], [-122.89544254131316, 49.088844209846116], [-122.89544113650966, 49.08882618156071], [-122.89543190855393, 49.08881018367097], [-122.89543099762068, 49.088808145363615], [-122.8954215101445, 49.08879010975571], [-122.8954090781644, 49.08877207147912], [-122.8954045531456, 49.08876633654965], [-122.8953966130427, 49.08875403317109], [-122.89538868305459, 49.088735998971664], [-122.8953831748425, 49.08871796696647], [-122.8953772441836, 49.08870040655792], [-122.89537712510653, 49.08869993447015], [-122.89537137685836, 49.08868190224673], [-122.89536296425428, 49.08866386760786], [-122.89535103542136, 49.08864582978068], [-122.89534991458383, 49.08864433075362], [-122.89533461330548, 49.08862778787821], [-122.89532252331963, 49.08861761767719], [-122.8953059026509, 49.088609734828864], [-122.89529510267639, 49.08860489036548]]]}}]}
    
    var EC_Station = {"type": "FeatureCollection", "features": [{"id": "3", "type": "Feature", "properties": {"index": "DSM", "name": "Delta Salt Marsh", "Zm": 1.83, "lat": 49.088835, "lon": -122.895226, "canopy_height": 0.16, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/DeltaSaltMarsh.html#", "info": "https://ubc-micromet.github.io/Data.html#delta-salt-marsh"}, "geometry": {"type": "Point", "coordinates": [-122.895226, 49.088835]}}]}

    map.on('load', () => {
        // Add a data sources containing GeoJSON data.

        // Add a data source containing GeoJSON data.
        map.addSource('Site_Name', {
            'type': 'geojson',
            'data': {"type": "FeatureCollection", "features": [{"id": "3", "type": "Feature", "properties": {"index": "DSM", "name": "Delta Salt Marsh", "Zm": 1.83, "lat": 49.088835, "lon": -122.895226, "canopy_height": 0.16, "webplot": "https://ibis.geog.ubc.ca/~micromet/data/DeltaSaltMarsh.html#", "info": "https://ubc-micromet.github.io/Data.html#delta-salt-marsh"}, "geometry": {"type": "Point", "coordinates": [-122.895226, 49.088835]}}]}
        });

        map.addSource('FP_Contour_Levels', {
            'type': 'geojson',
            'data': FP_Contour_Levels
        });

        // Add a new layer to visualize the polygon.
        map.addLayer({
            'id': 'FP_Contour_Levels',
            'type': 'fill',
            'source': 'FP_Contour_Levels', // reference the data source
            'layout': {},
            'paint': {
                'fill-color': '#f76605', // blue color fill
                'fill-opacity': 0.15
                }
            });
        // Add a black outline around the polygon.
        map.addLayer({
            'id': 'outline',
            'type': 'line',
            'source': 'FP_Contour_Levels',
            'layout': {},
            'paint': {
                'line-color': '#000',
                'line-width': 3
                }
            });

        
        map.addLayer({'id': 'Site_Name',
                'type': 'circle',
                'source': 'Site_Name',
                'filter': ['==', '$type', 'Point'],
                'paint': {
                    'circle-radius': 10,
                    'circle-color': '#9803fc',
                    "circle-stroke-width": 1,
                    "circle-stroke-color": 'black'
                    },
                });

    });

    map.on('click', 'FP_Contour_Levels', (e) => {
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(e.features[0].properties.Contour_Level)
            .addTo(map);
        });

        
    let bbox = turf.extent(FP_Contour_Levels);
    
    // fit zom to the bounding box of whichever layers are loaded
    function fit() {
        map.fitBounds(bbox, {maxZoom: 18});
        };

    fit();

    map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
    
    // Call fit when clicking the zoomto button
    document.getElementById('zoomto').addEventListener('click', () => {
        fit()
    });
</script>

</body>
</html>